[{"/Users/joe/www/redactics-osedition/react/src/index.js":"1","/Users/joe/www/redactics-osedition/react/src/App.js":"2","/Users/joe/www/redactics-osedition/react/src/redux/store/index.js":"3","/Users/joe/www/redactics-osedition/react/src/routes/Routes.js":"4","/Users/joe/www/redactics-osedition/react/src/redux/reducers/index.js":"5","/Users/joe/www/redactics-osedition/react/src/pages/Page404.js":"6","/Users/joe/www/redactics-osedition/react/src/theme/index.js":"7","/Users/joe/www/redactics-osedition/react/src/redux/reducers/themeReducers.js":"8","/Users/joe/www/redactics-osedition/react/src/routes/index.js":"9","/Users/joe/www/redactics-osedition/react/src/layouts/Auth.js":"10","/Users/joe/www/redactics-osedition/react/src/components/Async.js":"11","/Users/joe/www/redactics-osedition/react/src/layouts/Dashboard.js":"12","/Users/joe/www/redactics-osedition/react/src/routes/RedacticsRoute.tsx":"13","/Users/joe/www/redactics-osedition/react/src/components/Sidebar.js":"14","/Users/joe/www/redactics-osedition/react/src/components/Loader.js":"15","/Users/joe/www/redactics-osedition/react/src/components/Header.js":"16","/Users/joe/www/redactics-osedition/react/src/redux/constants.js":"17","/Users/joe/www/redactics-osedition/react/src/pages/settings/Main.tsx":"18","/Users/joe/www/redactics-osedition/react/src/pages/developers/Main.tsx":"19","/Users/joe/www/redactics-osedition/react/src/pages/workflows/Main.tsx":"20","/Users/joe/www/redactics-osedition/react/src/pages/workflows/JobListing.tsx":"21","/Users/joe/www/redactics-osedition/react/src/pages/inputs/Main.tsx":"22","/Users/joe/www/redactics-osedition/react/src/pages/agents/Main.tsx":"23","/Users/joe/www/redactics-osedition/react/src/contexts/RedacticsContext.tsx":"24","/Users/joe/www/redactics-osedition/react/src/components/Notifications.tsx":"25","/Users/joe/www/redactics-osedition/react/src/pages/settings/Preset.tsx":"26","/Users/joe/www/redactics-osedition/react/src/pages/agents/Agent.tsx":"27","/Users/joe/www/redactics-osedition/react/src/pages/settings/PresetRandomString.tsx":"28","/Users/joe/www/redactics-osedition/react/src/pages/settings/PresetReplacement.tsx":"29","/Users/joe/www/redactics-osedition/react/src/pages/settings/PresetRedactEmail.tsx":"30","/Users/joe/www/redactics-osedition/react/src/pages/workflows/Workflow.tsx":"31","/Users/joe/www/redactics-osedition/react/src/pages/settings/DefaultReplacement.tsx":"32","/Users/joe/www/redactics-osedition/react/src/pages/settings/DefaultRandomString.tsx":"33","/Users/joe/www/redactics-osedition/react/src/pages/settings/DefaultRedactEmail.tsx":"34","/Users/joe/www/redactics-osedition/react/src/pages/workflows/DatabaseMigrationSetup.tsx":"35","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowPostExport.tsx":"36","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowSchedule.tsx":"37","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowExport.tsx":"38","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowInputs.tsx":"39","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowRedactionRules.tsx":"40","/Users/joe/www/redactics-osedition/react/src/theme/shadows.js":"41","/Users/joe/www/redactics-osedition/react/src/theme/props.js":"42","/Users/joe/www/redactics-osedition/react/src/theme/overrides.js":"43","/Users/joe/www/redactics-osedition/react/src/theme/typography.js":"44","/Users/joe/www/redactics-osedition/react/src/theme/variants.js":"45","/Users/joe/www/redactics-osedition/react/src/theme/breakpoints.js":"46"},{"size":342,"mtime":1641361055580,"results":"47","hashOfConfig":"48"},{"size":1154,"mtime":1672424495046,"results":"49","hashOfConfig":"48"},{"size":146,"mtime":1641361055698,"results":"50","hashOfConfig":"48"},{"size":1300,"mtime":1672457087170,"results":"51","hashOfConfig":"48"},{"size":140,"mtime":1641361055695,"results":"52","hashOfConfig":"48"},{"size":1236,"mtime":1672457022086,"results":"53","hashOfConfig":"48"},{"size":629,"mtime":1641454401905,"results":"54","hashOfConfig":"48"},{"size":345,"mtime":1641361055697,"results":"55","hashOfConfig":"48"},{"size":1803,"mtime":1672456178168,"results":"56","hashOfConfig":"48"},{"size":652,"mtime":1641361055582,"results":"57","hashOfConfig":"48"},{"size":658,"mtime":1641454665206,"results":"58","hashOfConfig":"48"},{"size":2325,"mtime":1641361055583,"results":"59","hashOfConfig":"48"},{"size":961,"mtime":1672457681863,"results":"60","hashOfConfig":"48"},{"size":8388,"mtime":1641521953518,"results":"61","hashOfConfig":"48"},{"size":375,"mtime":1641361055569,"results":"62","hashOfConfig":"48"},{"size":3679,"mtime":1641521804893,"results":"63","hashOfConfig":"48"},{"size":38,"mtime":1641521870339,"results":"64","hashOfConfig":"48"},{"size":25499,"mtime":1641361055666,"results":"65","hashOfConfig":"48"},{"size":16337,"mtime":1671257727701,"results":"66","hashOfConfig":"48"},{"size":15845,"mtime":1672274302695,"results":"67","hashOfConfig":"48"},{"size":12547,"mtime":1672456685807,"results":"68","hashOfConfig":"48"},{"size":20693,"mtime":1672179492990,"results":"69","hashOfConfig":"48"},{"size":21400,"mtime":1672456612742,"results":"70","hashOfConfig":"48"},{"size":218,"mtime":1672455873529,"results":"71","hashOfConfig":"48"},{"size":11544,"mtime":1672457428079,"results":"72","hashOfConfig":"48"},{"size":4351,"mtime":1641361055667,"results":"73","hashOfConfig":"48"},{"size":22995,"mtime":1672455815420,"results":"74","hashOfConfig":"48"},{"size":1628,"mtime":1641361055668,"results":"75","hashOfConfig":"48"},{"size":1587,"mtime":1641361055671,"results":"76","hashOfConfig":"48"},{"size":2574,"mtime":1641361055670,"results":"77","hashOfConfig":"48"},{"size":78353,"mtime":1672274337163,"results":"78","hashOfConfig":"48"},{"size":1721,"mtime":1641361055666,"results":"79","hashOfConfig":"48"},{"size":2148,"mtime":1641361055665,"results":"80","hashOfConfig":"48"},{"size":2563,"mtime":1641361055665,"results":"81","hashOfConfig":"48"},{"size":12260,"mtime":1671259495854,"results":"82","hashOfConfig":"48"},{"size":46507,"mtime":1672274379947,"results":"83","hashOfConfig":"48"},{"size":4238,"mtime":1656794765229,"results":"84","hashOfConfig":"48"},{"size":11347,"mtime":1671259648068,"results":"85","hashOfConfig":"48"},{"size":8798,"mtime":1672274360454,"results":"86","hashOfConfig":"48"},{"size":5651,"mtime":1671259600731,"results":"87","hashOfConfig":"48"},{"size":612,"mtime":1641361055721,"results":"88","hashOfConfig":"48"},{"size":160,"mtime":1641361055720,"results":"89","hashOfConfig":"48"},{"size":1324,"mtime":1641361055717,"results":"90","hashOfConfig":"48"},{"size":980,"mtime":1641361055722,"results":"91","hashOfConfig":"48"},{"size":5283,"mtime":1641361055723,"results":"92","hashOfConfig":"48"},{"size":136,"mtime":1641361055715,"results":"93","hashOfConfig":"48"},{"filePath":"94","messages":"95","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},"ca7fco",{"filePath":"97","messages":"98","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"99","messages":"100","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"101","messages":"102","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"103","usedDeprecatedRules":"96"},{"filePath":"104","messages":"105","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"106","messages":"107","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"108","messages":"109","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"110","messages":"111","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"112","messages":"113","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"114","usedDeprecatedRules":"96"},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"117","messages":"118","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"119","messages":"120","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"121","messages":"122","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"123","messages":"124","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"125","messages":"126","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"127","messages":"128","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"129","messages":"130","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"131"},{"filePath":"132","messages":"133","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"134","usedDeprecatedRules":"135"},{"filePath":"136","messages":"137","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"135"},{"filePath":"138","messages":"139","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"140","usedDeprecatedRules":"135"},{"filePath":"141","messages":"142","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"143","usedDeprecatedRules":"135"},{"filePath":"144","messages":"145","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"146","usedDeprecatedRules":"135"},{"filePath":"147","messages":"148","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"149","usedDeprecatedRules":"135"},{"filePath":"150","messages":"151","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"152","usedDeprecatedRules":"135"},{"filePath":"153","messages":"154","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"135"},{"filePath":"155","messages":"156","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"157","usedDeprecatedRules":"135"},{"filePath":"158","messages":"159","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"160","usedDeprecatedRules":"135"},{"filePath":"161","messages":"162","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"163","usedDeprecatedRules":"135"},{"filePath":"164","messages":"165","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"166","usedDeprecatedRules":"135"},{"filePath":"167","messages":"168","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"169","usedDeprecatedRules":"135"},{"filePath":"170","messages":"171","errorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"172","usedDeprecatedRules":"135"},{"filePath":"173","messages":"174","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"175","usedDeprecatedRules":"135"},{"filePath":"176","messages":"177","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"178","usedDeprecatedRules":"135"},{"filePath":"179","messages":"180","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"181","usedDeprecatedRules":"135"},{"filePath":"182","messages":"183","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"184","usedDeprecatedRules":"135"},{"filePath":"185","messages":"186","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"187","usedDeprecatedRules":"135"},{"filePath":"188","messages":"189","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"135"},{"filePath":"190","messages":"191","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"192","usedDeprecatedRules":"135"},{"filePath":"193","messages":"194","errorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"195","usedDeprecatedRules":"135"},{"filePath":"196","messages":"197","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"198","usedDeprecatedRules":"135"},{"filePath":"199","messages":"200","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"201","messages":"202","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"203","messages":"204","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"205","messages":"206","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"207","messages":"208","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"209","messages":"210","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},"/Users/joe/www/redactics-osedition/react/src/index.js",[],["211","212","213"],"/Users/joe/www/redactics-osedition/react/src/App.js",[],"/Users/joe/www/redactics-osedition/react/src/redux/store/index.js",[],"/Users/joe/www/redactics-osedition/react/src/routes/Routes.js",["214"],"import React from 'react';\nimport {\n  BrowserRouter as Router, Route, Switch, Redirect,\n} from 'react-router-dom';\nimport { dashboard as dashboardRoutes } from './index';\n\nimport async from '../components/Async';\n\nimport DashboardLayout from '../layouts/Dashboard';\nimport AuthLayout from '../layouts/Auth';\nimport RedacticsRoute from './RedacticsRoute';\n//import UnprotectedRoute from './RedacticsRoute';\nconst Page404 = async(() => import('../pages/Page404'));\n// const Page500 = async(() => import('../pages/Page500'));\n\n/* eslint-disable max-len */\n\nconst childRoutes = (Layout, routes) => routes.map(({ children, path, component: Component }, index) => (children ? (\n  // Route item with children\n  children.map(({ path, component: Component }, index) => (\n        <RedacticsRoute exact={true} key={index} path={path} layout={Layout} component={Component} />\n  ))\n) : (\n      // Route item without children\n      <RedacticsRoute exact={true} key={index} path={path} layout={Layout} component={Component} />\n)));\n\nconst Routes = () => (\n  <Router>\n    <Switch>\n      {childRoutes(DashboardLayout, dashboardRoutes)}\n      <Route\n        render={() => (\n          <AuthLayout>\n            <Page404 />\n          </AuthLayout>\n        )}\n      />\n    </Switch>\n  </Router>\n);\n\nexport default Routes;\n","/Users/joe/www/redactics-osedition/react/src/redux/reducers/index.js",[],"/Users/joe/www/redactics-osedition/react/src/pages/Page404.js",[],"/Users/joe/www/redactics-osedition/react/src/theme/index.js",[],"/Users/joe/www/redactics-osedition/react/src/redux/reducers/themeReducers.js",[],"/Users/joe/www/redactics-osedition/react/src/routes/index.js",["215","216","217"],"import React from 'react';\n\nimport {\n  TrendingUp as TrendingUpIcon,\n  Layers as LayersIcon,\n  Settings as SettingsIcon,\n  Terminal as TerminalIcon,\n  Search as SearchIcon,\n  Archive as ArchiveIcon,\n} from 'react-feather';\n\nimport {\n  SettingsInputComponent as InputSourcesIcon,\n  List as ListIcon,\n} from '@material-ui/icons';\n\nimport async from '../components/Async';\n\n// Redactics components\nconst Inputs = async(() => import('../pages/inputs/Main'));\nconst Agents = async(() => import('../pages/agents/Main'));\nconst Workflows = async(() => import('../pages/workflows/Main'));\nconst JobListing = async(() => import('../pages/workflows/JobListing'));\nconst Developers = async(() => import('../pages/developers/Main'));\nconst Settings = async(() => import('../pages/settings/Main'));\n\nconst inputSourcesRoutes = {\n  id: 'Input Sources',\n  path: '/',\n  component: Inputs,\n  icon: <InputSourcesIcon />,\n};\n\nconst agentsRoutes = {\n  id: 'Agents',\n  path: '/agents',\n  component: Agents,\n  icon: <LayersIcon />,\n};\n\nconst workflowsRoutes = {\n  id: 'Workflows',\n  path: '/workflows',\n  icon: <ListIcon />,\n  children: [\n    {\n      path: '/workflows/configs',\n      name: 'Configurations',\n      component: Workflows\n    },\n    {\n      path: '/workflows/jobs',\n      name: 'Jobs',\n      component: JobListing\n    }\n  ]\n};\n\nconst developersRoutes = {\n  id: 'Developers',\n  path: '/developers',\n  component: Developers,\n  icon: <TerminalIcon />,\n};\n\nconst settingsRoutes = {\n  id: 'Settings',\n  path: '/settings',\n  component: Settings,\n  icon: <SettingsIcon />,\n};\n\nexport const dashboard = [\n  inputSourcesRoutes,\n  agentsRoutes,\n  workflowsRoutes,\n  developersRoutes,\n  settingsRoutes,\n];\n\nexport default [\n  inputSourcesRoutes,\n  agentsRoutes,\n  workflowsRoutes,\n  developersRoutes,\n  settingsRoutes,\n];\n","/Users/joe/www/redactics-osedition/react/src/layouts/Auth.js",[],"/Users/joe/www/redactics-osedition/react/src/components/Async.js",[],"/Users/joe/www/redactics-osedition/react/src/layouts/Dashboard.js",[],"/Users/joe/www/redactics-osedition/react/src/routes/RedacticsRoute.tsx",["218"],"/Users/joe/www/redactics-osedition/react/src/components/Sidebar.js",[],"/Users/joe/www/redactics-osedition/react/src/components/Loader.js",[],"/Users/joe/www/redactics-osedition/react/src/components/Header.js",[],"/Users/joe/www/redactics-osedition/react/src/redux/constants.js",[],["219","220","221"],"/Users/joe/www/redactics-osedition/react/src/pages/settings/Main.tsx",["222","223","224","225","226"],"import React from 'react';\nimport styled from 'styled-components';\n\nimport Helmet from 'react-helmet';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\nimport { withStyles } from '@material-ui/core/styles';\n\nimport {\n  Divider as MuiDivider,\n  FormControl as MuiFormControl,\n  Grid as MuiGrid,\n  Typography,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  TextField as MuiTextField,\n  Button as MuiButton,\n  Card as MuiCard,\n  CardContent,\n  Box,\n  FormControlLabel,\n  Checkbox,\n  Snackbar,\n  IconButton,\n  ExpansionPanel,\n  ExpansionPanelDetails as MuiExpansionPanelDetails,\n  ExpansionPanelSummary,\n} from '@material-ui/core';\n\nimport {\n  Add as AddIcon,\n  Close as CloseIcon,\n  ExpandMore as ExpandMoreIcon,\n} from '@material-ui/icons';\n\nimport {\n  Save as SaveIcon,\n  Send as SendIcon,\n} from 'react-feather';\n\nimport { spacing } from '@material-ui/system';\nimport RedacticsContext from '../../contexts/RedacticsContext';\n\nimport DefaultRedactEmail from './DefaultRedactEmail';\nimport DefaultReplacement from './DefaultReplacement';\nimport DefaultRandomString from './DefaultRandomString';\nimport Preset from './Preset';\n\nimport {\n  CompanyUsers, RedactRuleSet, RedactRulePreset, RedactRuleConfig,\n  RedactRuleDefault,\n} from '../../types/redactics';\n\nconst Divider = styled(MuiDivider)(spacing);\n\nconst Card = styled(MuiCard)(spacing);\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\nconst Button = styled(MuiButton)(spacing);\n\nconst ExpansionPanelDetails = withStyles({\n  root: {\n    display: 'block',\n  },\n})(MuiExpansionPanelDetails);\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {}\n\ninterface IState {\n  uniquePresetKey: number;\n  incompletePreset: boolean;\n  redactEmailDefault: RedactRuleDefault;\n  redactReplacementDefault: RedactRuleDefault;\n  redactRandomStringDefault: RedactRuleDefault;\n  rulesets: RedactRuleSet[];\n  presets: RedactRulePreset[];\n  companyUsers: CompanyUsers[];\n  errors: any;\n  isOwner: boolean;\n  selectedPreset?: RedactRulePreset;\n  saveDefaultRulesButtonDisabled: boolean;\n  saveCustomPresetButtonDisabled: boolean;\n  showHelmReminder: boolean;\n  helmReminderCheckbox: boolean;\n  inviteUser: string;\n  invalidEmail: boolean;\n  ackHelmReminder: boolean;\n  showSnackbar: boolean;\n}\n\nclass Settings extends React.Component<IProps, IState> {\n  static contextType = RedacticsContext;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      uniquePresetKey: 0,\n      incompletePreset: false,\n      rulesets: [],\n      presets: [],\n      companyUsers: [],\n      errors: [],\n      isOwner: false,\n      saveDefaultRulesButtonDisabled: false,\n      saveCustomPresetButtonDisabled: false,\n      showHelmReminder: false,\n      helmReminderCheckbox: false,\n      inviteUser: '',\n      invalidEmail: false,\n      ackHelmReminder: false,\n      showSnackbar: false,\n      redactEmailDefault: {\n        redactData: {\n          prefix: 'redacted',\n          primaryKey: 'id',\n          domain: 'redactics.com',\n        },\n        uuid: '',\n      },\n      redactReplacementDefault: {\n        redactData: {\n          replacement: 'redacted',\n        },\n        uuid: '',\n      },\n      redactRandomStringDefault: {\n        redactData: {\n          chars: 24,\n        },\n        uuid: '',\n      },\n    };\n\n    this.refreshSettings = this.refreshSettings.bind(this);\n    this.addPreset = this.addPreset.bind(this);\n    this.saveDefaultRules = this.saveDefaultRules.bind(this);\n    this.handleRedactEmailChange = this.handleRedactEmailChange.bind(this);\n    this.handleReplacementChange = this.handleReplacementChange.bind(this);\n    this.handleRandomStringChange = this.handleRandomStringChange.bind(this);\n    this.handlePresetSave = this.handlePresetSave.bind(this);\n    this.handlePresetDelete = this.handlePresetDelete.bind(this);\n    this.hideHelmReminder = this.hideHelmReminder.bind(this);\n    this.toggleHelmReminder = this.toggleHelmReminder.bind(this);\n    this.handlePresetChange = this.handlePresetChange.bind(this);\n    this.toggleExpandPanel = this.toggleExpandPanel.bind(this);\n    this.validatePreset = this.validatePreset.bind(this);\n    this.validateDefaultPreset = this.validateDefaultPreset.bind(this);\n    this.hideErrorDialog = this.hideErrorDialog.bind(this);\n    this.handleInviteUser = this.handleInviteUser.bind(this);\n    this.inviteUser = this.inviteUser.bind(this);\n  }\n\n  async refreshSettings() {\n    try {\n      const response = await fetch(`${this.context.apiUrl}/settings`, {\n        credentials: 'include',\n      });\n\n      const data = await response.json();\n\n      const redactEmailDefault = data.defaults.find((d:RedactRuleSet) => d.rule === 'redact_email');\n      const redactReplacementDefault = data.defaults.find((d:RedactRuleSet) => d.rule === 'replacement');\n      const redactRandomStringDefault = data.defaults.find((d:RedactRuleSet) => d.rule === 'random_string');\n\n      // assign keys to presets\n      const presets:RedactRulePreset[] = [];\n      data.presets.forEach((p:RedactRulePreset) => {\n        presets.push({\n          presetName: p.presetName,\n          rule: p.rule,\n          redactData: p.redactData,\n          key: p.uuid,\n          uuid: p.uuid,\n        });\n      });\n\n      this.setState({\n        redactEmailDefault,\n        redactReplacementDefault,\n        redactRandomStringDefault,\n        rulesets: data.rulesets,\n        presets,\n        companyUsers: data.companyUsers,\n        isOwner: data.isOwner,\n      });\n    } catch (err) {\n      // console.log('CATCH ERR', error);\n    }\n  }\n\n  componentDidMount() {\n    // copy context data into component state\n    this.setState({\n      ackHelmReminder: this.context.ackHelmReminder,\n    });\n\n    this.refreshSettings();\n  }\n\n  handleRedactEmailChange(event:any) {\n    const { redactEmailDefault } = this.state;\n    if (redactEmailDefault && redactEmailDefault.redactData) {\n      redactEmailDefault.redactData[\n        event.target.name as keyof RedactRuleConfig\n      ] = event.target.value;\n      this.setState({\n        redactEmailDefault,\n      });\n    }\n  }\n\n  handleReplacementChange(event:any) {\n    const replacementDefault = this.state.redactReplacementDefault;\n    if (replacementDefault && replacementDefault.redactData) {\n      replacementDefault.redactData.replacement = event.target.value;\n      this.setState({\n        redactReplacementDefault: replacementDefault,\n      });\n    }\n  }\n\n  handleRandomStringChange(event:any) {\n    const { redactRandomStringDefault } = this.state;\n    if (redactRandomStringDefault && redactRandomStringDefault.redactData) {\n      redactRandomStringDefault.redactData.chars = event.target.value;\n      this.setState({\n        redactRandomStringDefault,\n      });\n    }\n  }\n\n  handlePresetChange(key: string, event: any) {\n    const { presets } = this.state;\n\n    presets.map((preset:RedactRulePreset) => {\n      const thisPreset = preset;\n      if (thisPreset.key === key && event.target.name === 'rule') {\n        // reset to defaults\n        switch (event.target.value) {\n          case 'redact_email':\n            thisPreset.rule = 'redact_email';\n            thisPreset.redactData = {\n              prefix: 'redacted',\n              primaryKey: 'id',\n              domain: 'redacted.com',\n            };\n            break;\n\n          case 'replacement':\n            thisPreset.rule = 'replacement';\n            thisPreset.redactData = {\n              replacement: 'redacted',\n            };\n            break;\n\n          case 'random_string':\n            thisPreset.rule = 'random_string';\n            thisPreset.redactData = {\n              chars: 24,\n            };\n            break;\n\n          default:\n        }\n      }\n\n      switch (event.target.name) {\n        case 'prefix':\n        case 'primaryKey':\n        case 'domain':\n        case 'replacement':\n        case 'chars':\n          thisPreset.redactData[event.target.name as keyof RedactRuleConfig] = event.target.value;\n          break;\n\n        case 'presetName':\n          thisPreset.presetName = event.target.value;\n          break;\n\n        default:\n          break;\n      }\n\n      return thisPreset;\n    });\n\n    this.setState({\n      presets,\n    });\n  }\n\n  validateDefaultPreset(payload:any) {\n    let incompletePreset = false;\n    if (!payload[0].redactData.prefix || !payload[0].redactData.primaryKey\n      || !payload[0].redactData.domain) {\n      incompletePreset = true;\n    } else if (!payload[1].redactData.replacement) {\n      incompletePreset = true;\n    } else if (!payload[2].redactData.chars) {\n      incompletePreset = true;\n    }\n    this.setState({\n      incompletePreset,\n    });\n    return !(incompletePreset);\n  }\n\n  validatePreset() {\n    let incompletePreset = false;\n    this.state.presets.forEach((p:RedactRulePreset) => {\n      if (!p.presetName || !p.rule) {\n        incompletePreset = true;\n      } else if (p.rule === 'redact_email' && (!p.redactData.prefix || !p.redactData.primaryKey || !p.redactData.domain)) {\n        incompletePreset = true;\n      } else if (p.rule === 'replacement' && !p.redactData.replacement) {\n        incompletePreset = true;\n      } else if (p.rule === 'random_string' && !p.redactData.chars) {\n        incompletePreset = true;\n      }\n    });\n    this.setState({\n      incompletePreset,\n    });\n    return !(incompletePreset);\n  }\n\n  hideErrorDialog() {\n    this.setState({\n      incompletePreset: false,\n      invalidEmail: false,\n    });\n  }\n\n  async handlePresetSave() {\n    if (this.validatePreset()) {\n      this.setState({\n        saveCustomPresetButtonDisabled: true,\n      });\n\n      try {\n        await fetch(`${this.context.apiUrl}/settings/presets`, {\n          method: 'post',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          credentials: 'include',\n          body: JSON.stringify(this.state.presets),\n        });\n\n        // update all UUIDs tracked to state\n        this.refreshSettings();\n\n        // close all expansion panels\n        const presets = this.state.presets.map((p:RedactRulePreset) => {\n          const thisPreset = p;\n          thisPreset.expanded = false;\n          return thisPreset;\n        });\n\n        if (!this.state.ackHelmReminder) {\n          this.setState({\n            showHelmReminder: true,\n            showSnackbar: false,\n            saveCustomPresetButtonDisabled: false,\n            presets,\n          });\n        } else {\n          this.setState({\n            showHelmReminder: false,\n            showSnackbar: true,\n            saveCustomPresetButtonDisabled: false,\n            presets,\n          });\n        }\n      } catch (err) {\n        this.setState({\n          saveCustomPresetButtonDisabled: false,\n        });\n      }\n    } else {\n      this.setState({\n        saveCustomPresetButtonDisabled: false,\n      });\n    }\n  }\n\n  handleSnackbarClose = () => {\n    this.setState({ showSnackbar: false });\n  };\n\n  handlePresetDelete(preset:RedactRulePreset) {\n    const uniquePresetKey = this.state.uniquePresetKey + 1; // random array idx value\n\n    const presets = this.state.presets.filter((p:RedactRulePreset) => {\n      const thisPreset = p;\n      if (thisPreset.key === preset.key) {\n        // mark for deletion\n        thisPreset.key = `delete${uniquePresetKey}`;\n      }\n\n      return thisPreset;\n    });\n\n    this.setState({\n      presets,\n    });\n  }\n\n  addPreset() {\n    const { presets } = this.state;\n    const uniquePresetKey = this.state.uniquePresetKey + 1; // random array idx value\n\n    presets.unshift({\n      presetName: 'New Preset',\n      rule: '',\n      redactData: {},\n      key: `new${uniquePresetKey}`,\n      expanded: true,\n    });\n\n    this.setState({\n      presets,\n      uniquePresetKey,\n    });\n  }\n\n  async saveDefaultRules() {\n    this.setState({\n      saveDefaultRulesButtonDisabled: true,\n    });\n    const payload:any = [];\n    if (this.state.redactEmailDefault) {\n      payload.push({\n        uuid: this.state.redactEmailDefault.uuid,\n        redactData: this.state.redactEmailDefault.redactData,\n      });\n    }\n    if (this.state.redactReplacementDefault) {\n      payload.push({\n        uuid: this.state.redactReplacementDefault.uuid,\n        redactData: this.state.redactReplacementDefault.redactData,\n      });\n    }\n    if (this.state.redactRandomStringDefault) {\n      payload.push({\n        uuid: this.state.redactRandomStringDefault.uuid,\n        redactData: this.state.redactRandomStringDefault.redactData,\n      });\n    }\n\n    if (this.validateDefaultPreset(payload)) {\n      try {\n        await fetch(`${this.context.apiUrl}/settings/saveRuleDefaults`, {\n          method: 'put',\n          credentials: 'include',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(payload),\n        });\n\n        if (!this.state.ackHelmReminder) {\n          this.setState({\n            showHelmReminder: true,\n            showSnackbar: false,\n            saveDefaultRulesButtonDisabled: false,\n          });\n        } else {\n          this.setState({\n            showHelmReminder: false,\n            showSnackbar: true,\n            saveDefaultRulesButtonDisabled: false,\n          });\n        }\n      } catch (err) {\n        // console.log('ERR', error);\n      }\n    } else {\n      this.setState({\n        saveDefaultRulesButtonDisabled: false,\n      });\n    }\n  }\n\n  async hideHelmReminder() {\n    if (this.state.helmReminderCheckbox) {\n      // record acknowledgement of reminder\n      await fetch(`${this.context.apiUrl}/database/ackReminder`, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n      });\n\n      this.setState({\n        ackHelmReminder: true,\n        showHelmReminder: false,\n      });\n    } else {\n      this.setState({\n        showHelmReminder: false,\n      });\n    }\n  }\n\n  toggleHelmReminder(event: any) {\n    this.setState({\n      helmReminderCheckbox: (!!event.target.checked),\n    });\n  }\n\n  toggleExpandPanel(event: any, preset:RedactRulePreset) {\n    const presets = this.state.presets.map((p:RedactRulePreset) => {\n      const thisPreset = p;\n      if (thisPreset.key === preset.key) {\n        thisPreset.expanded = !thisPreset.expanded;\n      }\n\n      return thisPreset;\n    });\n\n    this.setState({\n      presets,\n    });\n  }\n\n  handleInviteUser(event: any) {\n    this.setState({\n      inviteUser: event.target.value,\n    });\n  }\n\n  async inviteUser() {\n    const { companyUsers } = this.state;\n\n    try {\n      const response = await fetch(`${this.context.apiUrl}/users/invite`, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          email: this.state.inviteUser,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (data.errors) {\n        // invalid email\n        this.setState({\n          invalidEmail: true,\n          errors: {\n            inviteUser: true,\n          },\n        });\n      } else {\n        companyUsers.push({\n          email: this.state.inviteUser,\n          invitePending: true,\n        });\n\n        this.setState({\n          companyUsers,\n          inviteUser: '',\n          errors: {},\n        });\n      }\n    } catch (err) {\n      // console.log('CATCH ERR', error);\n    }\n  }\n\n  /* eslint-disable max-len */\n\n  render() {\n    return (\n      <React.Fragment>\n        <Helmet title=\"Settings\" />\n\n        <Typography variant=\"h1\" gutterBottom display=\"inline\">\n          Settings\n        </Typography>\n\n        <Divider my={6} />\n\n        <Card mb={6}>\n          <CardContent>\n            <Typography variant=\"h4\" gutterBottom>\n              Default Redaction Rule Settings\n            </Typography>\n\n            <Box mt={4}>\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography variant=\"h6\">Redact Email</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  {\n                    this.state.redactEmailDefault ? <DefaultRedactEmail ruleDefaults={this.state.redactEmailDefault} handleRedactEmailChange={this.handleRedactEmailChange} /> : ''\n                  }\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography variant=\"h6\">Replacement</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  {\n                    this.state.redactReplacementDefault ? <DefaultReplacement ruleDefaults={this.state.redactReplacementDefault} handleReplacementChange={this.handleReplacementChange} /> : ''\n                  }\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography variant=\"h6\">Random String</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  {\n                    this.state.redactRandomStringDefault ? <DefaultRandomString ruleDefaults={this.state.redactRandomStringDefault} handleRandomStringChange={this.handleRandomStringChange} /> : ''\n                  }\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n            </Box>\n\n            <Button variant=\"contained\" disabled={this.state.saveDefaultRulesButtonDisabled} color=\"primary\" size=\"large\" mt={8} onClick={this.saveDefaultRules}>\n              <SaveIcon />&nbsp;Save Changes\n            </Button>\n\n          </CardContent>\n        </Card>\n\n        <Grid\n          justify=\"flex-end\"\n          container\n          spacing={10}\n          mt={10}\n        >\n\n          <Grid item>\n            <Button variant=\"contained\" color=\"primary\" onClick={this.addPreset}>\n              <AddIcon />&nbsp;\n              Add Preset\n            </Button>\n          </Grid>\n        </Grid>\n\n        <Card mb={6} mt={2}>\n          <CardContent>\n\n            <Typography variant=\"h4\" gutterBottom>\n              Custom Redaction Rule Presets\n            </Typography>\n\n            <Box width={1 / 2} mt={8}>\n              <Typography variant=\"body1\" gutterBottom>\n                Redaction rule presets allow you to create reusable settings that can be set on your database fields while eliminating a lot of extra input. Simply define your preset here and it will appear as a redaction rule option in the Databases section of this app.\n              </Typography>\n            </Box>\n\n            <Box mt={4}>\n              {this.state.presets.map((preset: RedactRulePreset) => {\n                if (preset.key && !preset.key.match(/^delete/)) {\n                  return (\n                    <ExpansionPanel\n                      expanded={preset.expanded}\n                      onChange={(event) => this.toggleExpandPanel(event, preset)}\n                      key={preset.key}\n                    >\n                      <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                        <Typography variant=\"h6\">{preset.presetName}</Typography>\n                      </ExpansionPanelSummary>\n                      <ExpansionPanelDetails>\n                        <Preset key={preset.key} rulesets={this.state.rulesets} selectedPreset={preset} handlePresetChange={this.handlePresetChange} deletePreset={this.handlePresetDelete} />\n                      </ExpansionPanelDetails>\n                    </ExpansionPanel>\n                  );\n                }\n\n                return null;\n              })}\n            </Box>\n\n            <Box mt={8}>\n              <Button variant=\"contained\" color=\"primary\" size=\"large\" disabled={this.state.saveCustomPresetButtonDisabled} onClick={this.handlePresetSave}>\n                <SaveIcon />&nbsp;Save Changes\n              </Button>\n            </Box>\n          </CardContent>\n        </Card>\n\n        <Card mb={6} mt={2}>\n          <CardContent>\n\n            <Typography variant=\"h4\" gutterBottom>\n              Company Settings\n            </Typography>\n\n            <Box mt={8}>\n              <Typography variant=\"h6\" gutterBottom>\n                Current Users\n              </Typography>\n\n              <ul>\n                {\n                  this.state.companyUsers.map((u:CompanyUsers, idx:number) => {\n                    if (u.isOwner) {\n                      return (\n                        <li key={idx}><b>{u.firstName} {u.lastName}</b>: {u.email} (owner)</li>\n                      );\n                    } if (u.invitePending) {\n                      return (\n                        <li key={idx}>{u.email} (pending acceptance of invitation)</li>\n                      );\n                    }\n                    return (\n                        <li key={idx}><b>{u.firstName} {u.lastName}</b>: {u.email}</li>\n                    );\n                  })\n                }\n              </ul>\n            </Box>\n\n            <Box mt={8}>\n              <Typography variant=\"h6\" gutterBottom>\n                Invite User\n              </Typography>\n\n              <FormControl fullWidth margin=\"normal\">\n                <TextField\n                  error={this.state.errors.inviteUser}\n                  name=\"inviteUser\"\n                  label=\"Invite Email Address\"\n                  placeholder=\"user@yourcompany.com\"\n                  value={this.state.inviteUser}\n                  onChange={(event) => this.handleInviteUser(event)}\n                />\n              </FormControl>\n\n              <Button variant=\"contained\" onClick={this.inviteUser} size=\"large\" mt={8} color=\"primary\" autoFocus>\n                <SendIcon />&nbsp;Email User Invitation\n              </Button>\n\n            </Box>\n\n          </CardContent>\n        </Card>\n\n        <Dialog\n          open={this.state.showHelmReminder}\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n        >\n          <DialogTitle id=\"dialog-title\">Your changes have been saved!</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"dialog-description\">\n              However, they will not be applied to your Kubernetes cluster until you run the <code>helm upgrade</code> command that is provided when you click on the <b>Generate Helm Upgrade Command</b> button (located in the <i>Databases</i> section).\n            </DialogContentText>\n\n            <Box mt={4}>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={this.state.helmReminderCheckbox}\n                    onChange={this.toggleHelmReminder}\n                    name=\"helmReminder\"\n                    color=\"primary\"\n                  />\n                }\n                label=\"I got it, don't remind me again\"\n              />\n            </Box>\n\n            <DialogActions>\n              <Button onClick={this.hideHelmReminder} color=\"primary\" autoFocus>\n                Okay\n              </Button>\n            </DialogActions>\n\n          </DialogContent>\n        </Dialog>\n\n        <Dialog\n          open={this.state.incompletePreset}\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n        >\n          <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"dialog-description\">\n              One or more of your preset rules contains a blank value\n            </DialogContentText>\n\n            <DialogActions>\n              <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                Okay\n              </Button>\n            </DialogActions>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog\n          open={this.state.invalidEmail}\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n        >\n          <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"dialog-description\">\n              You have entered an invalid email address, an address for a user already invited, or an address for a user already in your company.\n            </DialogContentText>\n\n            <DialogActions>\n              <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                Okay\n              </Button>\n            </DialogActions>\n          </DialogContent>\n        </Dialog>\n\n        <Snackbar\n          anchorOrigin={{\n            vertical: 'top',\n            horizontal: 'right',\n          }}\n          open={this.state.showSnackbar}\n          autoHideDuration={8000}\n          onClose={this.handleSnackbarClose}\n          ContentProps={{\n            'aria-describedby': 'message-id',\n          }}\n          message={<span id=\"message-id\"><b>Saved!</b> Please find your updated helm upgrade command in the &quot;Agents&quot; section...</span>}\n          action={[\n            <IconButton\n              key=\"close\"\n              aria-label=\"Close\"\n              color=\"inherit\"\n              onClick={this.handleSnackbarClose}\n            >\n              <CloseIcon />\n            </IconButton>,\n          ]}\n        />\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Settings;\n",["227","228","229"],"/Users/joe/www/redactics-osedition/react/src/pages/developers/Main.tsx",[],"/Users/joe/www/redactics-osedition/react/src/pages/workflows/Main.tsx",["230","231","232","233","234"],"import React from 'react';\nimport styled from 'styled-components';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Helmet from 'react-helmet';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  Divider as MuiDivider,\n  FormControl as MuiFormControl,\n  Grid as MuiGrid,\n  Typography,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  ExpansionPanel,\n  ExpansionPanelDetails,\n  ExpansionPanelSummary,\n  TextField as MuiTextField,\n  Button as MuiButton,\n  InputLabel,\n  Select as MuiSelect,\n  MenuItem,\n  Box,\n  InputAdornment,\n  Tooltip,\n} from '@material-ui/core';\n\nimport {\n  Add as AddIcon,\n  ExpandMore as ExpandMoreIcon,\n  FormatListBulleted as FormatListBulletedIcon,\n  HelpOutline as HelpIcon,\n} from '@material-ui/icons';\n\nimport {\n  Save as SaveIcon,\n} from 'react-feather';\n\nimport { spacing } from '@material-ui/system';\nimport {\n  WorkflowRecord, AgentInputRecord, AgentRecord, RedactRuleSet, RedactRulePreset,\n} from '../../types/redactics';\nimport RedacticsContext from '../../contexts/RedacticsContext';\n\nimport Workflow from './Workflow';\n\nconst Divider = styled(MuiDivider)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 400px;\n  max-width: 400px;\n`;\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 400px;\n`;\n\nconst Select = styled(MuiSelect)(spacing);\n\nconst Button = styled(MuiButton)(spacing);\n\nconst styles = {\n  selectAdornment: {\n    marginRight: '-30px',\n  },\n};\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n  classes: any;\n}\n\ninterface IState {\n  saveButtonDisabled: boolean;\n  ruleLegendDialog: boolean;\n  newWorkflowDialog: boolean;\n  workflows: WorkflowRecord[];\n  agentInputs: AgentInputRecord[];\n  presets: RedactRulePreset[];\n  redactrulesets: RedactRuleSet[];\n  agents: AgentRecord[];\n  newWorkflowName: string;\n  newWorkflowAgent: string;\n  newWorkflowType: string;\n  dbLimitError: boolean;\n  // dialog toggles\n  deleteWorkflowConfirmation: boolean;\n}\n\nclass Workflows extends React.Component<IProps, IState> {\n  static contextType = RedacticsContext;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      saveButtonDisabled: true,\n      ruleLegendDialog: false,\n      newWorkflowDialog: false,\n      workflows: [],\n      agentInputs: [],\n      presets: [],\n      redactrulesets: [],\n      agents: [],\n      newWorkflowName: '',\n      newWorkflowAgent: '',\n      newWorkflowType: '',\n      dbLimitError: false,\n      deleteWorkflowConfirmation: false,\n    };\n\n    this.handleChangeAdd = this.handleChangeAdd.bind(this);\n    this.handleWFChanges = this.handleWFChanges.bind(this);\n    this.addWorkflow = this.addWorkflow.bind(this);\n    this.ruleLegendOpen = this.ruleLegendOpen.bind(this);\n    this.ruleLegendClose = this.ruleLegendClose.bind(this);\n    this.newWorkflowOpen = this.newWorkflowOpen.bind(this);\n    this.newWorkflowClose = this.newWorkflowClose.bind(this);\n    this.refreshWorkflows = this.refreshWorkflows.bind(this);\n    this.deleteWorkflow = this.deleteWorkflow.bind(this);\n    this.dbLimitErrorClose = this.dbLimitErrorClose.bind(this);\n  }\n\n  async refreshWorkflows() {\n    try {\n      const response = await fetch(`${this.context.apiUrl}/workflow`, {\n        credentials: 'include',\n      });\n\n      const data = await response.json();\n\n      data.workflows.map((workflow:any) => {\n        // set some defaults\n        workflow.migrationNamespace = workflow.migrationNamespace || \"default\";\n        workflow.migrationDatabaseClone = workflow.migrationDatabaseClone || \"redactics_clone\";\n\n        return workflow;\n      });\n\n      this.setState({\n        workflows: data.workflows,\n        agentInputs: data.agentInputs,\n        presets: data.presets,\n        redactrulesets: data.redactrulesets,\n        agents: data.agents,\n      });\n    } catch (err) {\n      // console.log('CATCH ERR', error);\n    }\n  }\n\n  componentDidMount() {\n    this.refreshWorkflows();\n  }\n\n  handleChangeAdd(event:any) {\n    const state:IState = this.state;\n\n    switch (event.target.name) {\n      case 'name':\n        state.newWorkflowName = event.target.value;\n        state.saveButtonDisabled = (state.newWorkflowType === \"ERL\")\n          ? !(event.target.value && state.newWorkflowAgent)\n          : !(event.target.value && state.newWorkflowType);\n        this.setState(state);\n        break;\n\n      case 'agentId':\n        state.newWorkflowAgent = event.target.value;\n        state.saveButtonDisabled = !(state.newWorkflowName);\n        this.setState(state);\n        break;\n\n      case 'workflowType':\n        state.newWorkflowType = event.target.value;\n        state.saveButtonDisabled = (event.target.value === \"ERL\")\n        ? !(state.newWorkflowName && state.newWorkflowAgent)\n        : !(state.newWorkflowName && state.newWorkflowType);\n        this.setState(state);\n        break;\n\n      default:\n    }\n  }\n\n  async addWorkflow() {\n    this.setState({\n      saveButtonDisabled: true,\n    });\n\n    try {\n      const response = await fetch(`${this.context.apiUrl}/workflow`, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          name: this.state.newWorkflowName,\n          agentId: this.state.newWorkflowAgent,\n          workflowType: this.state.newWorkflowType,\n        }),\n      });\n\n      const data = await response.json();\n      const { workflows } = this.state;\n      if (this.state.newWorkflowType === \"multiTenantWebERL\") {\n        // handle preset input\n        data.inputs[0].tables.forEach((table:string) => {\n          data.allDatabaseTables.push(data.inputs[0].inputName + \": \" + table);\n        })\n      }\n      workflows.push(data);\n\n      this.setState({\n        workflows,\n        newWorkflowDialog: false,\n        newWorkflowName: '',\n        newWorkflowAgent: '',\n      });\n    } catch (err) {\n      // console.log('CATCH ERR', error);\n    }\n  }\n\n  async deleteWorkflow(workflowId:string) {\n    try {\n      await fetch(`${this.context.apiUrl}/workflow/${workflowId}`, {\n        method: 'delete',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n      });\n\n      this.refreshWorkflows();\n\n      this.setState({\n        deleteWorkflowConfirmation: false,\n      });\n    } catch (err) {\n      this.setState({\n        deleteWorkflowConfirmation: false,\n      });\n    }\n  }\n\n  newWorkflowOpen() {\n    this.setState({\n      newWorkflowDialog: true,\n    });\n  }\n\n  newWorkflowClose() {\n    this.setState({\n      newWorkflowDialog: false,\n    });\n  }\n\n  dbLimitErrorClose() {\n    this.setState({\n      dbLimitError: false,\n    });\n  }\n\n  ruleLegendOpen() {\n    this.setState({\n      ruleLegendDialog: true,\n    });\n  }\n\n  ruleLegendClose() {\n    this.setState({\n      ruleLegendDialog: false,\n    });\n  }\n\n  handleWFChanges(event:any, workflowId:string) {\n    const workflows = this.state.workflows.map((d:any) => {\n      const workflow = d;\n      if (workflow.uuid === workflowId) {\n        workflow[event.target.name] = event.target.value;\n      }\n\n      return workflow;\n    });\n\n    this.setState({\n      workflows,\n    });\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <Helmet title=\"Workflow Configurations\" />\n\n        <Grid\n          justify=\"space-between\"\n          container\n          spacing={10}\n        >\n          <Grid item xs={4} mb={6}>\n            <Typography variant=\"h1\" gutterBottom display=\"inline\">\n              Workflow Configurations\n            </Typography>\n          </Grid>\n        </Grid>\n\n        <Divider my={6} />\n\n        <Box mt={4}>\n          <Typography variant=\"body1\" gutterBottom>\n            Build and maintain your data management workflows here. Configuration changes will be picked up by your Agent install usually within a few minutes.\n          </Typography>\n        </Box>\n\n        <Grid\n          justify=\"space-between\"\n          container\n          spacing={10}\n          mt={8}\n        >\n          <Grid item></Grid>\n          <Grid item mb={6}>\n            <div>\n              <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.ruleLegendOpen}>\n                <FormatListBulletedIcon />&nbsp;\n                PII Ruleset Legend\n              </Button>&nbsp;\n              <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.newWorkflowOpen}>\n                <AddIcon />&nbsp;\n                Define New Workflow\n              </Button>\n            </div>\n          </Grid>\n        </Grid>\n\n        <Dialog\n          open={this.state.ruleLegendDialog}\n          onClose={this.ruleLegendClose}\n          aria-labelledby=\"legend-title\"\n          aria-describedby=\"legend-description\"\n        >\n          <DialogTitle id=\"legend-title\">PII Ruleset Legend</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"legend-description\">\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Redact Email</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <Typography>\n                    Transform emails to unique email address derived from the row&apos;s primary\n                    key, constructed based on provided prefix and domain - i.e.\n                    <code>[prefix][primarykey]@[domain]</code>\n                  </Typography>\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Destruction</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <Typography>\n                    Replace data with a null value\n                  </Typography>\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Replacement</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <Typography>\n                    Replace data with a provided value\n                  </Typography>\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Random String</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <Typography>\n                    Replace data with a random alphanumeric string of a provided length\n                  </Typography>\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n            </DialogContentText>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog\n          open={this.state.newWorkflowDialog}\n          onClose={this.newWorkflowClose}\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n        >\n          <DialogTitle id=\"dialog-title\">Add Workflow</DialogTitle>\n          <DialogContent>\n            <form noValidate autoComplete=\"off\">\n              <Box>\n                Create a name for this workflow, and assign a Redactics Agent to carry out the work defined by this workflow.\n              </Box>\n\n              <Box mt={4}>\n                <FormControl fullWidth>\n                  <TextField\n                    name=\"name\"\n                    label=\"Workflow Name\"\n                    onChange={this.handleChangeAdd}\n                    value={this.state.newWorkflowName}\n                  />\n                </FormControl>\n              </Box>\n\n              <Box mt={4}>\n                <FormControl margin=\"dense\" fullWidth>\n                  <InputLabel>\n                    Workflow Type\n                  </InputLabel>\n                  <Select\n                    value={this.state.newWorkflowType}\n                    name=\"workflowType\"\n                    onChange={this.handleChangeAdd}\n                    endAdornment={\n                      <InputAdornment className={this.props.classes.selectAdornment} position=\"end\">\n                        <Tooltip title=\"The web-based ERL testing option allows you to test ERL workflows with some preset sample dataset options without having to install the Redactics Agent into your own infrastructure. This option is multi-tenant, but a single-tenant mode is available you can run with your own datasets - contact us for more info.\" placement=\"right-start\"><HelpIcon /></Tooltip>\n                      </InputAdornment>\n                    }\n                  >\n                    <MenuItem key=\"ERL\" value=\"ERL\">ERL (Extract, Redact, Load)</MenuItem>\n                    <MenuItem key=\"multiTenantWebERL\" value=\"multiTenantWebERL\">Web-based ERL Testing</MenuItem>\n                    <MenuItem key=\"mockDatabaseMigration\" value=\"mockDatabaseMigration\">Database Clone for Migration Dry-run</MenuItem>\n                  </Select>\n                </FormControl>\n              </Box>\n\n              <Box mt={4} display={(this.state.newWorkflowType.match(/^(ERL|mockDatabaseMigration)/)) ? 'block' : 'none'}>\n                <FormControl fullWidth>\n                  <InputLabel htmlFor=\"agentId\">Redactics Agent</InputLabel>\n                  <Select\n                    name=\"agentId\"\n                    onChange={this.handleChangeAdd}\n                    value={this.state.newWorkflowAgent}\n                  >\n                    {this.state.agents.map((agent:AgentRecord) => (\n                      <MenuItem key={agent.uuid} value={agent.uuid}>{agent.name}</MenuItem>\n                    ))}\n                  </Select>\n                </FormControl>\n              </Box>\n\n              <Box mt={8}>\n                <DialogActions>\n                  <Button color=\"secondary\" onClick={this.newWorkflowClose}>\n                    Cancel\n                  </Button>\n\n                  <Button color=\"secondary\" variant=\"contained\" disabled={this.state.saveButtonDisabled} onClick={this.addWorkflow}>\n                    Save&nbsp;<SaveIcon />\n                  </Button>\n                </DialogActions>\n              </Box>\n            </form>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog\n          open={this.state.dbLimitError}\n          onClose={this.dbLimitErrorClose}\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n        >\n          <DialogTitle id=\"dialog-title\">You&apos;ve Reached Your Account Limit</DialogTitle>\n          <DialogContent>\n            <Box>\n              This Redactics account is currently limited to support defining only a single\n              database. Please contact us if you wish to upgrade this account.\n            </Box>\n\n            <DialogActions>\n              <Button color=\"secondary\" onClick={this.dbLimitErrorClose}>\n                Okay\n              </Button>\n            </DialogActions>\n          </DialogContent>\n        </Dialog>\n\n        {this.state.workflows.map((workflow:WorkflowRecord) => <Workflow\n          workflow={workflow}\n          presets={this.state.presets}\n          redactrulesets={this.state.redactrulesets}\n          agents={this.state.agents}\n          agentInputs={this.state.agentInputs}\n          key={workflow.uuid}\n          handleWFChanges={this.handleWFChanges}\n          deleteWorkflow={this.deleteWorkflow}\n        />)}\n\n      </React.Fragment>\n    );\n  }\n}\n\n\nexport default withStyles(styles)(Workflows);","/Users/joe/www/redactics-osedition/react/src/pages/workflows/JobListing.tsx",["235"],"import React from 'react';\nimport styled from 'styled-components';\n\nimport Helmet from 'react-helmet';\nimport Moment from 'react-moment';\n\nimport { red, green } from \"@material-ui/core/colors\";\n\nimport {\n  Divider as MuiDivider,\n  Grid as MuiGrid,\n  Typography,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Button as MuiButton,\n  Box,\n  Chip,\n  Card as MuiCard,\n  CardContent,\n  CircularProgress,\n  LinearProgress,\n  Link,\n} from '@material-ui/core';\n\nimport {\n  Check as CheckIcon,\n  ErrorOutline as ErrorOutlineIcon,\n} from '@material-ui/icons';\n\nimport { spacing } from '@material-ui/system';\nimport {\n  WorkflowJob,\n} from '../../types/redactics';\nimport RedacticsContext from '../../contexts/RedacticsContext';\n\nconst Card = styled(MuiCard)(spacing);\n\nconst Divider = styled(MuiDivider)(spacing);\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst Button = styled(MuiButton)(spacing);\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {}\n\ninterface IState {\n  // TODO: come up with WF Jobs typescript type\n  jobs: any[];\n  fbSubs: string[];\n  stackTrace: string;\n  showException: boolean;\n  dataFetched: boolean;\n}\n\nclass JobListing extends React.Component<IProps, IState> {\n  static contextType = RedacticsContext;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      dataFetched: false,\n      jobs: [],\n      fbSubs: [],\n      stackTrace: \"\",\n      showException: false,\n    };\n\n    this.showException = this.showException.bind(this);\n    this.hideDialog = this.hideDialog.bind(this);\n  }\n\n  componentDidMount() {\n    this.refreshJobListing();\n\n    // const jobs = ref(fbDatabase, `workflowJobProgress/${this.context.companyId}/triggerRefresh`);\n    // onValue(jobs, (snapshot) => {\n    //   const data = snapshot.val();\n    //   if (!data) { return; }\n\n    //   if (data.refresh) {\n    //     this.refreshJobListing();\n    //   }\n    // });\n  }\n\n  showException(event:any, job:WorkflowJob) {\n    event.preventDefault();\n\n    this.setState({\n      showException: true,\n      stackTrace: job.stackTrace,\n    })\n  }\n\n  hideDialog() {\n    this.setState({\n      showException: false,\n    })\n  }\n\n  async refreshJobListing() {\n    try {\n      const response = await fetch(`${this.context.apiUrl}/database/jobs`, {\n          credentials: 'include',\n      });\n\n      const data = await response.json();\n\n      data.forEach((job:WorkflowJob) => {\n        if (job.status === \"inProgress\" || job.status === \"queued\") {\n          this.initFirebaseSubscription(job.uuid);\n        }\n      })\n\n      this.setState({\n        jobs: data,\n        dataFetched: true,\n      });\n    } catch (err) {\n    // console.log('CATCH ERR', error);\n    }\n  }\n\n  initFirebaseSubscription(jobId:string) {\n    // if (this.state.fbSubs.includes(jobId)) {\n    //   // don't subscribe more than once\n    //   return; \n    // }\n    // const jobs = query(ref(fbDatabase, `workflowJobProgress/${this.context.companyId}/${jobId}`));\n    // onValue(jobs, (snapshot) => {\n    //   const data = snapshot.val();\n    //   if (!data) { return; }\n\n    //   // update state\n    //   const wfJobs = this.state.jobs.map((j:WorkflowJob) => {\n    //     const job = j;\n        \n    //     job.progress = ([\"inProgress\", \"queued\"].includes(job.status) && job.uuid === data.uuid) ? data.progress : null;\n        \n    //     // update frontend values before next refresh\n    //     if (job.progress === 100) {\n    //       // transition from inProgress\n    //       job.status = \"completed\";\n    //     }\n    //     else if (job.progress) {\n    //       // transition from queued\n    //       job.status = \"inProgress\";\n    //     }\n\n    //     return job;\n    //   });\n      \n    //   const fbSubs = this.state.fbSubs;\n    //   if (!fbSubs.includes(jobId)) { fbSubs.push(jobId); }\n\n    //   this.setState({\n    //     jobs: wfJobs,\n    //     fbSubs: fbSubs,\n    //   })\n    // });\n  }\n\n  progressBar(job:WorkflowJob) {\n    return (job.progress && job.progress < 100) ? (\n      <Box mt={4}>\n        <LinearProgress\n          variant=\"determinate\"\n          value={job.progress}\n        />\n      </Box>\n    ) : null;\n  }\n\n  statusIcon(job:WorkflowJob) {\n    switch (job.status) {\n      case 'inProgress':\n      case 'queued':\n        return (\n          <CircularProgress />\n        );\n\n      case 'completed':\n        return (\n          <CheckIcon style={{ color: green[500], fontSize: 50 }} />\n        )\n\n      case 'error':\n        return (\n          <ErrorOutlineIcon style={{ color: red[500], fontSize: 50 }} />\n        )\n\n      default:\n      break;\n    }\n  }\n\n  workflowType(job:WorkflowJob) {\n    switch (job.workflowType) {\n      case 'multiTenantWebERL':\n        return (\n          <Typography variant=\"h5\" gutterBottom>\n            Web-based ERL Testing\n          </Typography>\n        )\n\n      case 'ERL':\n        return (\n          <Typography variant=\"h5\" gutterBottom>\n            ERL (Extract, Redact, Load)\n          </Typography>\n        )\n\n      case 'sampletable-athletes':\n        return (\n          <Typography variant=\"h5\" gutterBottom>\n            Install Sample Table: Athletes\n          </Typography>\n        )\n\n      case 'sampletable-marketing_campaign':\n        return (\n          <Typography variant=\"h5\" gutterBottom>\n            Install Sample Table: Marketing Campaign\n          </Typography>\n        )\n\n      case 'piiscanner':\n        return (\n          <Typography variant=\"h5\" gutterBottom>\n            PII Scanner\n          </Typography>\n        )\n\n      case 'usersearch':\n        return (\n          <Typography variant=\"h5\" gutterBottom>\n            Forget User\n          </Typography>\n        )\n\n      case 'mockDatabaseMigration':\n        return (\n          <Typography variant=\"h5\" gutterBottom>\n            Database Clone for Migration Dry-run\n          </Typography>\n        )\n\n      default:\n      break;\n    } \n  }\n\n  displayFile(url:string) {\n    const urlArray = url.split('/');\n    return urlArray[(urlArray.length - 1)];\n  }\n\n  workflowInfo(job:WorkflowJob) {\n    return (job.databaseId) ? (\n      <Box>\n        Workflow: {job.workflowName} (<code>{job.databaseId}</code>)\n      </Box>\n    ) : null;\n  }\n\n  results(job:WorkflowJob) {\n    let outputSummary:any = null;\n    let outputInfo:any = null;\n    if (job.status === \"completed\" && job.createdAt !== job.lastTaskEnd) {\n      if (job.workflowType === \"piiscanner\") {\n        outputInfo = (\n          <span>\n            Access the <Link href=\"/usecases/piiscanner\" target=\"_blank\">PII Scanner</Link> page to view the results of this scan.\n          </span>\n        )\n      }\n      else if (job.workflowType === \"usersearch\") {\n        outputInfo = (\n          <span>\n            Access the generated SQL via the <code>download-export</code> Redactics CLI command, and the receipt of this SQL generation <Link href=\"/usecases/forgetuser\" target=\"_blank\">here</Link>.\n          </span>\n        )\n      }\n      outputSummary = job.outputLinks ? (\n        <Box>\n          <Box>\n            <b>Completed in <Moment duration={job.createdAt} date={job.lastTaskEnd} /></b>. {job.outputSummary || outputInfo}\n          </Box>\n          <Box mt={2}>\n            <ul>\n              {job.outputLinks.map((u:string) => (\n                <li><Link href={u} target=\"_blank\">{this.displayFile(u)}</Link></li>\n              ))}\n            </ul>\n          </Box>\n        </Box>\n      ) : (\n        <Box>\n          <b>Completed in <Moment duration={job.createdAt} date={job.lastTaskEnd} /></b>. {job.outputSummary || outputInfo}\n        </Box>\n      )\n    }\n    else if (job.status === \"error\") {\n      const exceptionMsg = (job.exception && job.exception.length > 150) ? job.exception.substring(0,149) + \"...\" : job.exception;\n      outputSummary = (\n        <Box>\n          <Link href=\"#\" onClick={(event) => this.showException(event, job)}><b>{exceptionMsg}</b></Link>\n        </Box>\n      )\n    }\n\n    return (outputSummary) ? (\n      <Box mt={4}>\n        {outputSummary}\n      </Box>\n    ) : null;\n  }\n\n  initialCopies(job:WorkflowJob) {\n    if (job.outputMetadata && job.outputMetadata.initialCopies && job.outputMetadata.initialCopies.length) {\n      return (\n        <Box mt={4}>\n          <b>Full Copied Tables</b>\n\n          <Box mt={4}>\n            {job.outputMetadata.initialCopies.map((table:string) => {\n              return (\n                <Box display=\"inline\" mr={1}>\n                  <Chip\n                    key={table}\n                    label={table}\n                    variant=\"outlined\"\n                    color=\"primary\"\n                    size=\"small\"\n                  />\n                </Box>\n              )\n            })}\n          </Box>\n        </Box>\n      )\n    }\n  }\n\n  copySummary(job:WorkflowJob) {\n    if (job.outputMetadata && job.outputMetadata.copySummary && job.outputMetadata.copySummary.length) {\n      return (\n        <Box mt={4}>\n          <b>Copy Summary</b>\n\n          <Box mt={4}>\n            <ul>\n              {job.outputMetadata.copySummary.map((summary:string) => {\n                return (\n                  <li>{summary}</li>\n                )\n              })}\n            </ul>\n          </Box>\n        </Box>\n      )\n    }\n  }\n\n  deltaCopies(job:WorkflowJob) {\n    if (job.outputMetadata && job.outputMetadata.deltaCopies && job.outputMetadata.deltaCopies.length) {\n      return (\n        <Box mt={4}>\n          <b>Delta Copied Tables</b>\n      \n          <Box mt={4}>\n            {job.outputMetadata.deltaCopies.map((table:string) => {\n              return (\n                <Box display=\"inline\" mr={1}>\n                  <Chip\n                    key={table}\n                    label={table}\n                    variant=\"outlined\"\n                    color=\"primary\"\n                    size=\"small\"\n                  />\n                </Box>\n              )\n            })}\n          </Box>\n        </Box>\n      )\n    }\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <Helmet title=\"Workflow Jobs\" />\n\n        <Typography variant=\"h1\" gutterBottom display=\"inline\">\n          Workflow Jobs\n        </Typography>\n\n        <Divider my={6} />\n\n        <Dialog\n          open={this.state.showException}\n          onClose={this.hideDialog}\n          maxWidth=\"lg\"\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n        >\n          <DialogTitle id=\"dialog-title\">Error Stacktrace</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"dialog-description\">\n              {\n                this.state.stackTrace.split('\\n').map((text:string, index:number) => <React.Fragment key={`${text}-${index}`}>\n                    {text}\n                    <br />\n                  </React.Fragment>)\n              }\n            </DialogContentText>\n\n            <DialogActions>\n              <Button color=\"primary\" onClick={this.hideDialog}>\n                Close\n              </Button>\n            </DialogActions>\n          </DialogContent>\n        </Dialog>\n\n        {this.state.jobs.map((job:WorkflowJob) => {\n          return (\n            <Box mb={4} key={job.uuid}>\n              <Card>\n                <CardContent>\n                  <Grid\n                    justify=\"space-between\"\n                    container\n                    spacing={10}\n                  >\n                    <Grid item xs={1}>\n                      {this.statusIcon(job)}\n                    </Grid>\n\n                    <Grid item xs={11}>\n                      {this.workflowType(job)}\n                      {this.workflowInfo(job)}\n                      Created: <Moment fromNow>{new Date(job.createdAt)}</Moment>\n                      {this.progressBar(job)}\n                      {this.results(job)}\n                      {this.deltaCopies(job)}\n                      {this.initialCopies(job)}\n                      {this.copySummary(job)}\n                    </Grid>\n                  </Grid>\n                </CardContent>\n              </Card>\n            </Box>\n          )\n        })}\n\n        {(this.state.dataFetched && (!this.state.jobs || !this.state.jobs.length)) ? (\n          <Card mt={8}>\n            <CardContent>\n              You have no workflow jobs yet. Jobs will appear here after the time the job has been scheduled for, or when run manually. These not include jobs created in the \"Workflows\" section, but PII Scanner and Forget User jobs as well.\n            </CardContent>\n          </Card>\n        ) : null}\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default JobListing;\n","/Users/joe/www/redactics-osedition/react/src/pages/inputs/Main.tsx",["236","237","238","239","240","241","242","243"],"import React from 'react';\nimport styled, { withTheme } from 'styled-components';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Helmet from 'react-helmet';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  Divider as MuiDivider,\n  Typography,\n  Button as MuiButton,\n  Box,\n  CardContent,\n  Card as MuiCard,\n  Link,\n  Grid,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Table,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableBody,\n  FormControlLabel,\n  Checkbox,\n  Paper,\n  TextField as MuiTextField,\n  InputAdornment,\n  Tooltip,\n  FormControl as MuiFormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  ExpansionPanel,\n  ExpansionPanelSummary,\n  ExpansionPanelDetails as MuiExpansionPanelDetails,\n  Snackbar,\n  IconButton,\n} from '@material-ui/core';\n\nimport {\n  Add as AddIcon,\n  Edit as EditIcon,\n  DeleteOutline as DeleteIcon,\n  HelpOutline as HelpIcon,\n  ExpandMore as ExpandMoreIcon,\n  Close as CloseIcon,\n} from '@material-ui/icons';\n\nimport {\n  Save as SaveIcon,\n} from 'react-feather';\n\nimport {\n  InputRecord,\n} from '../../types/redactics';\n\nimport { Alert as MuiAlert } from '@material-ui/lab';\n\nimport { spacing } from '@material-ui/system';\nimport RedacticsContext from '../../contexts/RedacticsContext';\n\nconst Card = styled(MuiCard)(spacing);\n\nconst Divider = styled(MuiDivider)(spacing);\n\nconst Button = styled(MuiButton)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 200px;\n  max-width: 200px;\n`;\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 200px;\n`;\n\nconst ExpansionPanelDetails = withStyles({\n  root: {\n    display: 'block',\n  },\n})(MuiExpansionPanelDetails);\n\nconst NWTableCell = withStyles({\n  root: {\n    whiteSpace: 'nowrap',\n  },\n})(TableCell);\n\nconst Alert = styled(MuiAlert)(spacing);\n\nconst styles = {\n  selectAdornment: {\n    marginRight: '-30px',\n  },\n};\n\ninterface IProps {\n  classes: any;\n}\n\ninterface IState {\n  inputs: InputRecord[];\n  errors: any;\n  input: InputRecord;\n  editInputDialog: boolean;\n  missingInput: boolean;\n  newInputKey: number;\n  saveButtonDisabled: boolean;\n  showSnackbar: boolean;\n}\n\nclass Inputs extends React.Component<IProps, IState> {\n  static contextType = RedacticsContext;\n\n  constructor(props:IProps) {\n    super(props);\n\n    this.refreshInputs = this.refreshInputs.bind(this);\n    this.handleInputChanges = this.handleInputChanges.bind(this);\n    this.inputDialog = this.inputDialog.bind(this);\n    this.hideInputDialog = this.hideInputDialog.bind(this);\n    this.saveInputChanges = this.saveInputChanges.bind(this);\n    this.deleteInput = this.deleteInput.bind(this);\n    this.saveChanges = this.saveChanges.bind(this);\n    this.handleSnackbarClose = this.handleSnackbarClose.bind(this);\n\n    this.state = {\n      inputs: [],\n      errors: {},\n      input: {\n        uuid: \"\",\n        inputDisplayMode: \"\",\n        inputType: \"\",\n        inputName: \"\",\n        exportData: true,\n        diskSize: 0,\n        enableSSL: false,\n        sslMode: \"prefer\",\n      },\n      editInputDialog: false,\n      missingInput: false,\n      newInputKey: 0,\n      saveButtonDisabled: true,\n      showSnackbar: false,\n    };\n  }\n\n  async componentDidMount() {\n    this.refreshInputs();\n  }\n\n  async refreshInputs() {\n    try {\n      const response = await fetch(`${this.context.apiUrl}/input`, {\n        credentials: 'include',\n      });\n\n      const data = await response.json();\n\n      this.setState({\n        inputs: data.inputs,\n      })\n    } catch (err) {\n      console.log('CATCH ERR', err);\n    }\n  }\n\n  handleInputChanges(event:any) {\n    const state:any = this.state;\n    state.input[event.target.name] = (event.target.name === \"enableSSL\" || event.target.name === \"exportData\") ? event.target.checked : event.target.value;\n    this.setState(state);\n  }\n\n  inputDialog(input?:InputRecord) {\n    if (input) {\n      this.setState({\n        input: {\n          uuid: input.uuid,\n          inputDisplayMode: \"Edit\",\n          inputType: input.inputType,\n          inputName: input.inputName,\n          exportData: input.exportData,\n          diskSize: input.diskSize,\n          enableSSL: input.enableSSL,\n          sslMode: input.sslMode,\n        },\n        editInputDialog: true,\n      })\n    }\n    else {\n      this.setState({\n        input: {\n          uuid: \"new\",\n          inputDisplayMode: \"Add\",\n          inputType: \"\",\n          inputName: \"\",\n          exportData: true,\n          diskSize: 20,\n          enableSSL: false,\n          sslMode: \"prefer\",\n        },\n        editInputDialog:true,\n      })\n    }\n  }\n\n  hideInputDialog() {\n    this.setState({\n      editInputDialog:false\n    })\n  }\n\n  handleSnackbarClose() {\n    this.setState({\n      showSnackbar: false,\n    });\n  };\n\n  editInputDialogContent() { \n    return (\n      <Box>\n        <Box mt={4}>\n          {this.state.errors.JSX}\n\n          <Box mt={4}>\n            <FormControl fullWidth>\n              <TextField\n                error={this.state.errors.inputName}\n                name=\"inputName\"\n                label=\"Input Name\"\n                value={this.state.input.inputName}\n                onChange={(event) => this.handleInputChanges(event)}\n                InputProps={{ endAdornment: <InputAdornment className={this.props.classes.selectAdornment} position=\"end\"><Tooltip title=\"Arbitrary label for this input\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n              />\n            </FormControl>\n\n            <Box mt={4}>\n              <FormControl fullWidth>\n                <InputLabel htmlFor=\"inputType\">Input/Database Type</InputLabel>\n                <Select\n                  error={this.state.errors.inputType}\n                  name=\"inputType\"\n                  value={this.state.input.inputType}\n                  onChange={(event) => this.handleInputChanges(event)}\n                >\n                  <MenuItem key=\"postgresql\" value=\"postgresql\">PostgreSQL</MenuItem>\n                </Select>\n              </FormControl>\n            </Box>\n\n            <Box mt={4}>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={this.state.input.exportData}\n                    onChange={(event) => this.handleInputChanges(event)}\n                    name=\"exportData\"\n                    color=\"primary\"\n                  />\n                }\n                label=\"Export data from this input source\"\n              />&nbsp;<Tooltip title=\"Checking this option means that you intend to export data from this input source, in which case temporary disk space will be required for this export (CSV) data\" placement=\"right-start\"><HelpIcon /></Tooltip>\n            </Box>\n\n            <Box mt={4} display={(this.state.input.exportData) ? 'block' : 'none'}>\n              <FormControl fullWidth variant=\"outlined\">\n                <TextField\n                  error={this.state.errors.diskSize}\n                  name=\"diskSize\"\n                  label=\"Disk Space Allocation\"\n                  onChange={(event) => this.handleInputChanges(event)}\n                  value={this.state.input.diskSize}\n                  type=\"number\"\n                  InputProps={{\n                    endAdornment: <InputAdornment className={this.props.classes.selectAdornment} position=\"end\"><b>GB</b>&nbsp;&nbsp;<Tooltip title=\"Specify an adequate amount of disk space to allocate for this export (CSV) data. A persistent volume claim will be provisioned matching this file size. You can enlarge, but not shrink this disk space in the future.\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment>,\n                    inputProps: {\n                      min:1\n                    }\n                  }}\n                />\n              </FormControl>\n            </Box>\n\n            <Box mt={4}>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={this.state.input.enableSSL}\n                    onChange={(event) => this.handleInputChanges(event)}\n                    name=\"enableSSL\"\n                    color=\"primary\"\n                  />\n                }\n                label=\"Database Connectivity Should Be TLS/SSL Encrypted\"\n              />\n            </Box>\n\n            <Box mt={4} display={(this.state.input.enableSSL) ? 'block' : 'none'}>\n              Be sure to follow the \"TLS/SSL Certificate Setup Instructions\" included in the Agents page to facilitate connectivity using your certificates.\n              <Box mt={4}>\n                <FormControl fullWidth>\n                  <InputLabel htmlFor=\"sslMode\">TLS/SSL Mode</InputLabel>\n                  <Select\n                    name=\"sslMode\"\n                    value={this.state.input.sslMode}\n                    onChange={(event) => this.handleInputChanges(event)}\n                  >\n                    <MenuItem key=\"allow\" value=\"allow\">Allow</MenuItem>\n                    <MenuItem key=\"prefer\" value=\"prefer\">Prefer</MenuItem>\n                    <MenuItem key=\"require\" value=\"require\">Require</MenuItem>\n                    <MenuItem key=\"verify-ca\" value=\"verify-ca\">Verify CA</MenuItem>\n                    <MenuItem key=\"verify-full\" value=\"verify-full\">Verify Full</MenuItem>\n                  </Select>\n                </FormControl>\n              </Box>\n            </Box>\n\n            {/* <Box mt={4} display={(!this.state.input.uuid.match(/^new/) && this.state.input.enableSSL) ? 'block' : 'none'}>\n              <Paper variant=\"outlined\">\n                <ExpansionPanel>\n                  <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                    <Typography>TLS/SSL Encryption Setup Instructions</Typography>\n                  </ExpansionPanelSummary>\n                  <ExpansionPanelDetails>\n                    Enabling TLS/SSL encryption requires having an engineer perform the following four steps. These steps (even upon completion) will remain available here for reference:\n\n                    <ol>\n                      <li>Figure out what <code>sslmode</code> option is required by your database host/provider. Possibilities include <code>allow, prefer, require, verify-ca, verify-full</code> (<Link href=\"https://www.postgresql.org/docs/12/libpq-ssl.html\" target=\"_blank\">more info</Link>). Also figure out whether your database requires presenting only the root CA certificate, or the root CA as well as client cert and key files. Download these required files - we&apos;ll need them for step 3.</li>\n                      <li>Update your Helm configuration file (i.e. <code>{this.getAgent().configPath}</code>) and add the following in the block (respecting proper indentation level) that includes <code>id: {this.props.input.uuid}</code>. Take out the <code>sslcert</code> and <code>sslkey</code> params if your server doesn&apos;t require these, and you can adjust the <code>sslmode</code> value as necessary:<br/><br/>\n                        <code>\n                          enableSSL: true<br/>\n                          extra: &apos;&#123;&quot;sslmode&quot;:&quot;verify-ca&quot;, &quot;sslrootcert&quot;:&quot;/pgcerts/{this.props.input.uuid}/sslrootcert&quot;, &quot;sslcert&quot;: &quot;/pgcerts/{this.props.input.uuid}/sslcert&quot;, &quot;sslkey&quot;: &quot;/pgcerts/{this.props.input.uuid}/sslkey&quot;&#125;&apos;\n                        </code><br/><br/>\n                        If, for whatever reason, you&apos;d like to disable this TLS/SSL connectivity you can simply comment out these two lines by entering a hash (i.e. <code>#</code>) character before each line.\n                      </li>\n                      <li>Create a Kubernetes secret containing the certificates required by your database. Adjust the file paths, and take out the <code>sslcert</code> and <code>sslkey</code> params if your server doesn&apos;t require these:<br/><br/>\n                        <code>\n                          kubectl create secret -n {this.getAgent().namespace} generic pgcert-{this.props.input.uuid} --from-file=sslrootcert=/path/to/server-ca.pem --from-file=sslcert=/path/to/client-cert.pem  --from-file=sslkey=/path/to/client-key.pem\n                        </code>\n                      </li>\n                      <li>Visit the Agent page and reapply the provided configuration to your cluster, which will update all agent database connections to use the updated configuration you&apos;ve provided in your Helm configuration file.</li>\n                    </ol>\n                  </ExpansionPanelDetails>\n                </ExpansionPanel>\n              </Paper>\n            </Box> */}\n          </Box>\n        </Box>\n      </Box>\n    ) \n  }\n\n  saveInputChanges() {\n    const state:IState = this.state;\n    let errorsFound:boolean = false;\n    let inputs:InputRecord[] = this.state.inputs;\n\n    if (!state.input.inputName) {\n      state.errors.inputName = true;\n      errorsFound = true;\n    }\n    else {\n      state.errors.inputName = false;\n    }\n\n    if (!state.input.inputType) {\n      state.errors.inputType = true;\n      errorsFound = true;\n    }\n    else {\n      state.errors.inputType = false;\n    }\n\n    if (errorsFound) {\n      this.setState({\n        errors: state.errors\n      })\n      return;\n    }\n\n    if (this.state.input.uuid === \"new\") {\n      state.newInputKey++;\n      state.input.uuid = \"new\" + state.newInputKey;\n\n      inputs.push(state.input);\n    }\n\n    // find and update existing input in inputs listing\n    let duplicateInputName:boolean = false;\n    inputs = inputs.map((input) => {\n      if (input.inputName === state.input.inputName && input.uuid !== state.input.uuid) {\n        duplicateInputName = true;\n      }\n      else if (input.uuid === state.input.uuid) {\n        input.inputName = state.input.inputName;\n        input.inputType = state.input.inputType;\n        input.diskSize = state.input.diskSize;\n        input.enableSSL = state.input.enableSSL;\n        input.sslMode = state.input.sslMode;\n      }\n\n      return input;\n    });\n\n    if (duplicateInputName) {\n      state.errors.JSX = (\n        <Alert mb={4} severity=\"error\">Input names must be unique.</Alert>\n      );\n\n      this.setState({\n        errors: state.errors\n      })\n      return;\n    }\n\n    state.errors.JSX = null;\n    //console.log(\"INPUTS\", inputs);\n    //console.log(\"STATE\", state)\n\n    if (this.state.input.uuid.match(/^new/)) {\n      this.setState({\n        missingInput: false,\n        errors: state.errors,\n        editInputDialog: false,\n        newInputKey: state.newInputKey,\n        inputs: inputs,\n        saveButtonDisabled: false,\n      })\n    }\n    else {\n      this.setState({\n        missingInput: false,\n        errors: state.errors,\n        editInputDialog: false,\n        inputs: inputs,\n        saveButtonDisabled: false,\n      })\n    }\n  }\n\n  deleteInput(input:InputRecord) {\n    const state:IState = this.state;\n\n    const inputs = state.inputs.filter((i:InputRecord) => {\n      return (i.uuid !== input.uuid)\n    })\n\n    this.setState({\n      inputs: inputs,\n      saveButtonDisabled: false,\n    });\n  }\n\n  async saveChanges() {\n    try {\n      this.setState({\n        saveButtonDisabled: true,\n        errors: {},\n      });\n\n      const payload = {\n        inputs: this.state.inputs,\n      }\n\n      await fetch(`${this.context.apiUrl}/input`, {\n        method: 'put',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify(payload),\n      });\n\n      this.setState({\n        saveButtonDisabled: false,\n        showSnackbar: true,\n      });\n\n      this.refreshInputs();\n\n    } catch (err) {\n      console.log('CATCH ERR', err);\n\n      this.setState({\n        saveButtonDisabled: false\n      });\n    }\n  }\n\n  /* eslint-disable max-len */\n\n  render() {\n    return (\n      <React.Fragment>\n        <Helmet title=\"Input Sources\" />\n\n        <Typography variant=\"h1\" gutterBottom display=\"inline\">\n          Input Sources\n        </Typography>\n\n        <Divider my={6} />\n\n        <Box mt={4}>\n          <Typography variant=\"body1\" gutterBottom>\n            Define your input sources (i.e. databases, API inputs, etc.) here.\n          </Typography>\n\n          <Box mt={8}>\n            <Grid\n              justify=\"space-between\"\n              container\n              spacing={10}\n            >\n              <Grid item></Grid>\n              <Grid item>\n                <div>\n                  <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={() => this.inputDialog()}>\n                    <AddIcon />&nbsp;\n                    Add Input Source\n                  </Button>\n                </div>\n              </Grid>\n            </Grid>\n          </Box>\n\n          <Card mt={8}>\n            <CardContent>\n              <Table>\n                <TableHead>\n                  <TableRow>\n                    <TableCell>ID</TableCell>\n                    <TableCell>Name</TableCell>\n                    <TableCell>Input Type</TableCell>\n                    <TableCell>Disk Space Allocation</TableCell>\n                    <TableCell>TLS/SSL Encrypted</TableCell>\n                    <TableCell></TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {this.state.inputs.map((input:InputRecord) => {\n                    return (\n                      <TableRow key={input.uuid}>\n                        <TableCell>{(input.uuid.match(/^new/)) ? \"\" : input.uuid}</TableCell>\n                        <TableCell>{input.inputName}</TableCell>\n                        <TableCell>{input.inputType}</TableCell>\n                        <TableCell>{(input.diskSize) ? input.diskSize + \" GB\" : \"None\"}</TableCell>\n                        <TableCell>{(input.enableSSL) ? \"yes\" : \"no\"}</TableCell>\n                        <NWTableCell>\n                          <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={() => this.inputDialog(input)}>\n                            <EditIcon/>&nbsp;Edit\n                          </Button>&nbsp;\n                          <Button variant=\"contained\" color=\"default\" size=\"small\" onClick={() => this.deleteInput(input)}>\n                            <DeleteIcon />&nbsp;Delete\n                          </Button>\n                        </NWTableCell>\n                      </TableRow>\n                    )\n                  })}\n                </TableBody>\n              </Table>\n\n              <Box mt={8}>\n                <Grid\n                  container\n                  justify=\"space-between\"\n                >\n                  <Grid item xs={10}>\n                    <Button variant=\"contained\" color=\"primary\" size=\"large\" disabled={this.state.saveButtonDisabled} onClick={() => this.saveChanges()}>\n                      <SaveIcon />&nbsp;\n                      Save Changes\n                    </Button>\n                  </Grid>\n                </Grid>\n              </Box>\n            </CardContent>\n          </Card>\n        </Box>\n\n        <Dialog\n          open={this.state.editInputDialog}\n          onClose={this.hideInputDialog}\n          maxWidth=\"md\"\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n          fullWidth\n        >\n          <DialogTitle id=\"dialog-title\">{this.state.input.inputDisplayMode} Input Source</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"dialog-description\">\n              {this.editInputDialogContent()}\n            </DialogContentText>\n\n            <DialogActions>\n              <Button color=\"secondary\" variant=\"contained\" onClick={this.saveInputChanges}>\n                {this.state.input.inputDisplayMode} Input\n              </Button>\n            </DialogActions>\n          </DialogContent>\n        </Dialog>\n\n        <Snackbar\n          anchorOrigin={{\n            vertical: 'top',\n            horizontal: 'right',\n          }}\n          open={this.state.showSnackbar}\n          autoHideDuration={8000}\n          onClose={this.handleSnackbarClose}\n          ContentProps={{\n            'aria-describedby': 'message-id',\n          }}\n          message={<span id=\"message-id\"><b>Your changes have been saved!</b></span>}\n          action={[\n            <IconButton\n              key=\"close\"\n              aria-label=\"Close\"\n              color=\"inherit\"\n              onClick={this.handleSnackbarClose}\n            >\n              <CloseIcon />\n            </IconButton>,\n          ]}\n        />\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default withStyles(styles)(Inputs);\n","/Users/joe/www/redactics-osedition/react/src/pages/agents/Main.tsx",["244","245"],"import React from 'react';\nimport styled from 'styled-components';\n\nimport Helmet from 'react-helmet';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\n\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  Divider as MuiDivider,\n  FormControl as MuiFormControl,\n  Grid as MuiGrid,\n  Typography,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  TextField as MuiTextField,\n  Button as MuiButton,\n  Tooltip,\n  InputAdornment,\n  Box,\n  Snackbar,\n  IconButton,\n  FormControlLabel,\n  Checkbox,\n} from '@material-ui/core';\n\nimport {\n  Add as AddIcon,\n  HelpOutline as HelpIcon,\n  Close as CloseIcon,\n  LockOpen as LockOpenIcon,\n} from '@material-ui/icons';\n\nimport {\n  Save as SaveIcon,\n  Clipboard as ClipboardIcon,\n} from 'react-feather';\n\nimport { spacing } from '@material-ui/system';\n\nimport { Alert as MuiAlert } from '@material-ui/lab';\n\nimport { AgentRecord, InputRecord } from '../../types/redactics';\nimport RedacticsContext from '../../contexts/RedacticsContext';\n\nimport Agent from './Agent';\n\nconst Divider = styled(MuiDivider)(spacing);\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 400px;\n`;\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 400px;\n  max-width: 800px;\n`;\n\nconst Button = styled(MuiButton)(spacing);\n\nconst Alert = styled(MuiAlert)(spacing);\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n\n}\n\ninterface IState {\n  namespace: string;\n  configPath: string;\n  saveButtonDisabled: boolean;\n  agents: AgentRecord[];\n  inputs: InputRecord[];\n  helmConfig: string;\n  configMaxWidth: any;\n  newAgentId: string;\n  illegalChars: boolean;\n  sampleDBSelected: boolean;\n  sampleAgentConfirmationDialog: boolean;\n  useNodeSelector: boolean;\n  nodeSelectorLabelKey: string;\n  nodeSelectorLabelValue: string;\n  disableCancel: boolean;\n  errors: any;\n  showClipboardSnackbar: boolean;\n  showSaveSnackbar: boolean;\n  agentName: string;\n  nodeSelector: string;\n  applyAgentInstallOption: string;\n  helmArgs: any;\n  showAuthCmdsDialog: boolean;\n  showInstallAgentDialog: boolean;\n}\n\nclass Agents extends React.Component<IProps, IState> {\n  static contextType = RedacticsContext;\n\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      namespace: 'redactics',\n      configPath: '~/.redactics/values.yaml',\n      saveButtonDisabled: true,\n      agents: [],\n      inputs: [],\n      helmConfig: '',\n      configMaxWidth: 'md',\n      newAgentId: '',\n      illegalChars: false,\n      sampleDBSelected: false,\n      sampleAgentConfirmationDialog: false,\n      useNodeSelector: false,\n      nodeSelectorLabelKey: 'nodePool',\n      nodeSelectorLabelValue: 'agent',\n      showClipboardSnackbar: false,\n      showSaveSnackbar: false,\n      disableCancel: false,\n      agentName: '',\n      nodeSelector: '',\n      applyAgentInstallOption: '',\n      helmArgs: {},\n      errors: {\n        agentName: false,\n        namespace: false,\n        configPath: false,\n        illegalChars: ''\n      },\n      showAuthCmdsDialog: false,\n      showInstallAgentDialog: false,\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleAuthCmds = this.handleAuthCmds.bind(this);\n    this.handleInstallAgent = this.handleInstallAgent.bind(this);\n    this.handleClose = this.handleClose.bind(this);\n    this.handleErrors = this.handleErrors.bind(this);\n    this.deleteAgent = this.deleteAgent.bind(this);\n    this.clipboardCopy = this.clipboardCopy.bind(this);\n    this.updateAgentSnackbar = this.updateAgentSnackbar.bind(this);\n    this.handleSnackbarClose = this.handleSnackbarClose.bind(this);\n    this.toggleNodeSelector = this.toggleNodeSelector.bind(this);\n    this.saveNewAgent = this.saveNewAgent.bind(this);\n  }\n\n  componentDidMount() {\n    this.fetchAgents();\n    this.fetchInputs();\n    this.getAgentHeartbeatData();\n  }\n\n  async fetchAgents() {\n    try {\n      const response = await fetch(`${this.context.apiUrl}/agent`, {\n        credentials: 'include',\n      });\n      const data = await response.json();\n\n      // TODO: data structure should be data.agents\n      //console.log(data);\n      this.setState({\n        agents: data,\n        showInstallAgentDialog: (!data.length)\n      });\n    } catch (err) {\n      // console.log(err);\n    }\n  }\n\n  async fetchInputs() {\n    try {\n      const response = await fetch(`${this.context.apiUrl}/input`, {\n        credentials: 'include',\n      });\n      const data = await response.json();\n\n      this.setState({\n        inputs: data.inputs,\n      })\n    } catch (err) {\n      // console.log(err);\n    }\n  }\n\n  clipboardCopy() {\n    this.setState({\n      showClipboardSnackbar: true,\n    });\n  }\n\n  updateAgentSnackbar() {\n    this.setState({\n      showSaveSnackbar: true,\n    });\n  }\n\n  handleSnackbarClose() {\n    this.setState({\n      showClipboardSnackbar: false,\n      showSaveSnackbar: false,\n    });\n  }\n\n  async deleteAgent(agentId:string) {\n    try {\n      await fetch(`${this.context.apiUrl}/agent/${agentId}`, {\n        credentials: 'include',\n        method: 'delete',\n      });\n      this.fetchAgents();\n    } catch (err) {\n      // console.log('CATCH ERR', error);\n    }\n  }\n\n  handleChange(event:any) {\n    const state:any = {};\n    state[event.target.name] = event.target.value;\n\n    this.setState(state);\n  }\n\n  static isIllegalName(name:string) {\n    if (!name.match(/^[a-zA-Z0-9]([-a-zA-Z0-9]*[a-zA-Z0-9])?$/)) {\n      return true;\n    }\n    return false;\n  }\n\n  static isIllegalPath(path:string) {\n    if (!path.match(/(\\/|\\\\)/)) {\n      return true;\n    }\n    return false;\n  }\n\n  handleErrors(childState:any=null) {\n    let errorsFound = false;\n    const state:any = (childState) ? childState : this.state as any;\n\n    const illegalCharJSX = (\n      <Alert mb={4} severity=\"error\">Kubernetes names must be no longer than 63 characters, must start and end with a lowercase letter or number, and may contain lowercase letters, numbers, and hyphens.</Alert>\n    );\n\n    const illegalPathJSX = (\n      <Alert mb={4} severity=\"error\">Invalid path</Alert>\n    );\n\n    const illegalNameJSX = (\n      <Alert mb={4} severity=\"error\">An Agent Name is required</Alert>\n    );\n\n    const fields = ['namespace'];\n    if (state.useNodeSelector) {\n      fields.push('nodeSelectorLabelKey');\n      fields.push('nodeSelectorLabelValue');\n    }\n    state.errors.JSX = '';\n    state.errors.agentName = false;\n    state.errors.configPath = false;\n\n    fields.forEach((f) => {\n      state.errors[f] = false;\n\n      if (Agents.isIllegalName(state[f])) {\n        state.errors[f] = true;\n        if (state[f]) {\n          state.errors.JSX = illegalCharJSX;\n        }\n        errorsFound = true;\n      }\n    });\n\n    if (Agents.isIllegalPath(state.configPath)) {\n      state.errors.configPath = true;\n      state.errors.JSX = illegalPathJSX;\n      errorsFound = true;\n    } else {\n      state.errors.configPath = false;\n    }\n\n    if (!state.agentName) {\n      errorsFound = true;\n      state.errors.agentName = true;\n      state.errors.JSX = illegalNameJSX;\n    }\n\n    this.setState(state);\n    return errorsFound;\n  }\n\n  handleAuthCmds() {\n    this.setState({\n      showAuthCmdsDialog: true\n    })\n  }\n\n  handleInstallAgent() {\n    this.setState({\n      showInstallAgentDialog: true,\n      agentName: '',\n      namespace: 'redactics',\n      nodeSelector: '',\n      useNodeSelector: false,\n      configPath: '~/.redactics/values.yaml',\n    })\n  }\n\n  handleClose() {\n    this.setState({\n      showAuthCmdsDialog: false,\n      showInstallAgentDialog: false,\n    });\n  }\n\n  toggleNodeSelector(event:any) {\n    this.setState({\n      useNodeSelector: event.target.checked,\n    });\n  }\n\n  clipboardSnackbar() {\n    return (\n      <Snackbar\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n        open={this.state.showClipboardSnackbar}\n        autoHideDuration={8000}\n        onClose={this.handleSnackbarClose}\n        ContentProps={{\n          'aria-describedby': 'message-id',\n        }}\n        message={<span id=\"message-id\">This command has been copied to your clipboard</span>}\n        action={[\n          <IconButton\n            key=\"close\"\n            aria-label=\"Close\"\n            color=\"inherit\"\n            onClick={this.handleSnackbarClose}\n          >\n            <CloseIcon />\n          </IconButton>,\n        ]}\n      />\n    );\n  }\n\n  saveSnackbar() {\n    return (\n      <Snackbar\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n        open={this.state.showSaveSnackbar}\n        autoHideDuration={8000}\n        onClose={this.handleSnackbarClose}\n        ContentProps={{\n          'aria-describedby': 'message-id',\n        }}\n        message={<span id=\"message-id\">Your changes have been saved</span>}\n        action={[\n          <IconButton\n            key=\"close\"\n            aria-label=\"Close\"\n            color=\"inherit\"\n            onClick={this.handleSnackbarClose}\n          >\n            <CloseIcon />\n          </IconButton>,\n        ]}\n      />\n    );\n  }\n\n\n  async saveNewAgent() {\n    const state:any = {};\n    const nodeSelector = (this.state.useNodeSelector) ? `${this.state.nodeSelectorLabelKey}.${this.state.nodeSelectorLabelValue}` : '';\n    const errorsFound = this.handleErrors();\n    if (errorsFound) { return; }\n\n    try {\n      const response = await fetch(`${this.context.apiUrl}/agent`, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          name: this.state.agentName,\n          namespace: this.state.namespace,\n          nodeSelector,\n          configPath: this.state.configPath,\n        }),\n      });\n\n      const data = await response.json();\n\n      const { agents } = this.state;\n      agents.push(data);\n\n      state.showInstallAgentDialog = false;\n      state.showAuthCmdsDialog = (agents.length === 1) ? true : false;\n\n      this.setState(state);\n    } catch (err) {\n      // console.log(err);\n    }\n  }\n\n  installAgent() {\n    return (\n      <React.Fragment>\n        <Box>\n          <p>Redactics requires installation of the Redactics Agent helm chart onto a Kubernetes cluster which has network access to your application database(s). The agent is used for carrying out the work in the workflows you&apos;ve defined here. Each Kubernetes cluster needs a single agent installed (a single agent can control multiple databases).</p>\n\n          {this.state.illegalChars}\n        </Box>\n\n        {this.state.errors.JSX}\n\n        <Box mt={2}>\n          <FormControl fullWidth variant=\"outlined\">\n            <TextField\n              error={this.state.errors.agentName}\n              name=\"agentName\"\n              label=\"Agent Name\"\n              value={this.state.agentName}\n              onChange={this.handleChange}\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Unique name used to identify this agent (e.g. cluster or environment name)\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment>,\n              }}\n            />\n          </FormControl>\n        </Box>\n\n        <Box mt={4}>\n          <FormControl fullWidth variant=\"outlined\">\n            <TextField\n              error={this.state.errors.namespace}\n              name=\"namespace\"\n              label=\"Kubernetes Namespace\"\n              value={this.state.namespace}\n              onChange={this.handleChange}\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Kubernetes namespace used for the Redactics Agent\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment>,\n              }}\n            />\n          </FormControl>\n        </Box>\n\n        <Box mt={4}>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={this.state.useNodeSelector}\n                onChange={this.toggleNodeSelector}\n                name=\"useNodeSelector\"\n                color=\"primary\"\n              />\n            }\n            label=\"Assign Agent Pods to Specific Nodes (optional)\"\n          /> <Tooltip title=\"Optional Kubernetes nodeSelector label for Redactics Agent (allows prevent unwanted resource competition during export jobs), requires label key and value\" placement=\"right-start\"><HelpIcon /></Tooltip>\n        </Box>\n\n        <Box mt={4} display={(this.state.useNodeSelector) ? 'block' : 'none'}>\n          <Box>\n            <FormControl fullWidth variant=\"outlined\">\n              <TextField\n                name=\"nodeSelectorLabelKey\"\n                label=\"Kubernetes Node Selector Label Key\"\n                value={this.state.nodeSelectorLabelKey}\n                onChange={this.handleChange}\n              />\n            </FormControl>\n          </Box>\n\n          <Box mt={4}>\n            <FormControl fullWidth variant=\"outlined\">\n              <TextField\n                name=\"nodeSelectorLabelValue\"\n                label=\"Kubernetes Node Selector Label Value\"\n                value={this.state.nodeSelectorLabelValue}\n                onChange={this.handleChange}\n              />\n            </FormControl>\n          </Box>\n        </Box>\n\n        <Box mt={4}>\n          <FormControl fullWidth variant=\"outlined\">\n            <TextField\n              error={this.state.errors.configPath}\n              name=\"configPath\"\n              label=\"Local Helm Config Path\"\n              value={this.state.configPath}\n              onChange={this.handleChange}\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Path to where you would like to save your Helm configuration file\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment>,\n              }}\n            />\n          </FormControl>\n        </Box>\n\n        <Box mt={8}>\n          <Typography variant=\"h4\">\n            Input Sources\n          </Typography>\n\n          <Box mt={2}>\n            <Typography>\n              Use the following Input Sources with this Agent:\n            </Typography>\n\n            {this.state.inputs.map((input:InputRecord) => (\n              <FormControlLabel\n                key={input.uuid}\n                control={\n                  <Checkbox\n                    name={(\"inputsource_\" + input.uuid)}\n                    color=\"primary\"\n                    onChange={this.handleChange}\n                  />\n                }\n                label={input.inputName}\n              />\n            ))}\n          </Box>\n        </Box>\n\n        <DialogActions>\n          <Button color=\"secondary\" variant=\"contained\" onClick={this.saveNewAgent}>\n            Save&nbsp;<SaveIcon />\n          </Button>\n        </DialogActions>\n      </React.Fragment>\n    )\n  }\n\n  /* eslint-disable max-len */\n\n  showAuthenticationCmds() {\n    const cmd = `helm repo add redactics ${this.context.chartMuseumUrl}`;\n    const dockerLogin = `docker login ${this.context.dockerRegistryUrl} -u ${this.context.email}`;\n\n    return (\n      <Box>\n        <Grid\n          justify=\"space-between\"\n          container\n          spacing={10}\n        >\n\n          <Grid item xs={1}>\n            <Typography variant=\"h1\">\n              1\n            </Typography>\n          </Grid>\n\n          <Grid item xs={11}>\n            <p>\n              Add the Redactics Chartmuseum repo to your local Helm config. This allows Helm to pull the Redactics Helm chart from this repo.\n            </p>\n\n            <Box mt={4}>\n              <CopyToClipboard text={cmd} onCopy={this.clipboardCopy}>\n                <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n              </CopyToClipboard>\n\n              <pre>\n                {cmd}\n              </pre>\n            </Box>\n            \n          </Grid>\n        </Grid>\n\n        <Grid\n          justify=\"space-between\"\n          container\n          spacing={10}\n        >\n          <Grid item xs={1}>\n            <Typography variant=\"h1\">\n              2\n            </Typography>\n          </Grid>\n\n          <Grid item xs={11}>\n            <p>\n              Authenticate to the Redactics registry. This will allow your Kubernetes cluster to pull the required Redactics container images from this registry.\n            </p>\n\n            <Box mt={4}>\n              <CopyToClipboard text={dockerLogin} onCopy={this.clipboardCopy}>\n                <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n              </CopyToClipboard>\n\n              <pre>\n                {dockerLogin}\n              </pre>\n            </Box>\n\n            <Box>\n              <p>When prompted for your password your password is your Redactics API key:</p>\n\n              <CopyToClipboard text={this.context.apiKey} onCopy={this.clipboardCopy}>\n                <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n              </CopyToClipboard>\n\n              <pre>\n                {this.context.apiKey}\n              </pre>\n            </Box>\n          </Grid>\n        </Grid>\n\n        <DialogActions>\n          <Button color=\"secondary\" variant=\"contained\" onClick={this.handleClose}>\n            Okay\n          </Button>\n        </DialogActions>\n      </Box>\n    )\n  }\n\n  /* eslint-disable no-restricted-syntax */\n\n  getAgentHeartbeatData() {\n    // const notifications = ref(fbDatabase, `notifications/${this.context.companyId}`);\n    // onValue(notifications, (snapshot) => {\n    //   const data = snapshot.val();\n    //   if (!data) { return; }\n\n    //   for (const [key, v] of Object.entries(data)) {\n    //     // cast Firebase data to AgentFirebaseRecord type\n    //     const val:AgentFirebaseRecord = v as AgentFirebaseRecord;\n    //     if (key && (val.firstHeartbeat || val.heartbeat)) {\n    //       const agents = this.state.agents.map((c:AgentRecord) => {\n    //         const agent = c;\n    //         if (agent.uuid === val.agentId) {\n    //           if (val.firstHeartbeat && val.timestamp) {\n    //             agent.agentInstallationDate = new Date(val.timestamp).toISOString();\n    //             //agent.agentInstallationDate = \"\";\n    //           } else if (val.heartbeat && val.timestamp) {\n    //             agent.lastHeartBeatDate = new Date(val.timestamp).toISOString();\n    //           }\n    //         }\n\n    //         return agent;\n    //       });\n\n    //       this.setState({\n    //         agents,\n    //       });\n    //     }\n    //   }\n    // });\n  }\n\n  render() {\n    /* eslint-disable no-restricted-syntax */\n\n    return (\n      <React.Fragment>\n        <Dialog\n          open={this.state.showAuthCmdsDialog}\n          onClose={this.handleClose}\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n          maxWidth={this.state.configMaxWidth}\n        >\n          <DialogTitle id=\"dialog-title\">Authentication Instructions</DialogTitle>\n          <DialogContent>\n            {this.showAuthenticationCmds()}\n          </DialogContent>\n        </Dialog>\n\n        <Dialog\n          open={this.state.showInstallAgentDialog}\n          onClose={this.handleClose}\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n          maxWidth={this.state.configMaxWidth}\n        >\n          <DialogTitle id=\"dialog-title\">Configure Your Redactics Agent</DialogTitle>\n          <DialogContent>\n            {this.installAgent()}\n          </DialogContent>\n        </Dialog>\n\n        {this.clipboardSnackbar()}\n        {this.saveSnackbar()}\n\n        <Helmet title=\"Agents\" />\n\n        <Typography variant=\"h1\" gutterBottom display=\"inline\">\n          Agents\n        </Typography>\n\n        <Divider my={6} />\n\n        <Box mt={4}>\n          <Typography variant=\"body1\" gutterBottom>\n            Install the Redactics Agent adjacent to your input sources using the provided configuration and install command.\n          </Typography>\n        </Box>\n\n        <Box mt={8}>\n          <Grid\n            justify=\"space-between\"\n            container\n            spacing={10}\n          >\n            <Grid item xs={1} mb={6}>\n\n            </Grid>\n\n            <Grid item>\n              <Box mb={4}>\n              <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.handleAuthCmds}>\n                  <LockOpenIcon />\n                  Authentication Instructions\n                </Button>&nbsp;\n                <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.handleInstallAgent}>\n                  <AddIcon />\n                  Install New Agent\n                </Button>\n              </Box>\n            </Grid>\n          </Grid>\n        </Box>\n\n        {this.state.agents.map((agent:AgentRecord) => <Agent\n          clipboardCopy={this.clipboardCopy}\n          updateAgentSnackbar={this.updateAgentSnackbar}\n          handleSnackbarClose={this.handleSnackbarClose}\n          deleteAgent={this.deleteAgent}\n          agent={agent}\n          inputs={this.state.inputs}\n          key={agent.uuid}\n          useNodeSelector={(agent.nodeSelector) ? true : false}\n          handleErrors={this.handleErrors}\n          errors={this.state.errors}\n        />)}\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Agents;\n","/Users/joe/www/redactics-osedition/react/src/contexts/RedacticsContext.tsx",["246"],"import React from 'react';\n\nimport { ContextObj } from '../types/redactics';\n\nconst contextObj:ContextObj = {\n  apiUrl: '',\n};\nconst RedacticsContext = React.createContext(contextObj);\nexport default RedacticsContext;\n","/Users/joe/www/redactics-osedition/react/src/components/Notifications.tsx",[],"/Users/joe/www/redactics-osedition/react/src/pages/settings/Preset.tsx",["247","248"],"import React from 'react';\nimport styled from 'styled-components';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  FormControl as MuiFormControl,\n  Grid as MuiGrid,\n  TextField as MuiTextField,\n  Button as MuiButton,\n  Box,\n  InputLabel,\n  OutlinedInput,\n  MenuItem,\n  Select as MuiSelect,\n} from '@material-ui/core';\n\nimport {\n  DeleteOutline as DeleteIcon,\n} from '@material-ui/icons';\n\nimport { spacing } from '@material-ui/system';\n\nimport PresetRedactEmail from './PresetRedactEmail';\nimport PresetReplacement from './PresetReplacement';\nimport PresetRandomString from './PresetRandomString';\n\nimport { SettingsRedactRulesets, RedactRulePreset } from '../../types/redactics';\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\nconst Button = styled(MuiButton)(spacing);\n\nconst SelectSpacing = styled(MuiSelect)(spacing);\n\nconst Select = styled(SelectSpacing)`\n  width: 300px;\n`;\n\ninterface IProps {\n  rulesets: SettingsRedactRulesets[];\n  selectedPreset: RedactRulePreset;\n  handlePresetChange: any;\n  deletePreset: any;\n}\n\ninterface IState {\n  ruleLabelWidth: number;\n  rulesets: SettingsRedactRulesets[];\n  preset: RedactRulePreset;\n}\n\nclass Preset extends React.Component<IProps, IState> {\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      ruleLabelWidth: 30,\n      rulesets: this.props.rulesets,\n      preset: this.props.selectedPreset,\n    };\n\n    this.resetPresetName = this.resetPresetName.bind(this);\n  }\n\n  resetPresetName() {\n    const { preset } = this.state;\n    if (preset.presetName === 'New Preset') {\n      preset.presetName = '';\n    }\n\n    this.setState({\n      preset,\n    });\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n\n        <Box mt={6}>\n\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              value={this.state.preset.presetName}\n              name=\"presetName\"\n              label=\"Preset Name\"\n              onChange={\n                (event) => this.props.handlePresetChange(this.props.selectedPreset.key, event)\n              }\n              onFocus={this.resetPresetName}\n            />\n          </FormControl>\n\n          <FormControl variant=\"outlined\" margin=\"dense\">\n            <InputLabel>\n              Rule\n            </InputLabel>\n            <Select\n              value={this.state.preset.rule}\n              onChange={\n                (event) => this.props.handlePresetChange(this.props.selectedPreset.key, event)\n              }\n              name=\"rule\"\n              input={\n                <OutlinedInput\n                  labelWidth={this.state.ruleLabelWidth}\n                  name=\"rule\"\n                />\n              }\n            >\n              {this.state.rulesets.map((rule: SettingsRedactRulesets) => (\n                <MenuItem key={rule.redactKey} value={rule.redactKey}>{rule.redactName}</MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n\n          <Box mt={4}>\n            {\n              this.state.preset.rule === 'redact_email' ? <PresetRedactEmail key={this.state.preset.key} handleChange={this.props.handlePresetChange} selectedPreset={this.state.preset} /> : ''\n            }\n            {\n              this.state.preset.rule === 'replacement' ? <PresetReplacement key={this.state.preset.key} handleChange={this.props.handlePresetChange} selectedPreset={this.state.preset} /> : ''\n            }\n            {\n              this.state.preset.rule === 'random_string' ? <PresetRandomString key={this.state.preset.key} handleChange={this.props.handlePresetChange} selectedPreset={this.state.preset} /> : ''\n            }\n          </Box>\n\n          <Grid\n            container\n            justify=\"space-between\"\n            alignItems=\"center\"\n            mt={12}\n          >\n            <Grid item xs={10}></Grid>\n            <Grid item>\n                <Button variant=\"contained\" color=\"default\" size=\"small\" onClick={(event) => this.props.deletePreset(this.state.preset, event)}>\n                <DeleteIcon />&nbsp;&nbsp;Delete\n              </Button>\n            </Grid>\n          </Grid>\n        </Box>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Preset;\n","/Users/joe/www/redactics-osedition/react/src/pages/agents/Agent.tsx",["249","250","251"],"import React from 'react';\nimport styled from 'styled-components';\n\nimport { green, red } from '@material-ui/core/colors';\nimport Moment from 'react-moment';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport {\n  Card as MuiCard,\n  CardContent,\n  FormControl as MuiFormControl,\n  Grid as MuiGrid,\n  Typography,\n  Button as MuiButton,\n  Box,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  ExpansionPanel,\n  ExpansionPanelSummary,\n  ExpansionPanelDetails as MuiExpansionPanelDetails,\n  Paper,\n  TextField,\n  InputAdornment,\n  Tooltip,\n  FormControlLabel,\n  Checkbox,\n  Table,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableBody,\n} from '@material-ui/core';\n\nimport {\n  Check as CheckIcon,\n  Warning as WarningIcon,\n  DeleteOutline as DeleteIcon,\n  ExpandMore as ExpandMoreIcon,\n  HelpOutline as HelpIcon,\n} from '@material-ui/icons';\n\nimport {\n  Clipboard as ClipboardIcon,\n  Save as SaveIcon,\n} from 'react-feather';\n\nimport { spacing } from '@material-ui/system';\n\nimport { HelmCmdHistory, InputRecord, AgentRecord } from '../../types/redactics';\nimport RedacticsContext from '../../contexts/RedacticsContext';\n\nconst Card = styled(MuiCard)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 300px;\n  max-width: 300px;\n`;\n\nconst ExpansionPanelDetails = withStyles({\n  root: {\n    display: 'block',\n  },\n})(MuiExpansionPanelDetails);\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst Button = styled(MuiButton)(spacing);\n\ninterface IProps {\n  agent: AgentRecord;\n  inputs: InputRecord[];\n  deleteAgent: any;\n  clipboardCopy: any;\n  updateAgentSnackbar: any;\n  handleSnackbarClose: any;\n  useNodeSelector: boolean;\n  handleErrors: any;\n  errors: any;\n}\n\ninterface IState {\n  saveButtonDisabled: boolean;\n  helmCmd: any;\n  helmCmdHistory: HelmCmdHistory[];\n  selectedHelmCmd: string;\n  deleteAgent: boolean;\n  verboseSelected: boolean;\n  helmConfig: string;\n  sslSecrets: string[];\n  errors: any;\n  agent: any;\n  selectedInputs: string[];\n  showTLSInstructions: boolean;\n  agentName: string;\n  namespace: string;\n  configPath: string;\n  useNodeSelector: boolean;\n  nodeSelectorLabelKey: string;\n  nodeSelectorLabelValue: string;\n}\n\nclass Agent extends React.Component<IProps, IState> {\n  static contextType = RedacticsContext;\n\n  constructor(props: IProps) {\n    super(props);\n\n    let showTLSInstructions = false;\n    if (this.props.agent.inputs) {\n      this.props.inputs.forEach((input:InputRecord) => {\n        if (input.enableSSL && this.props.agent.inputs?.includes(input.uuid)) {\n          showTLSInstructions = true;\n        }\n      })\n    }\n\n    this.state = {\n      saveButtonDisabled: true,\n      helmCmd: '',\n      helmCmdHistory: [],\n      selectedHelmCmd: '',\n      deleteAgent: false,\n      verboseSelected: false,\n      helmConfig: '',\n      sslSecrets: [],\n      errors: {\n        agentName: false,\n        namespace: false,\n        configPath: false,\n      },\n      agent: this.props.agent,\n      agentName: this.props.agent.name || \"\",\n      namespace: this.props.agent.namespace || \"\",\n      configPath: this.props.agent.configPath || \"\",\n      useNodeSelector: this.props.useNodeSelector,\n      selectedInputs: this.props.agent.inputs || [],\n      showTLSInstructions: showTLSInstructions,\n      nodeSelectorLabelKey: (this.props.useNodeSelector) ? this.props.agent.nodeSelector.split('.')[0] : \"\",\n      nodeSelectorLabelValue: (this.props.useNodeSelector) ? this.props.agent.nodeSelector.split('.')[1] : \"\",\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    //this.handleHelmCmd = this.handleHelmCmd.bind(this);\n    this.setSaveButtonDisabled = this.setSaveButtonDisabled.bind(this);\n    this.toggleNodeSelector = this.toggleNodeSelector.bind(this);\n    this.deleteAgent = this.deleteAgent.bind(this);\n    this.updateAgent = this.updateAgent.bind(this);\n    this.deleteAgentConfirm = this.deleteAgentConfirm.bind(this);\n    this.closeDeleteAgent = this.closeDeleteAgent.bind(this);\n  }\n\n  async componentDidMount() {\n    try {\n      const response = await fetch(`${this.context.apiUrl}/agent/${this.props.agent.uuid}/helmCmd`, {\n        credentials: 'include',\n      });\n      const data = await response.json();\n\n      const { helmCmd } = data;\n      const { helmCmdHistory } = data;\n\n      const helmConfigResponse = await fetch(`${this.context.apiUrl}/agent/${this.props.agent.uuid}/helmConfig`, {\n        credentials: 'include',\n      });\n\n      const helmData = await helmConfigResponse.json();\n      const { helmConfig, sslSecrets } = helmData;\n\n      this.setSaveButtonDisabled();\n\n      this.setState({\n        helmCmd,\n        helmConfig,\n        sslSecrets,\n        helmCmdHistory,\n        selectedHelmCmd: helmCmdHistory.length ? helmCmdHistory[0].uuid : '',\n      });\n    } catch (err) {\n      // console.log('CATCH ERR', error);\n    }\n  }\n\n  statusIcon() {\n    return this.props.agent.agentInstallationDate\n      ? <CheckIcon style={{ color: green[500], fontSize: 50 }} />\n      : <WarningIcon style={{ color: red[500], fontSize: 50 }} />;\n  }\n\n  setSaveButtonDisabled() {\n    this.setState({\n      saveButtonDisabled: !((this.state.agentName && this.state.namespace && this.state.configPath)),\n    });\n  }\n\n  handleChange(event:any) {\n    const state:any = {\n      selectedInputs: this.state.selectedInputs\n    };\n    if (event.target.name.match(/^inputsource_/)) {\n      const inputUuid = event.target.name.replace(/^inputsource_/, '');\n      if (event.target.checked && !state.selectedInputs.includes(inputUuid)) {\n        state.selectedInputs.push(inputUuid);\n      }\n      else {\n        state.selectedInputs = state.selectedInputs.filter((uuid:string) => {\n          return (uuid !== inputUuid)\n        });\n      }\n    }\n    else {\n      state[event.target.name] = event.target.value;\n    }\n    this.setState(state, () => {\n      this.setSaveButtonDisabled();\n    });\n  }\n\n  // TODO: for embedded Helm config feature\n  // handleHelmCmd(event:any) {\n  //   // find helm command\n  //   const helmCmd = this.state.helmCmdHistory.filter((c:HelmCmdHistory) => {\n  //     if (c.uuid === event.target.value) {\n  //       return c;\n  //     }\n\n  //     return false;\n  //   });\n\n  //   this.setState({\n  //     selectedHelmCmd: event.target.value,\n  //     helmCmd: helmCmd[0].cmd,\n  //     verboseSelected: false,\n  //   });\n  // }\n\n  deleteAgent() {\n    this.setState({\n      deleteAgent: true,\n    });\n  }\n\n  async deleteAgentConfirm() {\n    await this.props.deleteAgent(this.props.agent.uuid);\n\n    this.setState({\n      deleteAgent: false,\n    });\n  }\n\n  closeDeleteAgent() {\n    this.setState({\n      deleteAgent: false,\n    });\n  }\n\n  /* eslint-disable max-len */\n\n  renderDeleteAgent() {\n    const uninstallCmd = `helm uninstall -n ${this.state.namespace} redactics`;\n\n    return (\n      <Box mt={4}>\n        <Grid\n          container\n          justify=\"space-between\"\n          mt={12}\n        >\n          <Grid item xs={10}>\n          </Grid>\n          <Grid item>\n            <Button variant=\"contained\" color=\"default\" size=\"small\" onClick={this.deleteAgent}>\n              <DeleteIcon />&nbsp;\n              Delete Agent\n            </Button>\n          </Grid>\n        </Grid>\n        <Dialog\n          open={this.state.deleteAgent}\n          onClose={this.closeDeleteAgent}\n          aria-labelledby=\"delete-agent-title\"\n          aria-describedby=\"legend-description\"\n        >\n          <DialogTitle id=\"delete-agent-title\">Delete This Agent?</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"delete-agent-description\">\n              Clicking <b>Delete</b> will delete the settings for this agent, but to remove this agent from your cluster locally, please enter the following (assuming this namespace contains only Redactics assets). Any workflows associated with this agent will need to be reassigned to a new agent for the config to be put to use.\n\n              <Box mt={4}>\n                <CopyToClipboard text={uninstallCmd} onCopy={this.props.clipboardCopy}>\n                  <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n                </CopyToClipboard>\n                <pre>\n                  {uninstallCmd}\n                </pre>\n              </Box>\n            </DialogContentText>\n\n            <Box mt={4}>\n              <DialogActions>\n                <Button onClick={this.closeDeleteAgent}>\n                  Cancel\n                </Button>\n                <Button color=\"secondary\" onClick={this.deleteAgentConfirm}>\n                  Delete\n                </Button>\n              </DialogActions>\n            </Box>\n          </DialogContent>\n        </Dialog>\n      </Box>\n    );\n  }\n\n  toggleNodeSelector(event:any) {\n    this.setState({\n      useNodeSelector: event.target.checked,\n    });\n  }\n\n  async updateAgent() {\n    const state:any = {};\n    const agentId = this.state.agent.uuid;\n    const nodeSelector = (this.state.useNodeSelector) ? `${this.state.nodeSelectorLabelKey}.${this.state.nodeSelectorLabelValue}` : '';\n    const errorsFound = this.props.handleErrors({\n      agentName: this.state.agentName,\n      namespace: this.state.namespace,\n      useNodeSelector: this.state.useNodeSelector,\n      nodeSelectorLabelKey: this.state.nodeSelectorLabelKey,\n      nodeSelectorLabelValue: this.state.nodeSelectorLabelValue,\n      configPath: this.state.configPath,\n      errors: this.state.errors,\n    });\n    if (errorsFound) { return; }\n\n    try {\n      await fetch(`${this.context.apiUrl}/agent/${agentId}`, {\n        method: 'put',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          name: this.state.agentName,\n          namespace: this.state.namespace,\n          nodeSelector,\n          configPath: this.state.configPath,\n          inputs: this.state.selectedInputs,\n        }),\n      });\n\n      // refresh helm config\n      const refreshHelmCmd = await fetch(`${this.context.apiUrl}/agent/${agentId}/helmCmd`, {\n        credentials: 'include',\n      });\n      const helmData = await refreshHelmCmd.json();\n      const { helmCmd, helmCmdHistory } = helmData;\n\n      state.helmCmd = helmCmd;\n      state.helmCmdHistory = helmCmdHistory;\n      this.props.updateAgentSnackbar();\n\n      this.setState(state);\n    } catch (err) {\n      // console.log(err);\n    }\n  }\n\n  displayAgentStatus() {\n    if (this.props.agent.agentInstallationDate) {\n      const lastHeartBeatDate = this.props.agent.lastHeartBeatDate ? (\n        <div>\n          Last configuration update date: <b><Moment fromNow>{new Date(this.props.agent.lastHeartBeatDate)}</Moment></b>\n        </div>\n      ) : '';\n  \n      return (\n        <Box>\n          <Typography variant=\"h6\" gutterBottom>\n            Redactics Agent Info\n          </Typography>\n          <Box mt={2}>\n            <div>\n              Version: <b>{this.props.agent.lastAgentVersion}</b>\n            </div>\n            <div>\n              Initial installation date: <b><Moment fromNow>{new Date(this.props.agent.agentInstallationDate)}</Moment></b>\n            </div>\n            {lastHeartBeatDate}\n          </Box>\n        </Box>\n      )\n    }\n    else {\n      return (\n        <Box>\n          <Typography variant=\"h6\" gutterBottom>\n            Awaiting Agent Reporting...\n          </Typography>\n        </Box>\n      )\n    }\n  }\n\n  agentInfo() {\n    return (\n      <React.Fragment>\n        {this.displayAgentStatus()}\n        \n        <Box mt={4}>\n          <Paper variant=\"outlined\">\n            <ExpansionPanel>\n              <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Agent Settings</Typography>\n              </ExpansionPanelSummary>\n              <ExpansionPanelDetails>\n                {this.props.errors.JSX}\n\n                <Box mt={2}>\n                  <FormControl fullWidth variant=\"outlined\">\n                    <TextField\n                      error={this.state.errors.agentName}\n                      name=\"agentName\"\n                      label=\"Agent Name\"\n                      value={this.state.agentName}\n                      onChange={this.handleChange}\n                      InputProps={{\n                        endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Unique name used to identify this agent (e.g. cluster or environment name)\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment>,\n                      }}\n                    />\n                  </FormControl>\n                </Box>\n\n                <Box mt={4}>\n                  <FormControl fullWidth variant=\"outlined\">\n                    <TextField\n                      error={this.state.errors.namespace}\n                      name=\"namespace\"\n                      label=\"Kubernetes Namespace\"\n                      value={this.state.namespace}\n                      onChange={this.handleChange}\n                      InputProps={{\n                        endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Kubernetes namespace used for the Redactics Agent\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment>,\n                      }}\n                    />\n                  </FormControl>\n                </Box>\n\n                <Box mt={4}>\n                  <FormControlLabel\n                    control={\n                      <Checkbox\n                        checked={this.state.useNodeSelector}\n                        onChange={this.toggleNodeSelector}\n                        name=\"useNodeSelector\"\n                        color=\"primary\"\n                      />\n                    }\n                    label=\"Assign Agent Pods to Specific Nodes (optional)\"\n                  /> <Tooltip title=\"Optional Kubernetes nodeSelector label for Redactics Agent (allows prevent unwanted resource competition during export jobs), requires label key and value\" placement=\"right-start\"><HelpIcon /></Tooltip>\n                </Box>\n\n                <Box mt={4} display={(this.state.useNodeSelector) ? 'block' : 'none'}>\n                  <Box>\n                    <FormControl fullWidth variant=\"outlined\">\n                      <TextField\n                        error={this.state.errors.nodeSelectorLabelKey}\n                        name=\"nodeSelectorLabelKey\"\n                        label=\"Kubernetes Node Selector Label Key\"\n                        value={this.state.nodeSelectorLabelKey}\n                        onChange={this.handleChange}\n                      />\n                    </FormControl>\n                  </Box>\n\n                  <Box mt={4}>\n                    <FormControl fullWidth variant=\"outlined\">\n                      <TextField\n                        error={this.state.errors.nodeSelectorLabelValue}\n                        name=\"nodeSelectorLabelValue\"\n                        label=\"Kubernetes Node Selector Label Value\"\n                        value={this.state.nodeSelectorLabelValue}\n                        onChange={this.handleChange}\n                      />\n                    </FormControl>\n                  </Box>\n                </Box>\n\n                <Box mt={4}>\n                  <FormControl fullWidth variant=\"outlined\">\n                    <TextField\n                      error={this.state.errors.configPath}\n                      name=\"configPath\"\n                      label=\"Local Helm Config Path\"\n                      value={this.state.configPath}\n                      onChange={this.handleChange}\n                      InputProps={{\n                        endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Path to where you would like to save your Helm configuration file\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment>,\n                      }}\n                    />\n                  </FormControl>\n                </Box>\n\n                <Box mt={8}>\n                  <Typography variant=\"h4\">\n                    Input Sources\n                  </Typography>\n\n                  <Box mt={2}>\n                    <Typography>\n                      Use the following Input Sources with this Agent:\n                    </Typography>\n\n                    {this.props.inputs.map((input:InputRecord) => (\n                      <FormControlLabel\n                        key={input.uuid}\n                        control={\n                          <Checkbox\n                            name={(\"inputsource_\" + input.uuid)}\n                            color=\"primary\"\n                            onChange={this.handleChange}\n                            checked={this.state.selectedInputs.includes(input.uuid)}\n                          />\n                        }\n                        label={input.inputName}\n                      />\n                    ))}\n                  </Box>\n                </Box>\n\n                <Box mt={8}>\n                  <Button color=\"secondary\" variant=\"contained\"  disabled={this.state.saveButtonDisabled} onClick={this.updateAgent}>\n                    <SaveIcon />&nbsp;Save Changes\n                  </Button>\n                </Box>\n\n              </ExpansionPanelDetails>\n            </ExpansionPanel>\n          </Paper>\n        </Box>\n\n        <Box mt={4} display={(this.state.showTLSInstructions) ? \"block\" : \"none\"}>\n          <Paper variant=\"outlined\">\n            <ExpansionPanel>\n              <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Agent TLS/SSL Input Setup Instructions</Typography>\n              </ExpansionPanelSummary>\n              <ExpansionPanelDetails>\n                Enabling TLS/SSL encryption with your connectivity to your input sources requires performing the following steps. These steps (even upon completion) will remain available here for reference:\n\n                <ol>\n                  <li>Figure out whether your database requires presenting only the root CA certificate, or the root CA as well as client cert and key files. Download these required files.</li>\n                  <li>Create a Kubernetes secret containing the certificates required by your database using the commands required below. Adjust the file paths to your downloaded certificates, and take out the <code>sslcert</code> and <code>sslkey</code> params if your server doesn&apos;t require access to these.</li>\n                </ol>\n                <Table>\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>Input Source</TableCell>\n                      <TableCell>Secret Creation Command</TableCell>\n                      <TableCell></TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                  {this.state.sslSecrets.map((secret:any, idx) => (\n                    <TableRow key={idx}>\n                      <TableCell>{secret.inputSource}</TableCell>\n                      <TableCell>{secret.cmd}</TableCell>\n                      <TableCell>\n                        <CopyToClipboard text={secret.cmd} onCopy={this.props.clipboardCopy}>\n                          <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n                        </CopyToClipboard>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                  </TableBody>\n                </Table>\n              </ExpansionPanelDetails>\n            </ExpansionPanel>\n          </Paper>\n        </Box>\n        \n        <Box mt={4}>\n          <Paper variant=\"outlined\">\n            <ExpansionPanel>\n              <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Agent Config File</Typography>\n              </ExpansionPanelSummary>\n              <ExpansionPanelDetails>\n                <p>\n                  Please copy and paste this helm configuration file to <b>{this.state.configPath}</b>, and change all of the <b>changemes</b> in this file to real values. This configuration file will be automatically regenerated as you add/remove database inputs from your workflows, at which time you'll have to update this file with the provided updated configuration.\n                </p>\n\n                <Box mt={8}>\n                  <CopyToClipboard text={this.state.helmConfig} onCopy={this.props.clipboardCopy}>\n                    <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n                  </CopyToClipboard>\n                </Box>\n\n                <Box mt={2}>\n                  <pre style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-all' }}>\n                    {this.state.helmConfig}\n                  </pre>\n                </Box>\n              </ExpansionPanelDetails>\n            </ExpansionPanel>\n          </Paper>\n        </Box>\n\n        <Box mt={4}>\n          <Paper variant=\"outlined\">\n            <ExpansionPanel defaultExpanded>\n              <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Agent Helm Upgrade/Install Command</Typography>\n              </ExpansionPanelSummary>\n              <ExpansionPanelDetails>\n                <Box mt={2}>\n                  <CopyToClipboard text={this.state.helmCmd.replace(/\\\\n/g, '\\n')} onCopy={this.props.clipboardCopy}>\n                    <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n                  </CopyToClipboard>\n                </Box>\n\n                <pre style={{ whiteSpace: 'normal' }}>\n                  {this.state.helmCmd.split('\\\\n').map((item:string, key:string) => (key\n                    ? (\n                        <span key={key} style={{ wordBreak: 'break-all', paddingLeft: '15px' }}>\n                          {item}\n                          <br/>\n                        </span>\n                    )\n                    : (\n                        <span key={key} style={{ wordBreak: 'break-all' }}>\n                          {item}\n                          <br/>\n                        </span>\n                    )))}\n                </pre>\n              </ExpansionPanelDetails>\n            </ExpansionPanel>\n          </Paper>\n        </Box>\n      </React.Fragment>\n    );\n  }\n\n  render() {\n    return (\n      <Card mb={6}>\n        <CardContent>\n          <Grid\n            justify=\"space-between\"\n            container\n            spacing={10}\n          >\n\n            <Grid item xs={1}>\n              {this.statusIcon()}\n            </Grid>\n\n            <Grid item xs={11}>\n              <Typography variant=\"h4\">\n                {this.state.agentName} <code>({this.props.agent.uuid})</code>\n              </Typography>\n\n              <Box mt={4}>\n                {this.agentInfo()}\n              </Box>\n\n              {this.renderDeleteAgent()}\n            </Grid>\n\n          </Grid>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nexport default Agent;\n","/Users/joe/www/redactics-osedition/react/src/pages/settings/PresetRandomString.tsx",["252"],"import React from 'react';\nimport styled from 'styled-components';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  FormControl as MuiFormControl,\n  Typography,\n  TextField as MuiTextField,\n} from '@material-ui/core';\n\nimport { spacing } from '@material-ui/system';\n\nimport { RedactRulePreset } from '../../types/redactics';\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\ninterface IProps {\n  selectedPreset: RedactRulePreset;\n  handleChange: any;\n}\n\ninterface IState {\n  key: string;\n  chars: number;\n}\n\nclass PresetRandomString extends React.Component<IProps, IState> {\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      key: this.props.selectedPreset.key || '',\n      chars: this.props.selectedPreset.redactData.chars || 24,\n    };\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n\n        <Typography variant=\"body1\" gutterBottom>\n          Replace data with a random alphanumeric string of a provided length\n        </Typography>\n\n         <form noValidate autoComplete=\"off\">\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              onChange={(event) => this.props.handleChange(this.state.key, event)}\n              name=\"chars\"\n              label=\"Random String Character Length\"\n              defaultValue={this.state.chars}\n              type=\"number\"\n            />\n          </FormControl>\n\n        </form>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default PresetRandomString;\n","/Users/joe/www/redactics-osedition/react/src/pages/settings/PresetReplacement.tsx",["253"],"import React from 'react';\nimport styled from 'styled-components';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  FormControl as MuiFormControl,\n  Typography,\n  TextField as MuiTextField,\n} from '@material-ui/core';\n\nimport { spacing } from '@material-ui/system';\n\nimport { RedactRulePreset } from '../../types/redactics';\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\ninterface IProps {\n  selectedPreset: RedactRulePreset;\n  handleChange: any;\n}\n\ninterface IState {\n  key: string;\n  replacement: string;\n}\n\nclass PresetReplacement extends React.Component<IProps, IState> {\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      key: this.props.selectedPreset.key || '',\n      replacement: this.props.selectedPreset.redactData.replacement || 'redacted',\n    };\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n\n        <Typography variant=\"body1\" gutterBottom>\n          Replace data with a provided value\n        </Typography>\n\n        <form noValidate autoComplete=\"off\">\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              onChange={(event) => this.props.handleChange(this.state.key, event)}\n              name=\"replacement\"\n              label=\"Replacement Text\"\n              defaultValue={this.state.replacement}\n            />\n          </FormControl>\n        </form>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default PresetReplacement;\n","/Users/joe/www/redactics-osedition/react/src/pages/settings/PresetRedactEmail.tsx",["254"],"import React from 'react';\nimport styled from 'styled-components';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  FormControl as MuiFormControl,\n  Typography,\n  TextField as MuiTextField,\n} from '@material-ui/core';\n\nimport { spacing } from '@material-ui/system';\n\nimport { RedactRulePreset } from '../../types/redactics';\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\ninterface IProps {\n  selectedPreset: RedactRulePreset;\n  handleChange: any;\n}\n\ninterface IState {\n  key: string;\n  prefix: string;\n  domain: string;\n  primaryKey: string;\n}\n\n/* eslint-disable max-len */\n\nclass PresetRedactEmail extends React.Component<IProps, IState> {\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      key: this.props.selectedPreset.key || '',\n      prefix: this.props.selectedPreset.redactData.prefix || 'redacted',\n      domain: this.props.selectedPreset.redactData.domain || 'redactics.com',\n      primaryKey: this.props.selectedPreset.redactData.primaryKey || 'id',\n    };\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n\n        <Typography variant=\"body1\" gutterBottom>\n          Transform emails to unique email address derived from the row&quot;s primary key, constructed based on provided prefix and domain - i.e. <code>[prefix][primarykey]@[domain]</code>\n        </Typography>\n\n        <form noValidate autoComplete=\"off\">\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              onChange={(event) => this.props.handleChange(this.state.key, event)}\n              name=\"prefix\"\n              label=\"Prefix\"\n              defaultValue={this.state.prefix}\n            />\n          </FormControl>\n\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              onChange={(event) => this.props.handleChange(this.state.key, event)}\n              name=\"primaryKey\"\n              label=\"Primary Key\"\n              defaultValue={this.state.primaryKey}\n            />\n          </FormControl>\n\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              onChange={(event) => this.props.handleChange(this.state.key, event)}\n              name=\"domain\"\n              label=\"Domain\"\n              defaultValue={this.state.domain}\n            />\n          </FormControl>\n\n        </form>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default PresetRedactEmail;\n","/Users/joe/www/redactics-osedition/react/src/pages/workflows/Workflow.tsx",["255","256","257","258","259","260","261","262","263","264","265","266","267"],"import React from 'react';\nimport styled from 'styled-components';\nimport { withStyles } from '@material-ui/core/styles';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\n\nimport {\n  Card as MuiCard,\n  CardContent,\n  Grid as MuiGrid,\n  Typography,\n  Button as MuiButton,\n  Box,\n  Snackbar,\n  IconButton,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Paper,\n  ExpansionPanel,\n  ExpansionPanelDetails as MuiExpansionPanelDetails,\n  ExpansionPanelSummary,\n  FormControl as MuiFormControl,\n  InputLabel,\n  Select as MuiSelect,\n  MenuItem,\n} from '@material-ui/core';\n\nimport {\n  ExpandMore as ExpandMoreIcon,\n  DeleteOutline as DeleteIcon,\n  Close as CloseIcon,\n} from '@material-ui/icons';\n\nimport {\n  Save as SaveIcon,\n  Clipboard as ClipboardIcon,\n} from 'react-feather';\n\nimport { Alert as MuiAlert } from '@material-ui/lab';\n\nimport { spacing } from '@material-ui/system';\nimport RedacticsContext from '../../contexts/RedacticsContext';\n\nimport WorkflowRedactionRules from './WorkflowRedactionRules';\nimport WorkflowInputs from './WorkflowInputs';\n//import WorkflowCompliance from './WorkflowCompliance';\nimport WorkflowSchedule from './WorkflowSchedule';\nimport WorkflowExport from './WorkflowExport';\nimport WorkflowPostExport from './WorkflowPostExport';\nimport DatabaseMigrationSetup from './DatabaseMigrationSetup';\n\nimport {\n  RedactRule, CustomSecret, WorkflowRecord, WorkflowUpdate, PostUpdateParam,\n  AgentRecord, RedactRulePreset, RedactRuleSet, DataFeed, AgentInputRecord, WorkflowInputRecord,\n} from '../../types/redactics';\n\nconst Card = styled(MuiCard)(spacing);\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst Button = styled(MuiButton)(spacing);\n\nconst styles = {\n  selectAdornment: {\n    marginRight: '-30px',\n  },\n};\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 200px;\n  max-width: 200px;\n`;\n\nconst Select = styled(MuiSelect)(spacing);\n\nconst ExpansionPanelDetails = withStyles({\n  root: {\n    display: 'block',\n  },\n})(MuiExpansionPanelDetails);\n\nconst Alert = styled(MuiAlert)(spacing);\n\ninterface IProps {\n  deleteWorkflow: any;\n  handleWFChanges: any;\n  workflow: WorkflowRecord;\n  agentInputs: AgentInputRecord[];\n  agents: AgentRecord[];\n  presets?: RedactRulePreset[];\n  redactrulesets: RedactRuleSet[];\n  redactrules?: RedactRule[];\n  classes: any;\n}\n\ninterface IState {\n  errors: any;\n  agentId: string;\n  saveButtonDisabled: boolean;\n  agentNamespace?: string;\n  addAllS3Uploads: boolean;\n  S3UploadBucket: string;\n  tableOutputOptions: any;\n  exportTableSchemaAll: boolean;\n  exportTableDataAll: boolean;\n  S3UploadFileChecked: string[];\n  exportTableDataConfig: any;\n  displayExportTableData: string;\n  displayExportTableSchema: string;\n  customSchedule: boolean;\n  scheduleSelection: string;\n  schedule: string;\n  exportSchedule: boolean;\n  userSearchEmailField: string;\n  userSearchEmailDBTable: string;\n  userSearchEmailColumn: string;\n  maskingRuleValues: RedactRule[];\n  maskingRules: RedactRule[];\n  generateSoftDeleteQueries: boolean;\n  numMaskingRules: number;\n  newRuleKey: number;\n  input: WorkflowInputRecord;\n  inputs: WorkflowInputRecord[];\n  dataFeed: DataFeed;\n  dataFeeds: DataFeed[];\n  newInputKey: number;\n  newDataFeedKey: number;\n  addTable: string;\n  missingInput: boolean;\n  transformExpanded: boolean;\n  outputExpanded: boolean;\n  allDatabaseTables: string[];\n  currentDatabaseTable: string;\n  numInputs: number;\n  workflowType: string;\n  deltaUpdateField: string;\n  snackbarText: string;\n  // dialog toggles\n  showDialog: boolean;\n  showSnackbar: boolean;\n  helmReminderCheckbox: boolean;\n  showHelmReminder: boolean;\n  validDiskSize: boolean;\n  validName: boolean;\n  validSchedule: boolean;\n  missingSecretField: boolean;\n  invalidOutputSettingField: boolean;\n  missingPostExportHookField: boolean;\n  missingSchemaSelection: boolean;\n  dupeTableExportFound: boolean;\n  dupeRedactRuleFound: boolean;\n  completeRedactRules: boolean;\n  deleteWorkflowConfirmation: boolean;\n  showLastReportedError: boolean;\n  ackHelmReminder: boolean;\n  orphanedWorkflow: boolean;\n  editInputDialog: boolean;\n  showSnackbarEdit: boolean;\n  showOutputOptions: boolean;\n  editDataFeed: boolean;\n  columnExclusionProhibited: boolean;\n  invalidForgetUserFields: boolean;\n  invalidMigrationFields: boolean;\n  digitalTwinAdded: boolean;\n  // snackbar toggles\n  showClipboardSnackbar: boolean;\n}\n\nclass Workflow extends React.Component<IProps, IState> {\n  static contextType = RedacticsContext;\n\n  constructor(props:IProps) {\n    super(props);\n\n    this.saveChanges = this.saveChanges.bind(this);\n    this.hideHelmReminder = this.hideHelmReminder.bind(this);\n    this.toggleHelmReminder = this.toggleHelmReminder.bind(this);\n    this.addMaskingRule = this.addMaskingRule.bind(this);\n    this.deleteMaskingRule = this.deleteMaskingRule.bind(this);\n    this.handleRuleChange = this.handleRuleChange.bind(this);\n    this.showLastReportedError = this.showLastReportedError.bind(this);\n    this.hideLastReportedError = this.hideLastReportedError.bind(this);\n    this.addSecret = this.addSecret.bind(this);\n    this.handleDeleteSecret = this.handleDeleteSecret.bind(this);\n    this.hideErrorDialog = this.hideErrorDialog.bind(this);\n    this.handleExportSchedule = this.handleExportSchedule.bind(this);\n    this.handleSchedule = this.handleSchedule.bind(this);\n    this.handleDeltaUpdate = this.handleDeltaUpdate.bind(this);\n    this.handleCustomSecret = this.handleCustomSecret.bind(this);\n    this.validateRedactionRules = this.validateRedactionRules.bind(this);\n    this.addExportTableColumn = this.addExportTableColumn.bind(this);\n    this.deleteExportTableColumn = this.deleteExportTableColumn.bind(this);\n    this.handleTableOutputChanges = this.handleTableOutputChanges.bind(this);\n    this.validateOutputSettings = this.validateOutputSettings.bind(this);\n    this.validateForgetUserFields = this.validateForgetUserFields.bind(this);\n    this.deleteWorkflowConfirmation = this.deleteWorkflowConfirmation.bind(this);\n    this.cancelWorkflowConfirmation = this.cancelWorkflowConfirmation.bind(this);\n    this.clipboardCopy = this.clipboardCopy.bind(this);\n    this.handleSnackbarClose = this.handleSnackbarClose.bind(this);\n    this.handleSoftDeletionFields = this.handleSoftDeletionFields.bind(this);\n    this.handleSoftDeleteEmailAddressField = this.handleSoftDeleteEmailAddressField.bind(this);\n    this.markAddToS3UploadList = this.markAddToS3UploadList.bind(this);\n    this.addAllToS3UploadList = this.addAllToS3UploadList.bind(this);\n    this.getExportFileNames = this.getExportFileNames.bind(this);\n    this.saveInputChanges = this.saveInputChanges.bind(this);\n    this.triggerEditInputDialog = this.triggerEditInputDialog.bind(this);\n    this.handleInputChanges = this.handleInputChanges.bind(this);\n    this.selectInputSource = this.selectInputSource.bind(this);\n    this.handleAddTable = this.handleAddTable.bind(this);\n    this.triggerAddTable = this.triggerAddTable.bind(this);\n    this.hideInputDialog = this.hideInputDialog.bind(this);\n    this.deleteDatabaseTable = this.deleteDatabaseTable.bind(this);\n    this.deleteWorkflow = this.deleteWorkflow.bind(this);\n    this.transformExpansion = this.transformExpansion.bind(this);\n    this.triggerOutputOptions = this.triggerOutputOptions.bind(this);\n    this.hideOutputOptions = this.hideOutputOptions.bind(this);\n    this.addDataFeed = this.addDataFeed.bind(this);\n    this.hideDataFeed = this.hideDataFeed.bind(this);\n    this.handleDataFeed = this.handleDataFeed.bind(this);\n    this.addParameterValue = this.addParameterValue.bind(this);\n    this.updateParameterValue = this.updateParameterValue.bind(this);\n    this.deleteParameterValue = this.deleteParameterValue.bind(this);\n    this.handleDataFeedBack = this.handleDataFeedBack.bind(this);\n    this.handleDataFeedCancel = this.handleDataFeedCancel.bind(this);\n    this.getS3UploadFileNames = this.getS3UploadFileNames.bind(this);\n    this.handleDataFeedOptions = this.handleDataFeedOptions.bind(this);\n    this.saveDataFeedChanges = this.saveDataFeedChanges.bind(this);\n    this.triggerEditDataFeed = this.triggerEditDataFeed.bind(this);\n    this.deleteDataFeed = this.deleteDataFeed.bind(this);\n    this.resetDataFeedErrors = this.resetDataFeedErrors.bind(this);\n    //this.saveFeedback = this.saveFeedback.bind(this);\n\n    const maskingRuleValues:RedactRule[] = [];\n    if (this.props.workflow.redactrules && this.props.workflow.redactrules.length) {\n      this.props.workflow.redactrules.forEach((rule:RedactRule) => {\n        maskingRuleValues.push({\n          key: rule.uuid,\n          table: rule.table,\n          databaseTable: rule.databaseTable,\n          column: rule.column,\n          rule: rule.rule,\n          presetUuid: rule.presetUuid,\n        });\n      });\n    }\n\n    // const availableUserEmailRelations:string[] = [];\n    // if (this.props.workflow.redactrules && this.props.workflow.redactrules.length) {\n    //   const userSearchEmailField = (this.props.workflow.userSearchEmailField) ? this.props.workflow.userSearchEmailField.split('.')[0] : '';\n    //   const usedTables = (this.props.workflow.userSearchEmailRelations && this.props.workflow.userSearchEmailRelations.length) ? this.props.workflow.userSearchEmailRelations.map((r:string) => r.split('.')[0]) : [];\n    //   this.props.workflow.redactrules.forEach((rule:RedactRule) => {\n    //     if (rule.table !== userSearchEmailField && !usedTables.includes(rule.table)\n    //       && !availableUserEmailRelations.includes(rule.table)) {\n    //       availableUserEmailRelations.push(rule.table);\n    //     }\n    //   });\n    // }\n\n    const thisAgentSearch = this.props.agents.find(\n      (a:AgentRecord) => ((a.uuid === this.props.workflow.agentId)),\n    );\n    const agentNamespace = (thisAgentSearch) ? thisAgentSearch.namespace : '';\n\n    const userSearchEmailDBTable = (this.props.workflow.userSearchEmailField) ? this.props.workflow.userSearchEmailDBTable : '';\n    const userSearchEmailColumn = (this.props.workflow.userSearchEmailField) ? this.props.workflow.userSearchEmailColumn : '';\n\n    const state:IState = {\n      agentId: this.props.workflow.agentId,\n      newRuleKey: 0,\n      missingInput: (this.props.workflow.allDatabaseTables && this.props.workflow.allDatabaseTables.length) ? false : true,\n      transformExpanded: (this.props.workflow.allDatabaseTables && this.props.workflow.allDatabaseTables.length) ? true : false,\n      outputExpanded: false,\n      allDatabaseTables: this.props.workflow.allDatabaseTables,\n      saveButtonDisabled: false,\n      showHelmReminder: false,\n      helmReminderCheckbox: false,\n      showLastReportedError: false,\n      maskingRules: [],\n      maskingRuleValues,\n      completeRedactRules: true,\n      dupeRedactRuleFound: false,\n      dupeTableExportFound: false,\n      missingSchemaSelection: false,\n      missingSecretField: false,\n      invalidOutputSettingField: false,\n      missingPostExportHookField: false,\n      validSchedule: true,\n      validName: true,\n      validDiskSize: true,\n      numMaskingRules: maskingRuleValues.length,\n      exportSchedule: !!((this.props.workflow.schedule && this.props.workflow.schedule !== 'None')),\n      scheduleSelection: (this.props.workflow.schedule && !this.props.workflow.schedule.match(/^@/) && this.props.workflow.schedule !== 'None') ? 'custom' : this.props.workflow.schedule || '',\n      customSchedule: !!((this.props.workflow.schedule && !this.props.workflow.schedule.match(/^@/) && this.props.workflow.schedule !== 'None')),\n      schedule: this.props.workflow.schedule || 'None',\n      tableOutputOptions: [],\n      exportTableDataConfig: this.props.workflow.exportTableDataConfig || [],\n      generateSoftDeleteQueries: this.props.workflow.generateSoftDeleteQueries || false,\n      userSearchEmailField: this.props.workflow.userSearchEmailField || '',\n      userSearchEmailDBTable: userSearchEmailDBTable || \"\",\n      userSearchEmailColumn: userSearchEmailColumn || \"\",\n      addTable: '',\n      displayExportTableSchema: 'none',\n      displayExportTableData: 'none',\n      showClipboardSnackbar: false,\n      agentNamespace,\n      S3UploadFileChecked: [],\n      S3UploadBucket: '',\n      errors: {\n        schedule: false,\n        name: false,\n        diskSize: false,\n        duplicateDataFeed: false,\n      },\n      input: {\n        uuid: \"\",\n        inputName: \"\",\n        enabled: true,\n        tables: [],\n      },\n      inputs: this.props.workflow.inputs,\n      numInputs: this.props.workflow.inputs.length,\n      dataFeed: {\n        uuid: \"\",\n        dataFeed: \"\",\n        dataFeedConfig: {\n          uploadFileChecked: [],\n          addAllS3Uploads: false,\n          s3Bucket: \"\",\n          postUpdateKeyValues: []\n        },\n        feedSecrets: [],\n      },\n      dataFeeds: this.props.workflow.datafeeds,\n      editInputDialog: false,\n      showDialog: false,\n      showSnackbarEdit: false,\n      newInputKey: 0,\n      newDataFeedKey: 0,\n      addAllS3Uploads: false,\n      exportTableSchemaAll: false,\n      exportTableDataAll: false,\n      showSnackbar: false,\n      deleteWorkflowConfirmation: false,\n      ackHelmReminder: false,\n      orphanedWorkflow: false,\n      currentDatabaseTable: \"\",\n      showOutputOptions: false,\n      editDataFeed: false,\n      columnExclusionProhibited: false,\n      invalidForgetUserFields: false,\n      invalidMigrationFields: false,\n      digitalTwinAdded: false,\n      workflowType: '',\n      deltaUpdateField: this.props.workflow.deltaUpdateField || \"\",\n      snackbarText: \"\"\n    };\n\n    this.props.redactrulesets.forEach((rule:RedactRuleSet) => {\n      state.maskingRules.push({\n        table: '',\n        databaseTable: '',\n        column: '',\n        rule: '',\n        key: rule.redactKey,\n        val: rule.redactName,\n      });\n    });\n\n    if (this.props.presets && this.props.presets.length) {\n      this.props.presets.forEach((preset:RedactRulePreset) => {\n        if (!preset.isDefault) {\n          state.maskingRules.push({\n            table: '',\n            databaseTable: '',\n            column: '',\n            rule: '',\n            key: `preset-${preset.uuid}`,\n            val: `Preset: ${preset.presetName}`,\n            presetUuid: preset.uuid,\n          });\n        }\n      });\n    }\n\n    // set default table output options\n    this.props.workflow.inputs.forEach((input:WorkflowInputRecord) => {\n      if (input.tables && input.tables.length) {\n        input.tables.forEach((table:string) => {\n          state.tableOutputOptions[table] = {\n            errors: {\n              addColumn: false\n            },\n            addColumn: '',\n            exportColumns: \"all\",\n            exportRows: \"all\",\n            fields: [],\n            numDays: 30,\n            sampleFields: \"createdAndUpdated\",\n            createdAtField: \"created_at\",\n            updatedAtField: \"updated_at\",\n          }\n        })\n      }\n    })\n\n    // replace table output options with recorded values    \n    this.props.workflow.exportTableDataConfig.forEach((c:any) => {\n      Object.entries(c).forEach((cf:any) => {\n        const [table, config] = cf;\n        if (!config.updatedAtField) {\n          // default to delta update field, fallback to \"updated_at\" if this doesn't exist\n          config.updatedAtField = state.deltaUpdateField;\n        }\n        state.tableOutputOptions[table] = {\n          errors: {\n            addColumn: false\n          },\n          addColumn: '',\n          exportColumns: (config.fields && config.fields.length) ? \"specific\" : \"all\",\n          exportRows: (config.numDays) ? \"specific\" : \"all\",\n          fields: config.fields || [],\n          numDays: config.numDays || 30,\n          sampleFields: config.sampleFields || \"createdAndUpdated\",\n          createdAtField: config.createdAtField || \"created_at\",\n          updatedAtField: config.updatedAtField || \"updated_at\",\n        }\n      })\n    })\n\n    // look for orphaned workflows\n    if (this.props.workflow.workflowType === \"ERL\" && !this.props.workflow.agentId) {\n      state.orphanedWorkflow = true;\n    }\n\n    // init state\n    this.state = state;\n  }\n\n  componentDidMount() {\n    // copy context data into component state\n    this.setState({\n      ackHelmReminder: this.context.ackHelmReminder,\n    });\n  }\n\n  clipboardCopy(copied:string) {\n    let copiedText:string = \"\";\n    switch (copied) {\n      case 'dbuuid':\n      copiedText = \"This workflow UUID has been copied to your clipboard\";\n      break;\n\n      case 'sampleMigrationHook':\n      copiedText = \"This sample Helmchart hook has been copied to your clipboard\";\n      break;\n\n      case 'sampleMigrationScript':\n      copiedText = \"This sample script has been copied to your clipboard\";\n      break;\n    }\n    this.setState({\n      showClipboardSnackbar: true,\n      snackbarText: copiedText,\n    });\n  }\n\n  handleRuleChange(key:string, event:any) {\n    const { maskingRuleValues } = this.state;\n    const values = this.state.maskingRuleValues.filter((value:RedactRule) => value.key === key);\n\n    maskingRuleValues.map((row:RedactRule) => {\n      if (row.key === key && event.target.name === 'databaseTable') {\n        values[0].databaseTable = event.target.value;\n      } else if (row.key === key && event.target.name === 'column') {\n        values[0].column = event.target.value;\n      } else if (row.key === key && event.target.name === 'rule') {\n        values[0].rule = event.target.value;\n        if (event.target.value.match(/^preset-/)) {\n          const preset = this.state.maskingRules.filter((mr:RedactRule) => {\n            if (mr.key === event.target.value) {\n              return mr;\n            }\n\n            return false;\n          });\n          values[0].presetUuid = preset[0].presetUuid;\n        } else {\n          values[0].presetUuid = '';\n        }\n      }\n\n      return values;\n    });\n\n    this.setState({\n      maskingRuleValues,\n    });\n\n    // console.log(maskingRuleValues)\n  }\n\n  // saveFeedback() {\n  //   let showDialog = (this.state.numInputs === this.state.inputs.length) ? false : true;\n  //   const digitalTwinAdded = this.state.dataFeeds.find((df:DataFeed) => {\n  //     return (df.dataFeed === \"digitalTwin\" && df.uuid.match(/^new/)) ? true : false;\n  //   }) ? true : false;\n  //   if (digitalTwinAdded) { showDialog = true; }\n\n  //   this.setState({\n  //     showDialog,\n  //   });\n\n  //   if (showDialog) {\n  //     return 'dialog';\n  //   }\n  //   else {\n  //     return 'snackbar';\n  //   }\n  // }\n\n  async saveChanges(workflowId:string) {\n    // console.log(this.state);\n\n    this.setState({\n      saveButtonDisabled: true,\n      errors: {},\n    });\n\n    // prep exportTableDataConfig\n    const dataConfig:any = {};\n    this.state.allDatabaseTables.forEach((t:string) => {\n      const tableArr:string[] = t.split(': ');\n      const table:string = tableArr[(tableArr.length - 1)];\n      dataConfig[table] = {\n        table: table,\n        fields: (this.state.tableOutputOptions[table].exportColumns === \"all\") ? [] : this.state.tableOutputOptions[table].fields,\n        numDays: (this.state.tableOutputOptions[table].exportRows === \"all\") ? null : parseInt(this.state.tableOutputOptions[table].numDays),\n        sampleFields: (this.state.tableOutputOptions[table].exportRows === \"all\") ? null : this.state.tableOutputOptions[table].sampleFields,\n        createdAtField: (this.state.tableOutputOptions[table].exportRows === \"all\") ? null : this.state.tableOutputOptions[table].createdAtField,\n        updatedAtField: (this.state.tableOutputOptions[table].exportRows === \"all\") ? null : this.state.tableOutputOptions[table].updatedAtField,\n      }\n    })\n\n    const payload:WorkflowUpdate = {\n      name: this.props.workflow.name,\n      agentId: this.props.workflow.agentId,\n      workflowType: this.props.workflow.workflowType,\n      inputs: this.state.inputs,\n      dataFeeds: this.state.dataFeeds,\n      maskingRules: this.state.maskingRuleValues,\n      schedule: this.state.schedule,\n      exportTableDataConfig: [dataConfig],\n      generateSoftDeleteQueries: !!(this.state.generateSoftDeleteQueries),\n      userSearchEmailField: this.state.userSearchEmailField,\n      userSearchEmailDBTable: this.state.userSearchEmailDBTable,\n      userSearchEmailColumn: this.state.userSearchEmailColumn,\n      deltaUpdateField: this.state.deltaUpdateField,\n      migrationNamespace: this.props.workflow.migrationNamespace,\n      migrationDatabase: this.props.workflow.migrationDatabase,\n      migrationDatabaseClone: this.props.workflow.migrationDatabaseClone,\n      migrationConfiguration: this.props.workflow.migrationConfiguration,\n      migrationHelmHookWeight: this.props.workflow.migrationHelmHookWeight,\n    };\n\n    //console.log('PAYLOAD', payload);\n    //console.log(this.state);\n\n    if (this.validateRedactionRules() && this.validateOutputSettings() && \n      this.validateForgetUserFields() && this.validateMigrationMockFields()) {\n      try {\n        const response = await fetch(`${this.context.apiUrl}/workflow/${workflowId}`, {\n          method: 'put',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          credentials: 'include',\n          body: JSON.stringify(payload),\n        });\n\n        this.setState({\n          saveButtonDisabled: false,\n        });\n\n        const data = await response.json();\n\n        if (data.errors) {\n          let invalidSchedule:boolean = false;\n          let orphanedWorkflow:boolean = false;\n          let columnExclusion:boolean = false;\n          const invalidScheduleError = \"Invalid schedule\";\n          const orphanedWorkflowError = \"Invalid agent ID\";\n          const columnExclusionError = \"Data feed does not permit column exclusion\";\n          \n          if (Array.isArray(data.errors)) {\n            // multiple errors found\n            invalidSchedule = data.errors.find((e:any) => ((e.msg === invalidScheduleError)));\n            orphanedWorkflow = data.errors.find((e:any) => ((e.msg === orphanedWorkflowError) && e.param === 'agentId'));\n            columnExclusion = data.errors.find((e:any) => ((e.msg === columnExclusionError)));\n          }\n          else {\n            // single error returned as string\n            invalidSchedule = (data.errors === invalidScheduleError) ? true : false;\n            orphanedWorkflow = (data.errors === orphanedWorkflowError) ? true : false;\n            columnExclusion = (data.errors === columnExclusionError) ? true : false;\n          }\n          if (invalidSchedule) {\n            this.setState({\n              validSchedule: false,\n              errors: {\n                schedule: true,\n              },\n            });\n          } else if (orphanedWorkflow) {\n            this.setState({\n              orphanedWorkflow: true,\n              errors: {\n                agentId: true,\n              },\n            });\n          } else if (columnExclusion) {\n            this.setState({\n              columnExclusionProhibited: true,\n            });\n          }\n          return;\n        }\n\n        if (this.props.workflow.workflowType === \"multiTenantWebERL\") {\n          // redirect to jobs page\n          window.location.href = \"/workflows/jobs\";\n          return;\n        }\n\n        // attach new redact rule UUIDs to state\n        const maskingRuleValues = this.state.maskingRuleValues.map((r:RedactRule, idx:number) => {\n          const rule = r;\n          rule.key = data.redactRuleUuids[idx];\n          return rule;\n        });\n\n        this.setState({\n          showDialog: (data.updateHelmConfig) ? true : false,\n          showSnackbar: (data.updateHelmConfig) ? false : true,\n          maskingRuleValues,\n          saveButtonDisabled: false,\n          numInputs: this.state.inputs.length,\n        });\n      } catch (err) {\n        // console.log('CATCH ERR', error);\n\n        this.setState({\n          saveButtonDisabled: false,\n        });\n      }\n    } else {\n      this.setState({\n        saveButtonDisabled: false,\n      });\n    }\n  }\n\n  async hideHelmReminder() {\n    if (this.state.helmReminderCheckbox) {\n      // record acknowledgement of reminder (for embedded agent config feature)\n      await fetch(`${this.context.apiUrl}/workflow/ackReminder`, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n      });\n\n      this.setState({\n        ackHelmReminder: true,\n        showDialog: false,\n      });\n    } else {\n      this.setState({\n        showDialog: false,\n      });\n    }\n  }\n\n  toggleHelmReminder(event:any) {\n    this.setState({\n      helmReminderCheckbox: event.target.checked,\n    });\n  }\n\n  validateRedactionRules() {\n    // skip validation if GUI disabled\n    if (this.state.missingInput) { return true; }\n\n    const rules:string[] = [];\n    let dupeRedactRuleFound = false;\n\n    const validFields = this.state.maskingRuleValues.filter((rule:RedactRule) => {\n      let missingFields:number = 0;\n\n      if (rules.includes(`${rule.databaseTable}.${rule.column}`)) {\n        dupeRedactRuleFound = true;\n      } else {\n        rules.push(`${rule.databaseTable}.${rule.column}`);\n      }\n\n      if (!rule.databaseTable) { missingFields++; }\n      if (!rule.column) { missingFields++; }\n      if (!rule.rule) { missingFields++; }\n\n      if (missingFields === 1 || missingFields === 2 || !this.legalName(rule.column)) {\n        // allow blanks and complete sets\n        return rule;\n      }\n\n      return false;\n    });\n\n    const validRules = !((validFields.length || dupeRedactRuleFound));\n    const completeRedactRules = !validFields.length;\n\n    this.setState({\n      completeRedactRules,\n      dupeRedactRuleFound,\n    });\n    return validRules;\n  }\n\n  validateOutputSettings() {\n    let invalidDBField:boolean = false;\n    this.state.allDatabaseTables.forEach((t:string) => {\n      const tableArr:string[] = t.split(': ');\n      const table:string = tableArr[(tableArr.length - 1)];\n      if (this.state.tableOutputOptions[table].exportRows !== \"all\") {\n        if (this.state.tableOutputOptions[table].sampleFields.toLowerCase().match(/created/) &&\n          (!this.state.tableOutputOptions[table].createdAtField || !this.legalName(this.state.tableOutputOptions[table].createdAtField))) {\n          invalidDBField = true;\n        }\n        else if (this.state.tableOutputOptions[table].sampleFields.toLowerCase().match(/updated/) &&\n          (!this.state.tableOutputOptions[table].updatedAtField || !this.legalName(this.state.tableOutputOptions[table].updatedAtField))) {\n          invalidDBField = true;\n        }\n      }\n    })\n\n    if (invalidDBField) {\n      this.setState({\n        invalidOutputSettingField: true\n      })\n      return false;\n    }\n\n    return true;\n  }\n\n  validateForgetUserFields() {\n    if (this.state.generateSoftDeleteQueries) {\n      if (!this.state.userSearchEmailDBTable || !this.state.userSearchEmailColumn || \n        !this.legalName(this.state.userSearchEmailColumn)) {\n        this.setState({\n          invalidForgetUserFields: true\n        })\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  validateMigrationMockFields() {\n    if (this.props.workflow.workflowType === \"mockDatabaseMigration\") {\n      if (!this.props.workflow.migrationNamespace || !this.props.workflow.migrationDatabase || \n        !this.props.workflow.migrationDatabaseClone || !this.props.workflow.migrationConfiguration) {\n        this.setState({\n          invalidMigrationFields: true\n        })\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hideErrorDialog() {\n    this.setState({\n      completeRedactRules: true,\n      dupeRedactRuleFound: false,\n      dupeTableExportFound: false,\n      validSchedule: true,\n      validName: true,\n      validDiskSize: true,\n      missingSchemaSelection: false,\n      missingPostExportHookField: false,\n      missingSecretField: false,\n      invalidOutputSettingField: false,\n      orphanedWorkflow: false,\n      columnExclusionProhibited: false,\n      invalidForgetUserFields: false,\n      invalidMigrationFields: false,\n    });\n  }\n\n  deleteMaskingRule(key:string) {\n    const maskingRuleValues = this.state.maskingRuleValues.filter(\n      (row:RedactRule) => (row.key !== key),\n    );\n\n    this.setState({\n      numMaskingRules: (this.state.numMaskingRules - 1),\n      maskingRuleValues,\n    });\n  }\n\n  addMaskingRule() {\n    const { maskingRuleValues } = this.state;\n\n    const numMaskingRules = this.state.numMaskingRules + 1;\n    const newRuleKey = this.state.newRuleKey + 1; // random array idx value\n    maskingRuleValues.push({\n      key: `new${newRuleKey}`,\n      databaseTable: '',\n      table: '',\n      column: '',\n      rule: '',\n    });\n\n    this.setState({\n      maskingRuleValues,\n      numMaskingRules,\n      newRuleKey,\n    });\n  }\n\n  handleSnackbarClose = () => {\n    this.setState({\n      showSnackbar: false,\n      showSnackbarEdit: false,\n      showClipboardSnackbar: false,\n    });\n  };\n\n  deleteWorkflowConfirmation() {\n    this.setState({\n      deleteWorkflowConfirmation: true,\n    });\n  }\n\n  cancelWorkflowConfirmation() {\n    this.setState({\n      deleteWorkflowConfirmation: false,\n    });\n  }\n\n  displayLastReportedError() {\n    return this.props.workflow.lastStackTrace ? this.props.workflow.lastStackTrace.split('\\n').map((text:string, index:number) => <React.Fragment key={`${text}-${index}`}>\n        {text}\n        <br />\n      </React.Fragment>) : '';\n  }\n\n  showLastReportedError(event:any) {\n    event.preventDefault();\n\n    this.setState({\n      showLastReportedError: true,\n    });\n  }\n\n  hideLastReportedError() {\n    this.setState({\n      showLastReportedError: false,\n    });\n  }\n\n  static displayStatus(lastTask:string) {\n    if (lastTask) {\n      return (\n        <Box mt={8}>\n          <Typography variant=\"h6\" gutterBottom>\n            Status\n          </Typography>\n\n          Last task: <b>{lastTask}</b>\n        </Box>\n      );\n    }\n\n    return null;\n  }\n\n  handleDataTableDelete(table:string) {\n    const exportTableDataConfig = this.state.exportTableDataConfig.filter(\n      (t:string) => t !== table,\n    );\n\n    this.setState({\n      exportTableDataConfig,\n    });\n  }\n\n  handleCustomSecret(event:any, idx:number) {\n    const state:IState = this.state;\n    state.dataFeed.feedSecrets[idx][event.target.name] = event.target.value;\n\n    this.setState({\n      dataFeed: state.dataFeed,\n    });\n  }\n\n  addSecret(secretType:string) {\n    const state:IState = this.state;\n    state.dataFeed.feedSecrets.push({\n      secretType,\n      secretName: '',\n      secretKey: '',\n      secretPath: '',\n    });\n\n    this.setState({\n      dataFeed: state.dataFeed,\n    });\n  }\n\n  handleDeleteSecret(idx:number) {\n    const state:IState = this.state;\n    state.dataFeed.feedSecrets = state.dataFeed.feedSecrets.filter(\n      (secret:any, i:number) => i !== idx,\n    );\n\n    this.setState({\n      dataFeed: state.dataFeed,\n    });\n  }\n\n  handleExportSchedule(event:any) {\n    if (event.target.value === 'false') {\n      this.setState({\n        exportSchedule: false,\n        schedule: 'None',\n      });\n    } else {\n      this.setState({\n        exportSchedule: true,\n        schedule: '* 0 * * *',\n      });\n    }\n  }\n\n  handleSchedule(event:any) {\n    const state:any = {};\n    if (event.target.name === 'scheduleSelection') {\n      state.scheduleSelection = event.target.value;\n      state.customSchedule = (event.target.value === 'custom');\n    }\n    state.schedule = (event.target.value === 'custom') ? '* 0 * * *' : event.target.value;\n    this.setState(state);\n  }\n\n  handleDeltaUpdate(event:any) {\n    this.setState({\n      deltaUpdateField: event.target.value\n    });\n  }\n\n  dbUUIDSnackbar() {\n    return (\n      <Snackbar\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n        open={this.state.showClipboardSnackbar}\n        autoHideDuration={8000}\n        onClose={this.handleSnackbarClose}\n        ContentProps={{\n          'aria-describedby': 'message-id',\n        }}\n        message={<span id=\"message-id\">{this.state.snackbarText}</span>}\n        action={[\n          <IconButton\n            key=\"close\"\n            aria-label=\"Close\"\n            color=\"inherit\"\n            onClick={this.handleSnackbarClose}\n          >\n            <CloseIcon />\n          </IconButton>,\n        ]}\n      />\n    );\n  }\n\n  handleSoftDeletionFields(event:any) {\n    const state:any = {};\n    if (event.target.name === 'generateSoftDeleteQueries') {\n      state[event.target.name] = event.target.checked;\n    } else {\n      state[event.target.name] = event.target.value;\n    }\n\n    this.setState(state);\n  }\n\n  handleSoftDeleteEmailAddressField(event:any) {\n    const state:IState = this.state;\n    let tableName:string = \"\";\n    if (event.target.name === \"userSearchEmailDBTable\") {\n      let tableArr:string[] = event.target.value.split(': ');\n      tableName = tableArr[(tableArr.length - 1)];\n\n      state.userSearchEmailField = tableName + \".\" + state.userSearchEmailColumn;\n      state.userSearchEmailDBTable = event.target.value;\n    }\n    else if (event.target.name === \"userSearchEmailColumn\") {\n      let tableArr:string[] = state.userSearchEmailDBTable.split(': ');\n      tableName = tableArr[(tableArr.length - 1)];\n\n      state.userSearchEmailField = tableName + \".\" + event.target.value;\n      state.userSearchEmailColumn = event.target.value;\n    }\n\n    this.setState(state);\n  }\n\n  markAddToS3UploadList(event:any, fileName:string) {\n    const state:IState = this.state;\n\n    if (event.target.checked) {\n      // add to list\n      state.dataFeed.dataFeedConfig.uploadFileChecked.push(fileName);\n\n      if (state.dataFeed.dataFeedConfig.uploadFileChecked.length === this.getS3UploadFileNames().length) {\n        state.dataFeed.dataFeedConfig.addAllS3Uploads = true;\n      }\n    } else {\n      state.dataFeed.dataFeedConfig.uploadFileChecked = state.dataFeed.dataFeedConfig.uploadFileChecked.filter(\n        (f:string) => ((f !== fileName)),\n      );\n      state.dataFeed.dataFeedConfig.addAllS3Uploads = false;\n    }\n\n    this.setState(state);\n  }\n\n  getExportFileNames() {\n    const filenames:string[] = [];\n    this.state.exportTableDataConfig.forEach((t:string) => {\n      filenames.push(`table-${t}.csv`);\n    });\n\n    return filenames;\n  }\n\n  getS3UploadFileNames() {\n    const filenames:string[] = [];\n    if (!this.state.allDatabaseTables) { return []; }\n    this.state.allDatabaseTables.forEach((dt:string) => {\n      const tableArr = dt.split(\": \");\n      const table = tableArr[(tableArr.length - 1)];\n      filenames.push(`table-${table}.csv`);\n    });\n\n    return filenames;\n  }\n\n  addAllToS3UploadList(event:any) {\n    const state:IState = this.state;\n\n    if (event.target.checked) {\n      // check all\n      state.dataFeed.dataFeedConfig.uploadFileChecked = [];\n      this.getS3UploadFileNames().forEach((f) => {\n        state.dataFeed.dataFeedConfig.uploadFileChecked.push(f);\n      });\n\n      state.dataFeed.dataFeedConfig.addAllS3Uploads = true;\n    } else {\n      state.dataFeed.dataFeedConfig.uploadFileChecked = [];\n      state.dataFeed.dataFeedConfig.addAllS3Uploads = false;\n    }\n\n    this.setState(state);\n  }\n\n  addExportTableColumn(event:any, table:string) {\n    const state:IState = this.state;\n    if (!state.tableOutputOptions[table].addColumn) { return; }\n    else if (!this.legalName(state.tableOutputOptions[table].addColumn)) {\n      state.tableOutputOptions[table].errors.addColumn = true;\n    }\n    else {\n      state.tableOutputOptions[table].fields.push(state.tableOutputOptions[table].addColumn);\n      state.tableOutputOptions[table].addColumn = \"\";\n      state.tableOutputOptions[table].errors.addColumn = false;\n    }\n    this.setState(state);\n  }\n\n  deleteExportTableColumn(event:any, table:string, field:string) {\n    const state:IState = this.state;\n\n    state.tableOutputOptions[table].fields = state.tableOutputOptions[table].fields.filter((f:string) => {\n      return (f === field) ? false : true;\n    })\n    this.setState(state);\n  }\n\n  handleTableOutputChanges(event:any, table:string) {\n    const state:IState = this.state;\n    \n    state.tableOutputOptions[table][event.target.name] = event.target.value;\n\n    // transfer data that should be saved to exportTableDataConfig\n    switch (event.target.name) {\n      case 'createdAtField':\n      case 'fields':\n      case 'numDays':\n      case 'sampleFields':\n      case 'updatedAtField':\n        state.exportTableDataConfig = state.exportTableDataConfig.map((config:any) => {\n          const table = Object.keys(config)[0]\n          config[table][event.target.name] = event.target.value;\n          return config;\n        })\n        break;\n\n      default:  \n        break;\n    }\n    this.setState(state);\n  }\n\n  triggerEditInputDialog(input:WorkflowInputRecord, workflowType:string) {\n    // dereference\n    const inputCopy:WorkflowInputRecord = {\n      inputName: input.inputName,\n      uuid: input.uuid,\n      enabled: input.enabled,\n      tables: input.tables,\n    }\n    this.setState({\n      input: inputCopy,\n      workflowType,\n      editInputDialog:true\n    });\n  }\n\n  handleInputChanges(event:any, input:WorkflowInputRecord) {\n    const state:any = this.state;\n    state.inputs = state.inputs.map((i:any) => {\n      if (i.uuid === input.uuid) {\n        i[event.target.name] = (event.target.name === \"enabled\") ? event.target.checked : event.target.value;\n      }\n      return i;\n    })\n    this.setState(state);\n  }\n\n  selectInputSource(event:any) {\n    const state:any = this.state;\n    const findInput = this.props.agentInputs.find((input:AgentInputRecord) => {\n      return (input.uuid === event.target.value)\n    })\n    if (findInput) {\n      state.inputs = [{\n        uuid: findInput.uuid,\n        enabled: true,\n        inputName: findInput.inputName,\n      }]\n      this.setState(state);\n    }\n  }\n\n  handleAddTable(event:any) {\n    this.setState({\n      addTable: event.target.value\n    })\n  }\n\n  triggerAddTable() {\n    const state:IState = this.state;\n    state.errors.addTable = false;\n\n    if (!state.addTable) {\n      return;\n    }\n    else if (!this.legalName(this.state.addTable)) {\n      state.errors.addTable = true;\n      this.setState({\n        errors: state.errors\n      })\n      return;\n    }\n    const input = this.state.input;\n    if (!input.tables) {\n      input.tables = [];\n    }\n    input.tables.push(this.state.addTable);\n\n    this.setState({\n      errors: state.errors,\n      input:input,\n      addTable:\"\",\n    })\n  }\n\n  legalName(name:string) {\n    // skip if no name is provided\n    if (!name) { return true; }\n    return (name.match(/^[a-zA-Z_][a-zA-Z0-9_]{1,30}$/)) ? true : false;\n  }\n\n  deleteWorkflow(input:WorkflowInputRecord) {\n    const state:IState = this.state;\n    state.inputs = state.inputs.filter((i:WorkflowInputRecord) => {\n      return (i.uuid === input.uuid) ? false : true\n    });\n\n     // update listing of tables\n    state.allDatabaseTables = [];\n    state.inputs.forEach((input:WorkflowInputRecord) => {\n      if (!input.tables) {\n        input.tables = [];\n      }\n      input.tables.forEach((table:string) => {\n        state.allDatabaseTables.push(state.input.inputName + \": \" + table);\n      });\n    })\n\n    state.missingInput = (state.inputs.length) ? false : true;\n\n    this.setState({\n      transformExpanded: (state.missingInput) ? false : true,\n      outputExpanded: (state.missingInput) ? false : true,\n      missingInput: state.missingInput,\n      allDatabaseTables: state.allDatabaseTables,\n      inputs: state.inputs\n    });\n  }\n\n  hideInputDialog() {\n    this.setState({\n      editInputDialog:false\n    })\n  }\n\n  deleteDatabaseTable(table:string) {\n    const input = this.state.input;\n    if (!input.tables) {\n      input.tables = [];\n    }\n    input.tables = input.tables.filter((t) => {\n      return (table === t) ? false : true\n    });\n\n    this.setState({\n      input:input\n    })\n  }\n\n  handleEditWorkflowSnackbarClose = () => {\n    this.setState({\n      showSnackbarEdit: false,\n    });\n  };\n\n\n  saveInputChanges() {\n    const state:IState = this.state;\n    let errorsFound:boolean = false;\n    let inputs:WorkflowInputRecord[] = this.state.inputs;\n\n    if (!state.input.tables) {\n      state.input.tables = [];\n    }\n\n    // find and update existing input in inputs listing\n    state.allDatabaseTables = [];\n    inputs = inputs.map((input) => {\n      if (!input.tables) {\n        input.tables = [];\n      }\n\n      // update listing of tables\n      input.tables.forEach((table:string) => {\n        state.allDatabaseTables.push(state.input.inputName + \": \" + table);\n\n        if (!state.tableOutputOptions[table]) {\n          // init default settings\n          state.tableOutputOptions[table] = {\n            errors: {\n              addColumn: false\n            },\n            addColumn: '',\n            exportColumns: \"all\",\n            exportRows: \"all\",\n            fields: [],\n            numDays: 30,\n            sampleFields: \"createdAndUpdated\",\n            createdAtField: \"created_at\",\n            updatedAtField: \"updated_at\",\n          }\n        }\n      });\n\n      return input;\n    });\n\n    // remove maskingrules that contain rules for tables that no longer exist\n    state.maskingRuleValues = state.maskingRuleValues.filter((rule:RedactRule) => {\n      return (state.allDatabaseTables.includes(rule.databaseTable)) ? true : false;\n    })\n    state.numMaskingRules = state.maskingRuleValues.length;\n\n    state.errors.JSX = null;\n    //console.log(\"INPUTS\", inputs);\n    //console.log(\"STATE\", state)\n\n    if (this.state.input.uuid.match(/^new/)) {\n      this.setState({\n        missingInput: false,\n        tableOutputOptions: state.tableOutputOptions,\n        allDatabaseTables: state.allDatabaseTables,\n        errors: state.errors,\n        inputs: inputs,\n        editInputDialog: false,\n        showSnackbarEdit: true,\n        newInputKey: state.newInputKey,\n      })\n    }\n    else {\n      this.setState({\n        missingInput: false,\n        maskingRuleValues: state.maskingRuleValues,\n        numMaskingRules: state.numMaskingRules,\n        allDatabaseTables: state.allDatabaseTables,\n        errors: state.errors,\n        inputs: inputs,\n        editInputDialog: false,\n        showSnackbarEdit: true,\n      })\n    }\n  }\n\n  legalBucketName(bucket:string) {\n    if (!bucket.match(/^[a-zA-Z0-9]{1}[a-zA-Z0-9.-]{1,61}[a-zA-Z0-9]{1}$/)) {\n      return false;\n    }\n    else if (bucket.match(/^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$/)) {\n      // IP address\n      return false;\n    }\n    else if (bucket.match(/^xn--/) || bucket.match(/-s3alias$/)) {\n      return false;\n    }\n    return true;\n  }\n\n  saveDataFeedChanges() {\n    const state:IState = this.state;\n    var errorsFound:boolean = false;\n    var dataFeeds:DataFeed[] = this.state.dataFeeds;\n\n    if (!state.dataFeed.dataFeed) {\n      // no selection, close dialog\n      this.setState({\n        editDataFeed: false,\n      })\n      return; \n    }\n\n    switch (state.dataFeed.dataFeed) {\n      case 's3upload':\n        if (!state.dataFeed.dataFeedConfig.S3UploadBucket || !this.legalBucketName(state.dataFeed.dataFeedConfig.S3UploadBucket)) {\n          state.errors.invalidBucketName = true;\n          errorsFound = true;\n        }\n        else {\n          state.errors.invalidBucketName = false;\n        }\n      break;\n\n      case 'digitalTwin':\n        if (!state.dataFeed.dataFeedConfig.databaseEngine) {\n          state.errors.databaseEngine = true;\n          errorsFound = true;\n        }\n        if (state.dataFeed.dataFeedConfig.enablePostUpdatePreparedStatements && state.dataFeed.dataFeedConfig.postUpdateKeyValues.length) {\n          // validate prepared statements\n          const findInvalid = state.dataFeed.dataFeedConfig.postUpdateKeyValues.find((kv:PostUpdateParam) => {\n            //eslint-disable-next-line\n            return (!kv.key || !String(kv.value) || String(kv.key).match(/[%\\(\\)]+/) || String(kv.value).match(/[%\\(\\)]+/)) ? true : false;\n          })\n          if (findInvalid) {\n            state.errors.invalidPostUpdateKeyValues = true;\n            errorsFound = true;\n          }\n          else {\n            state.errors.invalidPostUpdateKeyValues = false;\n          }\n        }\n      break;\n\n      case 'custom':\n        if (!state.dataFeed.dataFeedConfig.image) {\n          state.errors.image = true;\n          errorsFound = true;\n        }\n        if (!state.dataFeed.dataFeedConfig.tag) {\n          state.errors.tag = true;\n          errorsFound = true;\n        }\n        if (!state.dataFeed.dataFeedConfig.shell) {\n          state.errors.shell = true;\n          errorsFound = true;\n        }\n\n        if (this.state.dataFeed.feedSecrets && this.state.dataFeed.feedSecrets.length) {\n          this.state.dataFeed.feedSecrets.forEach((s: CustomSecret) => {\n            if (s.secretType === 'volume' && (!s.secretName || !s.secretKey || !s.secretPath)) {\n              state.errors.invalidSecret = true;\n              errorsFound = true;\n            } else if (s.secretType === 'env' && (!s.secretName || !s.secretKey || !s.envName)) {\n              state.errors.invalidSecret = true;\n              errorsFound = true;\n            }\n          });\n        }\n\n      break;\n\n      default:\n      break;\n    }\n\n    if (errorsFound) {\n      this.setState({\n        errors: state.errors,\n      })\n      return;\n    }\n\n    if (state.dataFeed.uuid === \"new\") {\n      state.newDataFeedKey++;\n      state.dataFeed.uuid = \"new\" + state.newDataFeedKey;\n\n      dataFeeds.push(state.dataFeed);\n    }\n    else {\n      // update existing datafeed\n      dataFeeds = dataFeeds.map((df:DataFeed) => {\n        if (df.uuid === state.dataFeed.uuid) {\n          df.dataFeed = state.dataFeed.dataFeed;\n          df.dataFeedConfig = state.dataFeed.dataFeedConfig;\n          df.feedSecrets = state.dataFeed.feedSecrets;\n        }\n        return df;\n      })\n    }\n\n    this.setState({\n      dataFeeds,\n      editDataFeed: false,\n      showSnackbarEdit: true\n    })\n  }\n\n  transformExpansion(event:any, expanded:boolean) {\n    this.setState({\n      //transformExpanded: (expanded && !this.state.missingInput) ? true : false\n      transformExpanded: (expanded) ? true : false\n    })\n  }\n\n  outputExpansion(event:any, expanded:boolean) {\n    this.setState({\n      //outputExpanded: (expanded && !this.state.missingInput) ? true : false\n      outputExpanded: (expanded) ? true : false\n    })\n  }\n\n  triggerOutputOptions(event:any, databaseTable:string) {\n    this.setState({\n      currentDatabaseTable: databaseTable,\n      showOutputOptions: true\n    })\n  }\n\n  hideOutputOptions() {\n    this.setState({\n      showOutputOptions: false\n    })\n  }\n\n  resetDataFeedErrors() {\n    const state:IState = this.state;\n    state.errors.duplicateDataFeed = false;\n    state.errors.invalidBucketName = false;\n    state.errors.invalidPostUpdateKeyValues = false;\n    state.errors.invalidSecret = false;\n\n    this.setState({\n      errors: state.errors\n    })\n  }\n\n  addDataFeed() {\n    this.resetDataFeedErrors();\n    const state:IState = this.state;\n\n    state.dataFeed.uuid = \"new\";\n    state.dataFeed.dataFeed = \"\";\n    state.dataFeed.feedSecrets = [];\n\n    this.setState({\n      editDataFeed: true,\n      dataFeed: state.dataFeed\n    })\n  }\n\n  triggerEditDataFeed(df:DataFeed) {\n    this.resetDataFeedErrors();\n    const state:IState = this.state;\n\n    const dataFeed = this.state.dataFeeds.filter((d:DataFeed) => {\n      return (d.uuid === df.uuid) ? true : false;\n    })\n\n    // remove S3 prefix\n    if (dataFeed[0].dataFeed === \"s3upload\" || dataFeed[0].dataFeed === \"dataRepository\") {\n      dataFeed[0].dataFeedConfig.S3UploadBucket = dataFeed[0].dataFeedConfig.S3UploadBucket.replace(/^s3:\\/\\//,'');\n    }\n    if (!dataFeed[0].dataFeedConfig.postUpdateKeyValues) {\n      dataFeed[0].dataFeedConfig.postUpdateKeyValues = [];\n    }\n\n    switch (dataFeed[0].dataFeed) {\n      case 'dataRepository':\n      // reset table listing\n      dataFeed[0].dataFeedConfig.uploadFileChecked = [];\n      this.getS3UploadFileNames().forEach((f) => {\n        dataFeed[0].dataFeedConfig.uploadFileChecked.push(f);\n      });\n      break;\n    }\n\n    // dereference\n    const dataFeedCopy:DataFeed = {\n      uuid: dataFeed[0].uuid,\n      dataFeed: dataFeed[0].dataFeed,\n      dataFeedConfig: dataFeed[0].dataFeedConfig,\n      feedSecrets: dataFeed[0].feedSecrets,\n    }\n\n    this.setState({\n      editDataFeed: true,\n      dataFeed: dataFeedCopy,\n      errors: state.errors,\n    })\n  }\n\n  hideDataFeed() {\n    this.setState({\n      editDataFeed: false\n    })\n  }\n\n  handleDataFeed(dataFeed:string) {\n    const state:IState = this.state;\n\n    // prevent creation of duplicate data feed\n    if (state.dataFeeds && state.dataFeeds.find((df:DataFeed) => {\n      return (df.dataFeed === dataFeed) ? true : false\n    })) {\n      state.errors.duplicateDataFeed = true;\n      state.dataFeed.dataFeed = \"\";\n      this.setState({\n        errors: state.errors,\n        dataFeed: state.dataFeed,\n      });\n      return;\n    }\n\n    state.dataFeed.dataFeed = dataFeed;\n    state.errors.duplicateDataFeed = false;\n\n    // init config\n    switch (dataFeed) {\n      case 'dataRepository':\n      // add all tables\n      state.dataFeed.dataFeedConfig.uploadFileChecked = [];\n      this.getS3UploadFileNames().forEach((f) => {\n        state.dataFeed.dataFeedConfig.uploadFileChecked.push(f);\n      });\n      break;\n\n      case 'digitalTwin':\n      state.dataFeed.dataFeedConfig = {\n        databaseEngine: \"\",\n        enableSSL: false,\n        enableDeltaUpdates: false,\n        enablePostUpdatePreparedStatements: false,\n        postUpdateKeyValues: [],\n      }\n      break;\n\n      case 's3upload':\n      state.dataFeed.dataFeedConfig = {\n        uploadFileChecked: [],\n        addAllS3Uploads: false\n      }\n      break;\n\n      case 'custom':\n      state.dataFeed.dataFeedConfig = {\n        image: \"\",\n        tag: \"\",\n        shell: \"\",\n        command: \"\",\n      }\n      break;\n    }\n    \n    this.setState({\n      dataFeed: state.dataFeed,\n      errors: state.errors,\n    })\n  }\n\n  handleDataFeedBack() {\n    const state:IState = this.state;\n\n    state.dataFeed.dataFeed = \"\";\n    this.setState({\n      dataFeed: state.dataFeed\n    })\n  }\n\n  handleDataFeedCancel() {\n    this.setState({\n      editDataFeed: false\n    })\n  }\n\n  addParameterValue() {\n    const state:IState = this.state;\n    state.dataFeed.dataFeedConfig.postUpdateKeyValues.push({\n      key: \"\",\n      value: \"\"\n    })\n    this.setState(state);\n  }\n\n  updateParameterValue(key:number, event:any) {\n    const state:IState = this.state;\n    state.dataFeed.dataFeedConfig.postUpdateKeyValues = state.dataFeed.dataFeedConfig.postUpdateKeyValues.map((kv:PostUpdateParam, idx:number) => {\n      if (idx === key && event.target.name === \"parameterKey\") {\n        kv.key = event.target.value;\n      }\n      else if (idx === key && event.target.name === \"parameterValue\") {\n        kv.value = (!event.target.value || isNaN(event.target.value)) ? event.target.value : parseFloat(event.target.value);\n      }\n      return kv;\n    })\n    this.setState(state); \n  }\n\n  deleteParameterValue(key:number) {\n    const state:IState = this.state;\n    state.dataFeed.dataFeedConfig.postUpdateKeyValues = state.dataFeed.dataFeedConfig.postUpdateKeyValues.filter((kv:PostUpdateParam, idx:number) => {\n      return (idx === key) ? false : true;\n    });\n    this.setState(state);\n  }\n\n  deleteDataFeed(dataFeed:DataFeed) {\n    const state:IState = this.state;\n    state.dataFeeds = state.dataFeeds.filter((df:DataFeed) => {\n      return (df.uuid === dataFeed.uuid) ? false : true;\n    })\n\n    this.setState({\n      dataFeeds: state.dataFeeds,\n      showSnackbarEdit: true\n    })\n  }\n\n  handleDataFeedOptions(event:any) {\n    const state:IState = this.state;\n    state.dataFeed.dataFeedConfig[event.target.name] = (event.target.name.match(/^enable/)) ? event.target.checked : event.target.value;\n\n    this.setState(state);\n  }\n\n  displayWorkflowType(wf:string) {\n    switch (wf) {\n      case 'ERL':\n      return 'ERL (Extract, Redact, Load)';\n\n      case 'multiTenantWebERL':\n      return 'Web-based ERL Testing (Multi-tenant)';\n\n      case 'mockDatabaseMigration':\n      return 'Database Clone for Migration Dry-run';\n\n      default:\n      break;\n    }\n  }\n\n  /* eslint-disable max-len */\n\n  render() {\n    return (\n      <Card mb={6}>\n        <CardContent>\n          {this.dbUUIDSnackbar()}\n          <Typography variant=\"h4\">\n            {this.props.workflow.name} <code>({this.props.workflow.uuid})</code>\n            <Box display=\"inline\" ml={2}>\n              <CopyToClipboard text={this.props.workflow.uuid} onCopy={() => this.clipboardCopy(\"dbuuid\")}>\n                <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n              </CopyToClipboard>\n            </Box>\n          </Typography>\n\n          <Box>\n            <Grid\n              container\n              justify=\"space-between\"\n              alignItems=\"center\"\n            >\n              <Grid item xs={4}>\n                <Box display={(this.props.workflow.workflowType.match(/^(ERL|mockDatabaseMigration)/)) ? 'block' : 'none'}>\n                  <FormControl margin=\"dense\" fullWidth>\n                    <InputLabel>\n                      Redactics Agent\n                    </InputLabel>\n                    <Select\n                      value={this.props.workflow.agentId}\n                      name=\"agentId\"\n                      onChange={(event) => this.props.handleWFChanges(event, this.props.workflow.uuid)}\n                    >\n                      {this.props.agents.map((agent:AgentRecord) => (\n                        <MenuItem key={agent.uuid} value={agent.uuid}>{agent.name}</MenuItem>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </Box>\n                <Box mt={4}>\n                  Workflow Type: <b>{this.displayWorkflowType(this.props.workflow.workflowType)}</b>\n                </Box>\n              </Grid>\n            </Grid>\n          </Box>\n\n          <Dialog\n            open={this.state.showLastReportedError}\n            onClose={this.hideLastReportedError}\n            maxWidth=\"lg\"\n            aria-labelledby=\"dialog-title\"\n            aria-describedby=\"dialog-description\"\n          >\n            <DialogTitle id=\"dialog-title\">Last Reported Error for: {this.props.workflow.name}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"dialog-description\">\n                {this.displayLastReportedError()}\n              </DialogContentText>\n\n              <DialogActions>\n                <Button color=\"primary\" onClick={this.hideLastReportedError}>\n                  Close\n                </Button>\n              </DialogActions>\n            </DialogContent>\n          </Dialog>\n\n          <Box mt={12}>\n            <Paper variant=\"outlined\">\n              <ExpansionPanel>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Input Settings</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <WorkflowInputs\n                    errors={this.state.errors}\n                    workflow={this.props.workflow}\n                    agentInputs={this.props.agentInputs}\n                    agents={this.props.agents}\n                    input={this.state.input}\n                    inputs={this.state.inputs}\n                    saveInputChanges={this.saveInputChanges}\n                    selectInputSource={this.selectInputSource}\n                    editInputDialog={this.state.editInputDialog}\n                    triggerEditInputDialog={this.triggerEditInputDialog}\n                    handleInputChanges={this.handleInputChanges}\n                    handleAddTable={this.handleAddTable}\n                    addTable={this.state.addTable}\n                    triggerAddTable={this.triggerAddTable}\n                    hideInputDialog={this.hideInputDialog}\n                    deleteDatabaseTable={this.deleteDatabaseTable}\n                    handleSnackbarClose={this.handleEditWorkflowSnackbarClose}\n                  />\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n            </Paper>\n          </Box>\n                  \n\n          <Box mt={4} display={(this.props.workflow.workflowType.match(/^(ERL|multiTenantWebERL)/)) ? 'block' : 'none'}>\n            <Paper variant=\"outlined\">\n              <ExpansionPanel disabled={this.state.missingInput} expanded={this.state.transformExpanded} onChange={(event, expanded) => this.transformExpansion(event, expanded)}>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Processing/Transformation Settings</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <WorkflowRedactionRules\n                    workflow={this.props.workflow}\n                    allDatabaseTables={this.state.allDatabaseTables}\n                    maskingRuleValues={this.state.maskingRuleValues}\n                    handleRuleChange={this.handleRuleChange}\n                    deleteMaskingRule={this.deleteMaskingRule}\n                    numMaskingRules={this.state.numMaskingRules}\n                    maskingRules={this.state.maskingRules}\n                    addMaskingRule={this.addMaskingRule}\n                  />\n\n                  <WorkflowSchedule\n                    handleExportSchedule={this.handleExportSchedule}\n                    exportSchedule={this.state.exportSchedule}\n                    schedule={this.state.schedule || '* 0 * * *'}\n                    handleSchedule={this.handleSchedule}\n                    scheduleSelection={this.state.scheduleSelection}\n                    customSchedule={this.state.customSchedule}\n                    workflowType={this.props.workflow.workflowType}\n                    errors={this.state.errors}\n                  />\n\n                  {/* <WorkflowCompliance\n                    generateSoftDeleteQueries={this.state.generateSoftDeleteQueries}\n                    handleSoftDeletionFields={this.handleSoftDeletionFields}\n                    handleSoftDeleteEmailAddressField={this.handleSoftDeleteEmailAddressField}\n                    maskingRuleValues={this.state.maskingRuleValues}\n                    userSearchEmailField={this.state.userSearchEmailField}\n                    allDatabaseTables={this.state.allDatabaseTables}\n                    userSearchEmailDBTable={this.state.userSearchEmailDBTable}\n                    userSearchEmailColumn={this.state.userSearchEmailColumn}\n                    workflowType={this.props.workflow.workflowType}\n                  /> */}\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n            </Paper>\n          </Box>\n\n          <Box mt={4} display={(this.props.workflow.workflowType.match(/^(ERL|multiTenantWebERL)/)) ? 'block' : 'none'}>\n            <Paper variant=\"outlined\">\n              <ExpansionPanel disabled={(this.state.allDatabaseTables && this.state.allDatabaseTables.length) ? false : true} expanded={this.state.outputExpanded} onChange={(event, expanded) => this.outputExpansion(event, expanded)}>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Output Settings</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <WorkflowExport\n                    workflow={this.props.workflow}\n                    showOutputOptions={this.state.showOutputOptions}\n                    hideOutputOptions={this.hideOutputOptions}\n                    triggerOutputOptions={this.triggerOutputOptions}\n                    currentDatabaseTable={this.state.currentDatabaseTable}\n                    allDatabaseTables={this.state.allDatabaseTables}\n                    tableOutputOptions={this.state.tableOutputOptions}\n                    handleTableOutputChanges={this.handleTableOutputChanges}\n                    addExportTableColumn={this.addExportTableColumn}\n                    deleteExportTableColumn={this.deleteExportTableColumn}\n                  />\n\n                  <WorkflowPostExport\n                    dataFeeds={this.state.dataFeeds}\n                    dataFeed={this.state.dataFeed}\n                    addParameterValue={this.addParameterValue}\n                    updateParameterValue={this.updateParameterValue}\n                    deleteParameterValue={this.deleteParameterValue}\n                    agents={this.props.agents}\n                    workflow={this.props.workflow}\n                    hideDataFeed={this.hideDataFeed}\n                    addDataFeed={this.addDataFeed}\n                    editDataFeed={this.state.editDataFeed}\n                    handleDataFeed={this.handleDataFeed}\n                    handleDataFeedBack={this.handleDataFeedBack}\n                    handleDataFeedCancel={this.handleDataFeedCancel}\n                    getS3UploadFileNames={this.getS3UploadFileNames}\n                    handleDataFeedOptions={this.handleDataFeedOptions}\n                    saveDataFeedChanges={this.saveDataFeedChanges}\n                    triggerEditDataFeed={this.triggerEditDataFeed}\n                    deleteDataFeed={this.deleteDataFeed}\n                    errors={this.state.errors}\n                    handleCustomSecret={this.handleCustomSecret}\n                    addSecret={this.addSecret}\n                    handleDeleteSecret={this.handleDeleteSecret}\n                    markAddToS3UploadList={this.markAddToS3UploadList}\n                    addAllToS3UploadList={this.addAllToS3UploadList}\n                    addAllS3Uploads={this.state.addAllS3Uploads}\n                    agentNamespace={this.state.agentNamespace}\n                  />\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n            </Paper>\n          </Box>\n\n          <Box mt={4} display={(this.props.workflow.workflowType === \"mockDatabaseMigration\") ? 'block' : 'none'}>\n            <Paper variant=\"outlined\">\n              <ExpansionPanel expanded={this.state.outputExpanded} onChange={(event, expanded) => this.outputExpansion(event, expanded)}>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>Setup Instructions</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails>\n                  <DatabaseMigrationSetup\n                    workflow={this.props.workflow}\n                    handleWFChanges={this.props.handleWFChanges}\n                    inputs={this.state.inputs}\n                    agentNamespace={this.state.agentNamespace || \"default\"}\n                    clipboardCopy={this.clipboardCopy}\n                  />\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n            </Paper>\n          </Box>\n\n          <Grid\n            container\n            justify=\"space-between\"\n            alignItems=\"center\"\n            mt={12}\n          >\n            <Grid item xs={10}>\n              <Button variant=\"contained\" color=\"primary\" size=\"large\" disabled={this.state.saveButtonDisabled} onClick={() => this.saveChanges(this.props.workflow.uuid)}>\n                <SaveIcon />&nbsp;\n                {(this.props.workflow.workflowType === \"multiTenantWebERL\") ? 'Save and Run Workflow' : 'Save Changes'}\n              </Button>\n            </Grid>\n            <Grid item>\n              <Button variant=\"contained\" color=\"default\" size=\"small\" onClick={this.deleteWorkflowConfirmation}>\n                <DeleteIcon />&nbsp;\n                Delete Workflow\n              </Button>\n            </Grid>\n\n            <Dialog\n              open={this.state.deleteWorkflowConfirmation}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Delete Workflow</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  Are you sure you want to delete this workflow configuration?\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button onClick={this.cancelWorkflowConfirmation}>\n                    Cancel\n                  </Button>\n                  <Button color=\"primary\" onClick={() => this.props.deleteWorkflow(this.props.workflow.uuid)}>\n                    Yes, delete\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.orphanedWorkflow}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  Workflow <b>{this.props.workflow.name}</b> is not associated with a Redactics Agent. Please correct this by selecting an agent in your workflow configuration.\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.columnExclusionProhibited}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  <p>This workflow includes a <b>Push Data to your Internal Data Repository</b> data feed configuration. This data feed creates a (PII free) clone (or digital twin) of its original database whereby this clone's schema is intended to be identical to the original. Your Table Data Options specifies that one or more tables should have certain columns excluded. By allowing this configuration, this clone will contain incomplete data.</p>\n\n                  <p>To correct this problem, either remove this data feed, or update your table data options so that each table exports all columns.</p>\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={!this.state.completeRedactRules}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  One or more of your redaction rules contains a blank value or invalid column name (field names must contain only letters, numbers and underscores and most start with a letter or underscore)\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.dupeRedactRuleFound}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  One or more of your redaction rules contains a duplicate table and column name\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.dupeTableExportFound}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  You&apos;ve already selected this table/column for export\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.missingSchemaSelection}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  You must provide some table names for schema export\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.missingPostExportHookField}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  You must provide valid custom data feed container info\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.missingSecretField}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  You must provide details about your secrets/environment variables\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.invalidOutputSettingField}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  One or more \"created\" or \"updated\" field settings are missing or contain illegal characters\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.invalidForgetUserFields}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  Your Forget User Request \"Database and Table Name\" or \"Email Field\" are either missing or contain an invalid field name (field names must contain only letters, numbers and underscores and most start with a letter or underscore).\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.invalidMigrationFields}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  Your Setup Instructions fields are missing one or more values.\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={!this.state.validSchedule}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  <p>\n                    Your custom schedule is invalid. Please abide by the standard crontab format:\n                  </p>\n\n                  <p>\n                    <b>\n                      [minute](0-59)[hour](0-23)\n                      [day of the month](1-31)\n                      [month](1-12)\n                      [day of the week](0-6)\n                    </b>\n                  </p>\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={!this.state.validName}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  You must provide a workflow name\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={!this.state.validDiskSize}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Error</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  You must provide a disk space allocation for your input source\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button color=\"primary\" onClick={this.hideErrorDialog}>\n                    Okay\n                  </Button>\n                </DialogActions>\n              </DialogContent>\n            </Dialog>\n\n            <Dialog\n              open={this.state.showDialog}\n              aria-labelledby=\"dialog-title\"\n              aria-describedby=\"dialog-description\"\n            >\n              <DialogTitle id=\"dialog-title\">Your changes have been saved!</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"dialog-description\">\n                  <Box>\n                    However, your workflow will not work until you update your Helm configuration file,&nbsp;\n                    which can be found in the <b>Agents</b> section.\n                  </Box>\n                </DialogContentText>\n\n                <DialogActions>\n                  <Button onClick={this.hideHelmReminder} color=\"primary\" autoFocus>\n                    Okay\n                  </Button>\n                </DialogActions>\n\n              </DialogContent>\n            </Dialog>\n\n            <Snackbar\n              anchorOrigin={{\n                vertical: 'top',\n                horizontal: 'right',\n              }}\n              open={this.state.showSnackbar}\n              autoHideDuration={8000}\n              onClose={this.handleSnackbarClose}\n              ContentProps={{\n                'aria-describedby': 'message-id',\n              }}\n              message={<span id=\"message-id\"><b>Your changes have been saved!</b></span>}\n              action={[\n                <IconButton\n                  key=\"close\"\n                  aria-label=\"Close\"\n                  color=\"inherit\"\n                  onClick={this.handleSnackbarClose}\n                >\n                  <CloseIcon />\n                </IconButton>,\n              ]}\n            />\n\n            <Snackbar\n              anchorOrigin={{\n                vertical: 'top',\n                horizontal: 'right',\n              }}\n              open={this.state.showSnackbarEdit}\n              autoHideDuration={8000}\n              onClose={this.handleSnackbarClose}\n              ContentProps={{\n                'aria-describedby': 'message-id',\n              }}\n              message={<span id=\"message-id\">Click on &quot;Save Changes&quot; at the bottom of this section to save your changes...</span>}\n              action={[\n                <IconButton\n                  key=\"close\"\n                  aria-label=\"Close\"\n                  color=\"inherit\"\n                  onClick={this.handleSnackbarClose}\n                >\n                  <CloseIcon />\n                </IconButton>\n              ]}\n            />\n          </Grid>\n\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nexport default withStyles(styles)(Workflow);\n","/Users/joe/www/redactics-osedition/react/src/pages/settings/DefaultReplacement.tsx",["268"],"import React from 'react';\nimport styled from 'styled-components';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  FormControl as MuiFormControl,\n  Typography,\n  TextField as MuiTextField,\n  Box,\n} from '@material-ui/core';\n\nimport { spacing } from '@material-ui/system';\n\nimport { RedactRuleDefault } from '../../types/redactics';\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n  ruleDefaults: RedactRuleDefault;\n  handleReplacementChange: any;\n}\n\ninterface IState {}\n\nclass DefaultReplacement extends React.Component<IProps, IState> {\n  render() {\n    return (\n      <React.Fragment>\n\n        <Typography variant=\"body1\" gutterBottom>\n          Replace data with a provided value\n        </Typography>\n\n        <form noValidate autoComplete=\"off\">\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              name=\"replacement\"\n              label=\"Replacement Text\"\n              value={this.props.ruleDefaults.redactData.replacement}\n              onChange={this.props.handleReplacementChange}\n            />\n          </FormControl>\n\n          <Box mt={4}>\n            <Typography variant=\"body1\" gutterBottom>\n              <b>Sample Output</b>\n            </Typography>\n\n            <Typography variant=\"h6\" gutterBottom>\n              <code>{this.props.ruleDefaults.redactData.replacement}</code>\n            </Typography>\n\n          </Box>\n        </form>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default DefaultReplacement;\n","/Users/joe/www/redactics-osedition/react/src/pages/settings/DefaultRandomString.tsx",["269"],"import React from 'react';\nimport styled from 'styled-components';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  FormControl as MuiFormControl,\n  Typography,\n  TextField as MuiTextField,\n  Box,\n} from '@material-ui/core';\n\nimport { spacing } from '@material-ui/system';\n\nimport { RedactRuleDefault } from '../../types/redactics';\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n  ruleDefaults: RedactRuleDefault;\n  handleRandomStringChange: any;\n}\n\ninterface IState {}\n\nclass DefaultRandomString extends React.Component<IProps, IState> {\n  static generateRandom(length:number) {\n    let result = '';\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    for (let i = length; i > 0; i -= 1) result += chars[Math.floor(Math.random() * chars.length)];\n    return result;\n  }\n\n  render() {\n    const chars:number = this.props.ruleDefaults.redactData.chars as number || 24;\n    return (\n      <React.Fragment>\n\n        <Typography variant=\"body1\" gutterBottom>\n          Replace data with a random alphanumeric string of a provided length\n        </Typography>\n\n        <form noValidate autoComplete=\"off\">\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              name=\"randomString\"\n              label=\"Random String Character Length\"\n              value={this.props.ruleDefaults.redactData.chars}\n              type=\"number\"\n              onChange={this.props.handleRandomStringChange}\n            />\n          </FormControl>\n\n          <Box mt={4}>\n            <Typography variant=\"body1\" gutterBottom>\n              <b>Sample Output</b>\n            </Typography>\n\n            <Typography variant=\"h6\" gutterBottom>\n              <code>\n                {DefaultRandomString.generateRandom(chars)}\n              </code>\n            </Typography>\n\n          </Box>\n        </form>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default DefaultRandomString;\n","/Users/joe/www/redactics-osedition/react/src/pages/settings/DefaultRedactEmail.tsx",["270"],"import React from 'react';\nimport styled from 'styled-components';\n\n// import { red, green, blue } from \"@material-ui/core/colors\";\n\nimport {\n  FormControl as MuiFormControl,\n  Typography,\n  TextField as MuiTextField,\n  Box,\n} from '@material-ui/core';\n\nimport { spacing } from '@material-ui/system';\n\nimport { RedactRuleDefault } from '../../types/redactics';\n\nconst FormControl = styled(MuiFormControl)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 300px;\n`;\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n  ruleDefaults: RedactRuleDefault;\n  handleRedactEmailChange: any;\n}\n\ninterface IState {}\n\nclass DefaultRedactEmail extends React.Component<IProps, IState> {\n  /* eslint-disable max-len */\n\n  render() {\n    return (\n      <React.Fragment>\n\n        <Typography variant=\"body1\" gutterBottom>\n          Transform emails to unique email address derived from the row&apos;s primary key, constructed based on provided prefix and domain - i.e. <code>[prefix][primarykey]@[domain]</code>\n        </Typography>\n\n        <form noValidate autoComplete=\"off\">\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              name=\"prefix\"\n              label=\"Prefix\"\n              value={this.props.ruleDefaults.redactData.prefix}\n              onChange={this.props.handleRedactEmailChange}\n            />\n          </FormControl>\n\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              name=\"primaryKey\"\n              label=\"Primary Key\"\n              value={this.props.ruleDefaults.redactData.primaryKey}\n              onChange={this.props.handleRedactEmailChange}\n            />\n          </FormControl>\n\n          <FormControl fullWidth margin=\"normal\" variant=\"outlined\">\n            <TextField\n              name=\"domain\"\n              label=\"Domain\"\n              value={this.props.ruleDefaults.redactData.domain}\n              onChange={this.props.handleRedactEmailChange}\n            />\n          </FormControl>\n\n          <Box mt={4}>\n            <Typography variant=\"body1\" gutterBottom>\n              <b>Sample Output</b>\n            </Typography>\n\n            <Typography variant=\"h6\" gutterBottom>\n              <code>{this.props.ruleDefaults.redactData.prefix}12345@{this.props.ruleDefaults.redactData.domain}</code>\n            </Typography>\n\n          </Box>\n        </form>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default DefaultRedactEmail;\n","/Users/joe/www/redactics-osedition/react/src/pages/workflows/DatabaseMigrationSetup.tsx",["271"],"import React from 'react';\nimport styled from 'styled-components';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport { spacing } from '@material-ui/system';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\n\nimport {\n  TextField as MuiTextField,\n  FormControl as MuiFormControl,\n  Button,\n  Box,\n  Link,\n  Select,\n  MenuItem,\n  Tooltip,\n  InputAdornment,\n  InputLabel,\n  Paper,\n  ExpansionPanel,\n  ExpansionPanelDetails as MuiExpansionPanelDetails,\n  ExpansionPanelSummary,\n  Typography,\n} from '@material-ui/core';\n\nimport {\n  HelpOutline as HelpIcon,\n  ExpandMore as ExpandMoreIcon,\n} from '@material-ui/icons';\n\nimport {\n  Clipboard as ClipboardIcon,\n} from 'react-feather';\n\nimport { WorkflowRecord } from '../../types/redactics';\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 200px;\n  max-width: 200px;\n`;\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 200px;\n`;\n\nconst ExpansionPanelDetails = withStyles({\n  root: {\n    display: 'block',\n  },\n})(MuiExpansionPanelDetails);\n\nconst styles = {\n  selectAdornment: {\n    marginRight: '-30px',\n  },\n};\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n/* eslint-disable no-useless-escape */\n\ninterface IProps {\n  workflow: WorkflowRecord;\n  handleWFChanges: any;\n  classes: any;\n  inputs: any;\n  agentNamespace: string;\n  clipboardCopy: any;\n}\n\ninterface IState {\n\n}\n\nclass DatabaseMigrationSetup extends React.Component<IProps, IState> {\n  render() {\n    const helmHook = `\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: trigger-db-migration-mock-{{ .Release.Revision }}\n  namespace: ${this.props.workflow.migrationNamespace || \"default\"}\n  annotations:\n    \"helm.sh/hook\": pre-upgrade\n    \"helm.sh/hook-weight\": \"${this.props.workflow.migrationHelmHookWeight || \"0\"}\"\n    \"helm.sh/hook-delete-policy\": hook-succeeded\nspec:\n  template:\n    spec:\n      restartPolicy: Never\n      containers:\n        - name: trigger-db-migration-mock\n          image: redactics/airflow-dagrun-poller:1.1.0\n          imagePullPolicy: Always\n          args:\n          - bash\n          - -c\n          - |\n              DAG_RUN_ID=$(curl -s -X POST -d \"{\\\\\"workflowType\\\\\": \\\\\"mockDatabaseMigration\\\\\", \\\\\"workflowId\\\\\": \\\\\"\\${WORKFLOW_ID}\\\\\"}\" -H \"Content-Type: application/json\" -H \"Accept: application/json\" -H \"x-api-key: \\${REDACTICS_API_KEY}\" \\${REDACTICS_API_URL}/workflow/jobs | jq -r '.uuid')\n              curl -s -X POST -H \"Authorization: Basic \\${BASIC_AUTH}\" -H \"Content-Type: application/json\" -H \"Accept: application/json\" -d \"{\\\\\"dag_run_id\\\\\": \\\\\"\\${DAG_RUN_ID}\\\\\", \\\\\"conf\\\\\": {\\\\\"workflowJobId\\\\\": \\\\\"\\${DAG_RUN_ID}\\\\\"}}\" \\${API_URL}/api/v1/dags/\\${DAG_ID}/dagRuns\n              DAG_RUN_ID=\\${DAG_RUN_ID} /poller.sh\n              if [ $? -ne 0 ]; then\n                exit 1\n              fi\n          env:\n          - name: REDACTICS_API_URL\n            value: https://api.redactics.com\n          - name: API_URL\n            value: http://redactics-webserver.${this.props.agentNamespace}.svc.cluster.local:8080\n          - name: DAG_ID\n            value: ${this.props.workflow.uuid}-migrationmocking\n          - name: TAIL_TASK_ID\n            value: clone-db\n          - name: WORKFLOW_ID\n            value: ${this.props.workflow.uuid}\n          - name: REDACTICS_API_KEY\n            valueFrom:\n              secretKeyRef:\n                name: redactics\n                key: api-key\n          - name: BASIC_AUTH\n            valueFrom:\n              secretKeyRef:\n                name: redactics\n                key: basic-auth\n    `\n    const script = `\n#!/bin/bash\n\n# change values as necessary, this script will work when running inside a Kubernetes container, and when the\n# variables REDACTICS_API_KEY and BASIC_AUTH are set outside of this script from values stored as Kubernetes secrets.\n# The open source libraries \"curl\" and \"jq\" must be available within this environment, in addition to the poller.sh script.\n\nexport REDACTICS_API_URL=https://api.redactics.com\nexport API_URL=http://redactics-webserver.${this.props.agentNamespace}.svc.cluster.local:8080\nexport DAG_ID=${this.props.workflow.uuid}-migrationmocking\nexport TAIL_TASK_ID=clone-db\nexport WORKFLOW_ID=${this.props.workflow.uuid}\nexport POLLER_PATH=/poller.sh\n\nDAG_RUN_ID=$(curl -s -X POST -d \"{\\\\\"workflowType\\\\\": \\\\\"mockDatabaseMigration\\\\\", \\\\\"workflowId\\\\\": \\\\\"\\${WORKFLOW_ID}\\\\\"}\" -H \"Content-Type: application/json\" -H \"Accept: application/json\" -H \"x-api-key: \\${REDACTICS_API_KEY}\" \\${REDACTICS_API_URL}/workflow/jobs | jq -r '.uuid')\ncurl -s -X POST -H \"Authorization: Basic \\${BASIC_AUTH}\" -H \"Content-Type: application/json\" -H \"Accept: application/json\" -d \"{\\\\\"dag_run_id\\\\\": \\\\\"\\${DAG_RUN_ID}\\\\\", \\\\\"conf\\\\\": { \\\\\"workflowJobId\\\\\": \\\\\"\\${DAG_RUN_ID}\\\\\"}}\" \\${API_URL}/api/v1/dags/\\${DAG_ID}/dagRuns\nDAG_RUN_ID=\\${DAG_RUN_ID} \\${POLLER_PATH}\n    `\n    \n    return (\n      <React.Fragment>\n        <Box>\n          Performing a dry run of your migrations requires your adding a step to your CI/CD pipeline (or manual process) to trigger a workflow installed in the Redactics Agent. This workflow clones your database to prepare for your database migration dry-run against this clone. Once this step is complete you can then run your migration using an environment variable to override your database that would normally be used with your cloned database.\n        </Box>\n\n        <Box mt={4}>\n          One way to put together a complete working flow is to add some sort of flag in your CI/CD workflow that triggers this alteration to your normal workflow when a database migration dry-run option is selected, followed by the database migration against the clone. This can be done by triggering a script that runs on your server hosting your app, or if your database migration is triggered via a Helmchart hook, adding an additional hook that runs before your normal migration hook.\n        </Box>\n\n        <Box mt={4}>\n          Using the values you provide here, we will generate the code needed to perform this middle step which you can customize this as needed. We will also generate a secret containing your Redactics API key (used to show progress in <Link href=\"/workflows/jobs\">Workflows -&gt; Jobs</Link> as well as report issues to the notification bell icon in the upper right of this page), and an authentication token for the REST API embedded into the Redactics Agent. These secrets will be installed into your Kubernetes namespace (as you've provided below) the next time you upgrade your Redactics Agent software.\n        </Box>\n\n        <Box mt={8}>\n          <FormControl fullWidth>\n            <TextField\n              //error={this.props.errors.migrationNamespace}\n              name=\"migrationNamespace\"\n              label=\"Kubernetes Namespace\"\n              value={this.props.workflow.migrationNamespace}\n              onChange={(event) => this.props.handleWFChanges(event, this.props.workflow.uuid)}\n              InputProps={{ endAdornment: <InputAdornment className={this.props.classes.selectAdornment} position=\"end\"><Tooltip title=\"Kubernetes namespace where your database migrations run\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n            />\n          </FormControl>\n        </Box>\n\n        <Box mt={4}>\n          <FormControl fullWidth>\n            <TextField\n              //error={this.props.errors.migrationDatabase}\n              name=\"migrationDatabase\"\n              label=\"Database Name\"\n              value={this.props.workflow.migrationDatabase}\n              onChange={(event) => this.props.handleWFChanges(event, this.props.workflow.uuid)}\n              InputProps={{ endAdornment: <InputAdornment className={this.props.classes.selectAdornment} position=\"end\"><Tooltip title=\"Database name of database that should be cloned\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n            />\n          </FormControl>\n        </Box>\n\n        <Box mt={4}>\n          <FormControl fullWidth>\n            <TextField\n              //error={this.props.errors.migrationDatabaseClone}\n              name=\"migrationDatabaseClone\"\n              label=\"Cloned Database Name\"\n              value={this.props.workflow.migrationDatabaseClone}\n              onChange={(event) => this.props.handleWFChanges(event, this.props.workflow.uuid)}\n              InputProps={{ endAdornment: <InputAdornment className={this.props.classes.selectAdornment} position=\"end\"><Tooltip title=\"Database name for your clone\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n            />\n          </FormControl>\n        </Box>\n\n        <Box mt={4}>\n          <FormControl fullWidth>\n            <InputLabel htmlFor=\"agent\">Generate Configuration For</InputLabel>\n            <Select\n              //error={this.props.errors.migrationConfiguration}\n              name=\"migrationConfiguration\"\n              value={this.props.workflow.migrationConfiguration}\n              onChange={(event) => this.props.handleWFChanges(event, this.props.workflow.uuid)}\n            >\n              <MenuItem key=\"helmhook\" value=\"helmhook\">Sample Helmchart Hook</MenuItem>\n              <MenuItem key=\"script\" value=\"script\">Sample Script</MenuItem>\n            </Select>\n          </FormControl>\n        </Box>\n\n        <Box mt={4} display={(this.props.workflow.migrationConfiguration === \"helmhook\") ? \"block\" : \"none\"}>\n          <FormControl fullWidth>\n            <TextField\n              //error={this.props.errors.migrationDatabaseClone}\n              name=\"migrationHelmHookWeight\"\n              type=\"number\"\n              label=\"Helmchart Hook Weight\"\n              value={this.props.workflow.migrationHelmHookWeight || \"0\"}\n              onChange={(event) => this.props.handleWFChanges(event, this.props.workflow.uuid)}\n              InputProps={{ endAdornment: <InputAdornment className={this.props.classes.selectAdornment} position=\"end\"><Tooltip title=\"Helmchart hook weight (hooks are executed in ascending order)\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n            />\n          </FormControl>\n        </Box>\n\n        <Box mt={8} display={(this.props.workflow.migrationConfiguration === \"helmhook\") ? \"block\" : \"none\"}>\n          <Paper variant=\"outlined\">\n            <ExpansionPanel>\n              <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Sample Helmchart Hook</Typography>\n              </ExpansionPanelSummary>\n              <ExpansionPanelDetails>\n                <Box>\n                  <CopyToClipboard text={helmHook} onCopy={() => this.props.clipboardCopy(\"sampleMigrationHook\")}>\n                    <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n                  </CopyToClipboard>\n                </Box>\n                <Box mt={2}>\n                  <pre style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-all' }}>\n                    {helmHook}\n                  </pre>\n                </Box>\n              </ExpansionPanelDetails>\n            </ExpansionPanel>\n          </Paper>\n        </Box>\n\n        <Box mt={8} display={(this.props.workflow.migrationConfiguration === \"script\") ? \"block\" : \"none\"}>\n          <Paper variant=\"outlined\">\n            <ExpansionPanel>\n              <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                <Typography>Sample Script</Typography>\n              </ExpansionPanelSummary>\n              <ExpansionPanelDetails>\n                <Box>\n                  <CopyToClipboard text={script} onCopy={() => this.props.clipboardCopy(\"sampleMigrationScript\")}>\n                    <Button variant=\"outlined\" size=\"small\" color=\"secondary\"><ClipboardIcon /></Button>\n                  </CopyToClipboard>\n                </Box>\n                <Box mt={2}>\n                  <pre style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-all' }}>\n                    {script}\n                  </pre>\n                </Box>\n              </ExpansionPanelDetails>\n            </ExpansionPanel>\n          </Paper>\n        </Box>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default withStyles(styles)(DatabaseMigrationSetup);\n","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowPostExport.tsx",["272","273","274","275","276"],"import React from 'react';\nimport styled from 'styled-components';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport { spacing } from '@material-ui/system';\nimport { blue } from '@material-ui/core/colors';\n\nimport {\n  Grid as MuiGrid,\n  Typography,\n  TextField as MuiTextField,\n  FormControl as MuiFormControl,\n  Button as MuiButton,\n  Box,\n  Link,\n  Checkbox,\n  Tooltip,\n  InputAdornment,\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n  Paper as MuiPaper,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  ExpansionPanel,\n  ExpansionPanelSummary,\n  ExpansionPanelDetails as MuiExpansionPanelDetails,\n  List,\n  ListItem,\n  ListItemText,\n  Select,\n  InputLabel,\n  MenuItem,\n  FormControlLabel,\n} from '@material-ui/core';\n\nimport {\n  Add as AddIcon,\n  DeleteOutline as DeleteIcon,\n  Edit as EditIcon,\n  HelpOutline as HelpIcon,\n  ExpandMore as ExpandMoreIcon,\n  Info as InfoIcon,\n} from '@material-ui/icons';\n\nimport {\n  HardDrive as HardDriveIcon,\n  Code as CodeIcon,\n} from 'react-feather';\n\nimport { CustomSecret, DataFeed, AgentRecord, WorkflowRecord, PostUpdateParam } from '../../types/redactics';\n\nimport { Alert as MuiAlert } from '@material-ui/lab';\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 200px;\n  max-width: 200px;\n`;\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 200px;\n`;\n\nconst MedTextField = styled(TextFieldSpacing)`\n  width: 400px;\n`;\n\nconst WideTextField = styled(TextFieldSpacing)`\n  width: 600px;\n`;\n\nconst bold = {\n  fontWeight: \"bold\"\n};\n\nconst Alert = styled(MuiAlert)(spacing);\n\nconst ExpansionPanelDetails = withStyles({\n  root: {\n    display: 'block',\n  },\n})(MuiExpansionPanelDetails);\n\nconst NWTableCell = withStyles({\n  root: {\n    whiteSpace: 'nowrap',\n  },\n})(TableCell);\n\nconst Paper = styled(MuiPaper)(spacing);\n\nconst Button = styled(MuiButton)(spacing);\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n  handleDeleteSecret: any;\n  markAddToS3UploadList: any;\n  addAllToS3UploadList: any;\n  addAllS3Uploads: boolean;\n  agentNamespace?: string;\n  dataFeeds: DataFeed[];\n  dataFeed: DataFeed;\n  hideDataFeed: any;\n  addDataFeed: any;\n  editDataFeed: boolean;\n  addParameterValue: any;\n  updateParameterValue: any;\n  deleteParameterValue: any;\n  handleDataFeed: any;\n  handleDataFeedBack: any;\n  handleDataFeedCancel: any;\n  getS3UploadFileNames: any;\n  handleDataFeedOptions: any;\n  saveDataFeedChanges: any;\n  triggerEditDataFeed: any;\n  deleteDataFeed: any;\n  errors: any;\n  handleCustomSecret: any;\n  addSecret: any;\n  agents: AgentRecord[];\n  workflow: WorkflowRecord;\n}\n\ninterface IState {\n\n}\n\nclass WorkflowPostExport extends React.Component<IProps, IState> {\n  /* eslint-disable max-len */\n\n  databaseEngine(engine:string) {\n    let displayEngine:string = \"\";\n    switch (engine) {\n      case 'postgresql':\n        displayEngine = \"PostgreSQL\";\n      break;\n\n      default:\n      break;\n    }\n\n    return displayEngine;\n  }\n\n  dataFeedName(df:string) {\n    let dataFeed:string = \"\";\n    switch (df) {\n      case 'dataRepository':\n        dataFeed = \"Push Data to your Internal Data Repository\";\n      break;\n\n      case 'digitalTwin':\n        dataFeed = \"Create a PII-free Digital Twin/Clone\";\n      break;\n      \n      case 's3upload':\n        dataFeed = \"Upload/Sync Data to an Amazon S3 bucket\";\n      break;\n\n      case 'custom':\n        dataFeed = \"Custom Container/Plugin\";\n      break;\n\n      default:\n      break;\n    }\n\n    return dataFeed;\n  }\n\n  dataFeedSummary(df:any) {\n    let dataFeedSummary:string = \"\";\n    let uploadBucket:string = df.dataFeedConfig.S3UploadBucket;\n    if (df.dataFeedConfig.S3UploadBucket && !df.dataFeedConfig.S3UploadBucket.match(/^s3:\\/\\//)) {\n      uploadBucket = \"s3://\" + df.dataFeedConfig.S3UploadBucket;\n    }\n    switch (df.dataFeed) {\n      case 'dataRepository':\n      dataFeedSummary = \"Add datasets to your data repository (hosted at \" + uploadBucket + \")\";\n      break;\n\n      case 'digitalTwin':\n      dataFeedSummary = \"Data will be cloned to your \" + this.databaseEngine(df.dataFeedConfig.databaseEngine) + \" database and will be \";\n      dataFeedSummary += (df.dataFeedConfig.enableDeltaUpdates) ? \"updated with new data\" : \"reset to match the original data\";\n      if (df.dataFeedConfig.enablePostUpdatePreparedStatements) {\n        let preparedStatementValues:string[] = [];\n        df.dataFeedConfig.postUpdateKeyValues.forEach((kv:PostUpdateParam) => {\n          if (kv.key && kv.value) {\n            preparedStatementValues.push(kv.value);\n          }\n        })\n        if (preparedStatementValues.length) {\n          dataFeedSummary+= \". After each time the workflow runs your data will be modified with the following values: \" + preparedStatementValues.join(', ') + \".\";\n        }\n      }\n      break;\n      \n      case 's3upload':\n      dataFeedSummary = \"Upload \";\n      dataFeedSummary += (df.dataFeedConfig.uploadFileChecked.length === this.props.getS3UploadFileNames().length)\n        ? \"all\" : df.dataFeedConfig.uploadFileChecked.length;\n      dataFeedSummary += (df.dataFeedConfig.uploadFileChecked.length === 1) ? \" table\" : \" tables\";\n      dataFeedSummary += \" to \" + uploadBucket;\n      break;\n\n      case 'custom':\n      dataFeedSummary = \"Invoke custom container \" + df.dataFeedConfig.image + \":\" + df.dataFeedConfig.tag;\n      break;\n\n      default:\n      break;\n    }\n\n    return dataFeedSummary;\n  }\n\n  outputTable() {\n    if (this.props.dataFeeds && this.props.dataFeeds.length) {\n      return (\n        <Table>\n          <TableHead>\n            <TableRow>\n              <TableCell>Data Feed</TableCell>\n              <TableCell>Summary</TableCell>\n              <TableCell></TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {this.props.dataFeeds.map((df:DataFeed) => (\n              <TableRow key={df.uuid}>\n                <TableCell>{this.dataFeedName(df.dataFeed)}</TableCell>\n                <TableCell>{this.dataFeedSummary(df)}</TableCell>\n                <NWTableCell>\n                  <Button disabled={this.props.workflow.workflowType === \"multiTenantWebERL\"} variant=\"contained\" color=\"secondary\" size=\"small\" onClick={() => this.props.triggerEditDataFeed(df)}>\n                    <EditIcon/>&nbsp;Edit\n                  </Button>&nbsp;\n                  <Button disabled={this.props.workflow.workflowType === \"multiTenantWebERL\"} variant=\"contained\" color=\"default\" size=\"small\" onClick={() => this.props.deleteDataFeed(df)}>\n                    <DeleteIcon />&nbsp;Delete\n                  </Button>\n                </NWTableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      )\n    }\n    else {\n      return (\n        <Box>\n          Click on <b>Add Data Feed</b> to define your first data feed.\n        </Box>\n      )\n    }\n  }\n\n  showErrors() {\n    if (this.props.errors.duplicateDataFeed) {\n      return (\n        <Alert mb={4} severity=\"error\">You can only create one of each type of Data Feed</Alert>\n      )\n    }\n    else if (this.props.errors.invalidBucketName) {\n      return (\n        <Alert mb={4} severity=\"error\">Invalid Amazon S3 bucket name. <Link target=\"_blank\" href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucketnamingrules.html\">Naming guidelines</Link></Alert>\n      )\n    }\n    else if (this.props.errors.invalidPostUpdateKeyValues) {\n      return (\n        <Alert mb={4} severity=\"error\">Invalid parameter key or value. Parameters must not be empty and must not contain %, (, or ) characters</Alert>\n      )\n    }\n    else if (this.props.errors.invalidSecret) {\n      return (\n        <Alert mb={4} severity=\"error\">One or more of your secrets is missing a value - all fields are required</Alert>\n      )\n    }\n    return null;\n  }\n\n  getAgent() {\n    const agent = this.props.agents.filter((a:AgentRecord) => (\n      (a.uuid === this.props.workflow.agentId)));\n    // set stub result if method is called before data has been populated,\n    // there should always be an agent found\n    return (agent.length) ? agent[0] : {\n      configPath: '',\n      namespace: '',\n    };\n  }\n\n  disabledAlert(workflowType:string) {\n    return (workflowType === \"multiTenantWebERL\") ? (\n      <Box mt={4}>\n        <InfoIcon style={{ color: blue[500], fontSize: 25 }} /> <b>Definable Data Feeds are not supported with web-based workflows.</b>\n      </Box>\n    ) : null;\n  }\n\n  render() {\n    const namespaceTip = this.props.dataFeed.feedSecrets.length ? (\n      <p>\n        Be sure that any secrets that need to be attached to your post-processing Docker container exist in this same Kubernetes namespace.\n      </p>\n    ) : '';\n\n    return (\n      <React.Fragment>\n        <Box mt={8}>\n          <Typography variant=\"h4\" gutterBottom>\n            Data Feeds\n          </Typography>\n\n          <Dialog\n            open={this.props.editDataFeed}\n            onClose={this.props.hideDataFeed}\n            fullWidth\n            maxWidth=\"md\"\n            aria-labelledby=\"dialog-title\"\n            aria-describedby=\"dialog-description\"\n          >\n            <DialogTitle id=\"dialog-title\">{(!this.props.dataFeed.uuid.match(/^new/)) ? \"Edit\" : \"Add\"} Data Feed</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"dialog-description\">\n                {this.showErrors()}\n\n                <Box display={(this.props.dataFeed.dataFeed === '') ? 'block' : 'none'}>\n                  {this.disabledAlert(this.props.workflow.workflowType)}\n                  <List component=\"nav\" aria-label=\"data feed selection\">\n                    <ListItem disabled={!(this.props.workflow.workflowType === \"ERL\")} button onClick={() => this.props.handleDataFeed('dataRepository')}>\n                      <ListItemText\n                        primary=\"Push Data to your Internal Data Repository\"\n                        primaryTypographyProps={{ style: bold }}\n                        secondary=\"Uploads your PII-free datasets to an Amazon S3 bucket, and reports the dataset to your Data Repository page. The Data Repositories page includes instructions to automate the download and installation of these data sets. This approach makes developer testing against production data easy, and is an effective alternative to creating and maintaining developer seed data.\" \n                      />\n                    </ListItem>\n\n                    <ListItem disabled={!(this.props.workflow.workflowType === \"ERL\")} button onClick={() => this.props.handleDataFeed('digitalTwin')}>\n                      <ListItemText\n                        primary=\"Create a PII-free Digital Twin/Clone\"\n                        primaryTypographyProps={{ style: bold }}\n                        secondary=\"Creates a PII-free clone of your data to a target/output database. Any data written in the target tables is replaced by the data from your source/input.\" \n                      />\n                    </ListItem>\n\n                    <ListItem disabled={!(this.props.workflow.workflowType === \"ERL\")} button onClick={() => this.props.handleDataFeed('s3upload')}>\n                      <ListItemText\n                        primary=\"Upload/Sync Data to an Amazon S3 Bucket\"\n                        primaryTypographyProps={{ style: bold }}\n                        secondary=\"Upload your table data CSV files to an Amazon S3 bucket.\" \n                      />\n                    </ListItem>\n\n                    <ListItem disabled={!(this.props.workflow.workflowType === \"ERL\")} button onClick={() => this.props.handleDataFeed('custom')}>\n                      <ListItemText\n                        primary=\"Configure a Custom Container/Plugin\"\n                        primaryTypographyProps={{ style: bold }}\n                        secondary=\"Trigger your own custom container to carry out work of your choosing.\" \n                      />\n                    </ListItem>\n                  </List>\n                </Box>\n\n                <Box mt={8} display={(this.props.dataFeed.dataFeed === 'dataRepository') ? 'block' : 'none'}>\n                  <Typography variant=\"h4\" gutterBottom>\n                    Data Repository Options\n                  </Typography>\n\n                  <Box mt={8}>\n                    <FormControl fullWidth variant=\"outlined\">\n                      <MedTextField\n                        name=\"S3UploadBucket\"\n                        error={this.props.errors.invalidBucketName}\n                        onChange={(event) => this.props.handleDataFeedOptions(event)}\n                        value={this.props.dataFeed.dataFeedConfig.S3UploadBucket}\n                        label=\"S3 Bucket\"\n                        InputProps={{\n                          startAdornment: <InputAdornment position=\"start\"><b>S3://</b></InputAdornment>,\n                        }}\n                      />\n                    </FormControl>\n                  </Box>\n\n                  <Box mt={8}>\n                    <Paper variant=\"outlined\">\n                      <ExpansionPanel>\n                        <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                          <Typography>Plugin Requirements</Typography>\n                        </ExpansionPanelSummary>\n                        <ExpansionPanelDetails>\n                          <p>\n                            This plugin requires an AWS access key ID and secret access key pair to authenticate to the provided bucket. Create an AWS credentials file in the style of the <code>~/.aws/credentials</code> example provided <Link href=\"https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html\" target=\"_blank\">here</Link> and run the following command to create a secret in your Kubernetes cluster namespace as the contents of this file:\n                          </p>\n                          <p>\n                            <code>\n                              kubectl create secret generic aws -n {this.props.agentNamespace || 'unknown_namespace'} --from-file=/path/to/aws/credentials\n                            </code>\n                          </p>\n                        </ExpansionPanelDetails>\n                      </ExpansionPanel>\n                    </Paper>\n                  </Box>\n                </Box>\n\n                <Box mt={8} display={(this.props.dataFeed.dataFeed === 'digitalTwin') ? 'block' : 'none'}>\n                  <Typography variant=\"h4\" gutterBottom>\n                    Digital Twin Options\n                  </Typography>\n\n                  <p>Adding this data feed will require updating your Agent configuration file (provided within the <Link href=\"/agents\" target=\"_blank\">Agents</Link> page), replacing the \"changeme\"s for connection ID <code>{this.props.dataFeed.uuid}</code> with the specified connection info for this input source.</p>\n\n                  <Box mt={4}>\n                    <FormControl margin=\"dense\" fullWidth>\n                      <InputLabel>\n                        Input Source\n                      </InputLabel>\n                      <Select\n                        error={this.props.errors.databaseEngine}\n                        value={this.props.dataFeed.dataFeedConfig.databaseEngine}\n                        name=\"databaseEngine\"\n                        onChange={(event) => this.props.handleDataFeedOptions(event)}\n                      >\n                        <MenuItem key=\"postgresql\" value=\"postgresql\">PostgreSQL</MenuItem>\n                      </Select>\n                    </FormControl>\n                  </Box>\n                 \n                  <Box mt={4}>\n                    <FormControlLabel\n                      control={\n                        <Checkbox\n                          checked={this.props.dataFeed.dataFeedConfig.enableSSL}\n                          onChange={(event) => this.props.handleDataFeedOptions(event)}\n                          name=\"enableSSL\"\n                          color=\"primary\"\n                        />\n                      }\n                      label=\"Database Connectivity Should Be TLS/SSL Encrypted\"\n                    />\n                  </Box>\n\n                  <Box mt={4} display={(this.props.dataFeed.uuid.match(/^new/) && this.props.dataFeed.dataFeedConfig.enableSSL) ? 'block' : 'none'}>\n                    Once this data feed has been saved (and assigned an ID), edit this input to find TLS/SSL encryption setup instructions\n                  </Box>\n\n                  <Box mt={4} display={(!this.props.dataFeed.uuid.match(/^new/) && this.props.dataFeed.dataFeedConfig.enableSSL) ? 'block' : 'none'}>\n                    <Paper variant=\"outlined\">\n                      <ExpansionPanel>\n                        <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                          <Typography>TLS/SSL Encryption Setup Instructions</Typography>\n                        </ExpansionPanelSummary>\n                        <ExpansionPanelDetails>\n                          Enabling TLS/SSL encryption requires having an engineer perform the following four steps. These steps (even upon completion) will remain available here for reference:\n\n                          <ol>\n                            <li>Figure out what <code>sslmode</code> option is required by your database host/provider. Possibilities include <code>allow, prefer, require, verify-ca, verify-full</code> (<Link href=\"https://www.postgresql.org/docs/12/libpq-ssl.html\" target=\"_blank\">more info</Link>). Also figure out whether your database requires presenting only the root CA certificate, or the root CA as well as client cert and key files. Download these required files - we&apos;ll need them for step 3.</li>\n                            <li>Update your Helm configuration file (i.e. <code>{this.getAgent().configPath}</code>) and add the following in the block (respecting proper indentation level) that includes <code>id: {this.props.dataFeed.uuid}</code>. Take out the <code>sslcert</code> and <code>sslkey</code> params if your server doesn&apos;t require these, and you can adjust the <code>sslmode</code> value as necessary:<br/><br/>\n                              <code>\n                                enableSSL: true<br/>\n                                extra: &apos;&#123;&quot;sslmode&quot;:&quot;verify-ca&quot;, &quot;sslrootcert&quot;:&quot;/pgcerts/{this.props.dataFeed.uuid}/sslrootcert&quot;, &quot;sslcert&quot;: &quot;/pgcerts/{this.props.dataFeed.uuid}/sslcert&quot;, &quot;sslkey&quot;: &quot;/pgcerts/{this.props.dataFeed.uuid}/sslkey&quot;&#125;&apos;\n                              </code><br/><br/>\n                              If, for whatever reason, you&apos;d like to disable this TLS/SSL connectivity you can simply comment out these two lines by entering a hash (i.e. <code>#</code>) character before each line.\n                            </li>\n                            <li>Create a Kubernetes secret containing the certificates required by your database. Adjust the file paths, and take out the <code>sslcert</code> and <code>sslkey</code> params if your server doesn&apos;t require these:<br/><br/>\n                              <code>\n                                kubectl create secret -n {this.getAgent().namespace} generic pgcert-{this.props.dataFeed.uuid} --from-file=sslrootcert=/path/to/server-ca.pem --from-file=sslcert=/path/to/client-cert.pem  --from-file=sslkey=/path/to/client-key.pem\n                              </code>\n                            </li>\n                            <li>Visit the Agent page and reapply the provided configuration to your cluster, which will update all agent database connections to use the updated configuration you&apos;ve provided in your Helm configuration file.</li>\n                          </ol>\n                        </ExpansionPanelDetails>\n                      </ExpansionPanel>\n                    </Paper>\n                  </Box>\n\n                  <Box mt={4}>\n                    <FormControlLabel\n                      control={\n                        <Checkbox\n                          checked={this.props.dataFeed.dataFeedConfig.enableDeltaUpdates}\n                          onChange={(event) => this.props.handleDataFeedOptions(event)}\n                          name=\"enableDeltaUpdates\"\n                          color=\"primary\"\n                        />\n                      }\n                      label=\"Enable Delta Updates\"\n                    />\n                    <Box>\n                      After your initial job has run your workflow performance can be increased substantially by only transferring changed data, rather than recreating tables from scratch. Leave this disabled to hard-reset your data each time your workflow runs.\n                    </Box>\n                  </Box>\n\n                  <Box mt={4} display={(this.props.dataFeed.dataFeedConfig.enableDeltaUpdates) ? 'block' : 'none'}>\n                    <FormControl fullWidth>\n                      <TextField \n                        name=\"deltaUpdateField\"\n                        value={this.props.dataFeed.dataFeedConfig.deltaUpdateField}\n                        onChange={(event) => this.props.handleDataFeedOptions(event)}\n                        label=\"Updated Date Field Name\"\n                        InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Field name in your table that contains the timestamp tracking the last updated date, e.g. &quot;updated_at&quot;\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                      />\n                    </FormControl>\n                  </Box>\n\n                  <Box mt={4}>\n                    <FormControlLabel\n                      control={\n                        <Checkbox\n                          checked={this.props.dataFeed.dataFeedConfig.enablePostUpdatePreparedStatements}\n                          onChange={(event) => this.props.handleDataFeedOptions(event)}\n                          name=\"enablePostUpdatePreparedStatements\"\n                          color=\"primary\"\n                        />\n                      }\n                      label=\"Enable Custom Data Updates\"\n                    />\n                    <Box>\n                      Run custom SQL commands after your workflows run to make custom updates to your data. One use case for this is personalizing demos (e.g. to specify the name and logo of the company you are demoing to). To do so, you'll need to define a prepared SQL statement (i.e. an SQL command supporting parameters), as well as the values for these parameters.\n                    </Box>\n\n                    <Box mt={4} display={(this.props.dataFeed.dataFeedConfig.enablePostUpdatePreparedStatements) ? 'block' : 'none'}>\n                      <Box>\n                        As an example, in <code>UPDATE company SET name=%(company_name)s, logo=%(logo)s WHERE source_primary_key=%(company_id)s</code>, the three parameters in this prepared SQL statement are <code>company_name</code>, <code>logo</code>, and <code>company_id</code>. See below for the instructions for defining your prepared statements, and click on the <b>Add Parameter Value</b> button below these instructions to define the key/value pairs for each parameter in your prepared statement(s). For example, for the company_name parameter your parameter key would be <code>company_name</code>, and your parameter value: <code>Company we are demoing to</code>.\n                      </Box>\n\n                      <Box mt={4}>\n                        <Paper variant=\"outlined\">\n                          <ExpansionPanel>\n                            <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                              <Typography>Prepared Statement Setup Instructions</Typography>\n                            </ExpansionPanelSummary>\n                            <ExpansionPanelDetails>\n                              <Box>\n                                Prepared statements are SQL commands saved as Kubernetes secrets. Here is an example prepared statement: <code>UPDATE company SET name=%(name)s, logo=%(logo)s WHERE source_primary_key=%(company_id)s</code>. In this example <code>name</code>, <code>logo</code> and <code>company_id</code> are placeholder parameters requiring values, which you'll set below. Parameter key/value pairs are required rather than entire SQL commands for security reasons, and to make it easy for anybody in your company to change these values without running the risk of corrupting your data. To create this secret as per this example:<br/><br/>\n                                <code>kubectl create secret -n {this.getAgent().namespace} generic digital-twin --from-literal=prepared-statements=\"UPDATE company SET name=%(name)s, logo=%(logo)s WHERE source_primary_key=%(company_id)s;\"</code><br/><br/>\n                                Create your own prepared statements by replacing what is quoted here.<br/><br/>Multiple SQL commands are supported, separated by semicolons, and please note that the format of <code>%(your_variable)s</code> is required for all variable types (including non-strings) - the correct type will be automatically cast. All paraemters require that a value is provided.\n                              </Box>\n                            </ExpansionPanelDetails>\n                          </ExpansionPanel>\n                        </Paper>\n                      </Box>\n\n                      <Box mt={4}>\n                        <Table size=\"small\" style={{ width: 'auto' }}>\n                          <TableBody>\n                            {this.props.dataFeed.dataFeedConfig.postUpdateKeyValues.map((kv:PostUpdateParam, idx:number) => (\n                              <TableRow key={idx}>\n                                <TableCell style={{ paddingLeft: 0 }}>\n                                  <FormControl>\n                                    <TextField\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      name=\"parameterKey\"\n                                      value={kv.key}\n                                      onChange={(event) => this.props.updateParameterValue(idx, event)}\n                                      label=\"Parameter Key\"\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <FormControl>\n                                    <TextField\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      name=\"parameterValue\"\n                                      value={kv.value}\n                                      onChange={(event) => this.props.updateParameterValue(idx, event)}\n                                      label=\"Parameter Value\"\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={() => this.props.deleteParameterValue(idx)}>\n                                    <DeleteIcon />\n                                  </Button>\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                        <Box mt={4}>\n                          <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.props.addParameterValue}>\n                            <AddIcon />&nbsp;&nbsp;Add Parameter Value\n                          </Button>\n                        </Box>\n                      </Box>\n                    </Box>\n                  </Box>\n                </Box>\n\n                <Box mt={8} display={(this.props.dataFeed.dataFeed === 's3upload') ? 'block' : 'none'}>\n                  <Typography variant=\"h4\" gutterBottom>\n                    Amazon S3 File Upload Options\n                  </Typography>\n\n                  <Box mt={8}>\n                    <Typography variant=\"h6\" gutterBottom>\n                      Data Files to Upload\n                    </Typography>\n\n                    <Grid container>\n                      <Grid item xs={8}>\n                        <Box mt={8}>\n                          <Paper variant=\"outlined\">\n                            <Box mt={4}>\n                              <Table>\n                                <TableHead>\n                                  <TableRow>\n                                    <TableCell><Checkbox onClick={this.props.addAllToS3UploadList} checked={this.props.dataFeed.dataFeedConfig.addAllS3Uploads} /> Add All Files</TableCell>\n                                    <TableCell align=\"left\">File</TableCell>\n                                  </TableRow>\n                                </TableHead>\n                                <TableBody>\n                                {this.props.getS3UploadFileNames().map((f:string) => (\n                                  <TableRow key={f}>\n                                    <TableCell component=\"th\" scope=\"row\">\n                                      <Checkbox onClick={(event) => this.props.markAddToS3UploadList(event, f)} checked={!!(this.props.dataFeed.dataFeedConfig.uploadFileChecked && \n                                        this.props.dataFeed.dataFeedConfig.uploadFileChecked.includes(f))} />\n                                    </TableCell>\n                                    <TableCell align=\"left\">{f}</TableCell>\n                                  </TableRow>\n                                ))}\n                                </TableBody>\n                              </Table>\n                            </Box>\n                          </Paper>\n                        </Box>\n                      </Grid>\n                    </Grid>\n                  </Box>\n\n                  <Box mt={8}>\n                    <FormControl fullWidth variant=\"outlined\">\n                      <MedTextField\n                        name=\"S3UploadBucket\"\n                        error={this.props.errors.invalidBucketName}\n                        onChange={(event) => this.props.handleDataFeedOptions(event)}\n                        value={this.props.dataFeed.dataFeedConfig.S3UploadBucket}\n                        label=\"S3 Bucket\"\n                        InputProps={{\n                          startAdornment: <InputAdornment position=\"start\"><b>S3://</b></InputAdornment>,\n                        }}\n                      />\n                    </FormControl>\n                  </Box>\n                  \n                  <Box mt={8}>\n                    <Paper variant=\"outlined\">\n                      <ExpansionPanel>\n                        <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                          <Typography>Plugin Requirements</Typography>\n                        </ExpansionPanelSummary>\n                        <ExpansionPanelDetails>\n                          <p>\n                            This plugin requires an AWS access key ID and secret access key pair to authenticate to the provided bucket. Create an AWS credentials file in the style of the <code>~/.aws/credentials</code> example provided <Link href=\"https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html\" target=\"_blank\">here</Link> and run the following command to create a secret in your Kubernetes cluster namespace as the contents of this file:\n                          </p>\n                          <p>\n                            <code>\n                              kubectl create secret generic aws -n {this.props.agentNamespace || 'unknown_namespace'} --from-file=/path/to/aws/credentials\n                            </code>\n                          </p>\n                        </ExpansionPanelDetails>\n                      </ExpansionPanel>\n                    </Paper>\n                  </Box>\n                  \n                </Box>\n\n                <Box mt={8} display={(this.props.dataFeed.dataFeed === 'custom') ? 'block' : 'none'}>\n                  <Box>\n                    <Typography variant=\"h4\" gutterBottom>\n                      Custom Container/Plugin Configuration\n                    </Typography>\n\n                    <p>The filenames that will be exported are as follows: <b>{this.props.getS3UploadFileNames().join(', ')}</b>. Some documentation for developing your own custom container/plugin can be found on the <Link href=\"/developers\" target=\"_blank\">developers page</Link>.\n                    </p>\n                  </Box>\n\n                  <Box mt={4}>\n                    <MedTextField\n                      name=\"image\"\n                      error={this.props.errors.image}\n                      value={this.props.dataFeed.dataFeedConfig.image}\n                      onChange={(event) => this.props.handleDataFeedOptions(event)}\n                      label=\"Docker Image\"\n                      placeholder=\"amazon/aws-cli\"\n                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Docker image URL (Dockerhub example: 'amazon/aws-cli')\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                    />\n                  </Box>\n                  <Box mt={4}>\n                    <MedTextField\n                      name=\"tag\"\n                      error={this.props.errors.tag}\n                      value={this.props.dataFeed.dataFeedConfig.tag}\n                      onChange={(event) => this.props.handleDataFeedOptions(event)}\n                      label=\"Docker Image Tag\"\n                      placeholder=\"latest\"\n                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Image tag/version (e.g. 'latest', '5.0.0')\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                    />\n                  </Box>\n                  <Box mt={4}>\n                    <MedTextField\n                      name=\"shell\"\n                      error={this.props.errors.shell}\n                      value={this.props.dataFeed.dataFeedConfig.shell}\n                      onChange={(event) => this.props.handleDataFeedOptions(event)}\n                      label=\"Shell Path\"\n                      placeholder=\"/bin/bash\"\n                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Custom container commands will be prefaced with this shell path, i.e. <shell path> -c '<command>' '<args>'\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                    />\n                  </Box>\n                  <Box mt={4}>\n                    <WideTextField\n                      name=\"command\"\n                      multiline\n                      rowsMax=\"4\"\n                      value={this.props.dataFeed.dataFeedConfig.command}\n                      onChange={(event) => this.props.handleDataFeedOptions(event)}\n                      label=\"Command (optional)\"\n                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Optional command to override container default, in Docker this field name is 'entrypoint'.\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                    />\n                  </Box>\n\n                  <Box mt={4}>\n                    <WideTextField\n                      name=\"args\"\n                      multiline\n                      rowsMax=\"4\"\n                      value={this.props.dataFeed.dataFeedConfig.args}\n                      onChange={(event) => this.props.handleDataFeedOptions(event)}\n                      label=\"Args (optional)\"\n                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Optional command to override container default, in Docker this field name is 'cmd'.\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                    />\n                  </Box>\n\n                  <Button variant=\"contained\" color=\"secondary\" mt={4} size=\"small\" onClick={() => { this.props.addSecret('volume'); }}>\n                    <HardDriveIcon />&nbsp;\n                    Attach Secret Disk/Volume to Container\n                  </Button>&nbsp;<Button variant=\"contained\" color=\"secondary\" mt={4} size=\"small\" onClick={() => { this.props.addSecret('env'); }}>\n                    <CodeIcon />&nbsp;\n                    Attach Environment Variable to Container\n                  </Button>\n\n                  <Box mt={8}>\n                    {namespaceTip}\n                    <Table size=\"small\" style={{ width: 'auto' }}>\n                      <TableBody>\n                        {this.props.dataFeed.feedSecrets.map((secret:CustomSecret, idx:number) => {\n                          if (secret.secretType === 'volume') {\n                            return (\n                              <TableRow key={idx}>\n                                <TableCell style={{ paddingLeft: 0 }}>\n                                  <HardDriveIcon />\n                                </TableCell>\n                                <TableCell>\n                                  <FormControl fullWidth>\n                                    <TextField\n                                      name=\"secretName\"\n                                      value={secret.secretName}\n                                      label=\"Secret Name\"\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      onChange={(event) => this.props.handleCustomSecret(event, idx)}\n                                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Kubernetes secret name as it appears in 'kubectl get secrets'\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <FormControl fullWidth>\n                                    <TextField\n                                      name=\"secretKey\"\n                                      value={secret.secretKey}\n                                      label=\"Secret Key\"\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      onChange={(event) => this.props.handleCustomSecret(event, idx)}\n                                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Kubernetes secret key contained within this secret\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <FormControl fullWidth>\n                                    <TextField\n                                      name=\"secretPath\"\n                                      value={secret.secretPath}\n                                      label=\"Secret Container Path\"\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      onChange={(event) => this.props.handleCustomSecret(event, idx)}\n                                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Path to mount this secret within your container\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <Button variant=\"contained\" size=\"small\" color=\"secondary\" onClick={() => this.props.handleDeleteSecret(idx)}>\n                                    <DeleteIcon />&nbsp;&nbsp;Delete\n                                  </Button>\n                                </TableCell>\n                              </TableRow>\n                            );\n                          }\n                          if (secret.secretType === 'env') {\n                            return (\n                              <TableRow>\n                                <TableCell style={{ paddingLeft: 0 }}>\n                                  <CodeIcon />\n                                </TableCell>\n                                <TableCell>\n                                  <FormControl fullWidth>\n                                    <TextField\n                                      name=\"secretName\"\n                                      value={secret.secretName}\n                                      label=\"Secret Name\"\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      onChange={(event) => this.props.handleCustomSecret(event, idx)}\n                                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Kubernetes secret name as it appears in 'kubectl get secrets'\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <FormControl fullWidth>\n                                    <TextField\n                                      name=\"secretKey\"\n                                      value={secret.secretKey}\n                                      label=\"Secret Key\"\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      onChange={(event) => this.props.handleCustomSecret(event, idx)}\n                                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Kubernetes secret key contained within this secret\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <FormControl fullWidth>\n                                    <TextField\n                                      name=\"envName\"\n                                      value={secret.envName}\n                                      label=\"Variable Name\"\n                                      variant=\"outlined\"\n                                      margin=\"dense\"\n                                      onChange={(event) => this.props.handleCustomSecret(event, idx)}\n                                      InputProps={{ endAdornment: <InputAdornment position=\"end\"><Tooltip title=\"Environment variable name to be presented to this container, often in all caps\" placement=\"right-start\"><HelpIcon /></Tooltip></InputAdornment> }}\n                                    />\n                                  </FormControl>\n                                </TableCell>\n                                <TableCell>\n                                  <Button variant=\"contained\" size=\"small\" color=\"secondary\" onClick={() => this.props.handleDeleteSecret(idx)}>\n                                    <DeleteIcon />&nbsp;&nbsp;Delete\n                                  </Button>\n                                </TableCell>\n                              </TableRow>\n                            );\n                          }\n\n                          return null;\n                        })}\n                      </TableBody>\n                    </Table>\n                  </Box>\n              </Box>\n              </DialogContentText>\n\n              <DialogActions>\n                <Box display={(this.props.dataFeed.dataFeed !== '') ? 'block' : 'none'}>\n                  <Button\n                    color=\"default\"\n                    variant=\"contained\"\n                    onClick={this.props.handleDataFeedBack}\n                  >\n                    Back\n                  </Button>&nbsp;\n                  <Button\n                    color=\"secondary\"\n                    variant=\"contained\"\n                    onClick={this.props.saveDataFeedChanges}\n                  >\n                    Update\n                  </Button>\n                </Box>\n                <Box display={(this.props.dataFeed.dataFeed === '') ? 'block' : 'none'}>\n                  <Button color=\"secondary\" onClick={this.props.handleDataFeedCancel}>\n                    Cancel\n                  </Button>\n                </Box>\n              </DialogActions>\n            </DialogContent>\n          </Dialog>\n\n          <Grid container>\n            <Grid item xs={8}>\n              <Typography variant=\"body1\" gutterBottom>\n                Data feeds provide several options for populating and/or syncing data with your No PII Zone on a recurring basis and sharing data with your internal and external stakeholders. With or without a data feed you can retrieve output files via the <code>Download Export</code> command provided by the <Link href=\"/developers\" target=\"_blank\">Redactics Agent CLI</Link>.\n              </Typography>\n            </Grid>\n          </Grid>\n\n          <Box mt={8}>\n            <Grid\n              justify=\"space-between\"\n              container\n              spacing={10}\n            >\n              <Grid item></Grid>\n              <Grid item mb={6}>\n                <div>\n                  <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.props.addDataFeed}>\n                    <AddIcon />&nbsp;\n                    Add Data Feed\n                  </Button>\n                </div>\n              </Grid>\n            </Grid>\n\n            {this.outputTable()}\n          </Box>\n        </Box>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default WorkflowPostExport;\n","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowSchedule.tsx",[],"/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowExport.tsx",["277"],"import React from 'react';\nimport styled from 'styled-components';\n\nimport { spacing } from '@material-ui/system';\nimport { blue } from '@material-ui/core/colors';\n\nimport {\n  Typography,\n  TextField as MuiTextField,\n  FormControl as MuiFormControl,\n  Button as MuiButton,\n  Box,\n  FormControlLabel,\n  Radio,\n  RadioGroup,\n  Chip,\n  Select,\n  MenuItem,\n  Tooltip,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Table,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableBody,\n} from '@material-ui/core';\n\nimport {\n  Add as AddIcon,\n  HelpOutline as HelpIcon,\n  Edit as EditIcon,\n  Info as InfoIcon,\n} from '@material-ui/icons';\n\nimport { WorkflowRecord } from '../../types/redactics';\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 200px;\n  max-width: 200px;\n  display: inline;\n`;\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 200px;\n`;\n\nconst Button = styled(MuiButton)(spacing);\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n  workflow: WorkflowRecord;\n  deleteExportTableColumn: any;\n  addExportTableColumn: any;\n  tableOutputOptions: any;\n  handleTableOutputChanges: any;\n  allDatabaseTables: string[];\n  showOutputOptions: any;\n  currentDatabaseTable: string;\n  triggerOutputOptions: any;\n  hideOutputOptions: any;\n}\n\ninterface IState {\n\n}\n\nclass WorkflowExport extends React.Component<IProps, IState> {\n  constructor(props:IProps) {\n    super(props);\n\n    this.displayColumnData = this.displayColumnData.bind(this);\n    this.displayRowsData = this.displayRowsData.bind(this);\n    this.genName = this.genName.bind(this);\n  }\n\n  displayColumnData() {\n    const table = this.props.currentDatabaseTable;\n    if (!this.props.tableOutputOptions[table]) { return; }\n\n    return (\n      <Box>\n         <RadioGroup aria-label=\"exportColumns\" name=\"exportColumns\" value={this.props.tableOutputOptions[table].exportColumns} onChange={(event) => this.props.handleTableOutputChanges(event, table)}>\n          <FormControlLabel value=\"all\" control={<Radio />} label=\"Export All Columns\" />\n          <FormControlLabel value=\"specific\" control={<Radio />} label=\"Export Specific Columns\" />\n        </RadioGroup>\n\n        <Box mt={4} display={(this.props.tableOutputOptions[table].exportColumns === \"specific\") ? 'block' : 'none'}>\n          {this.props.tableOutputOptions[table].fields.map((field: string) => (\n            <Box key={field} display=\"inline\" pr={1}>\n              <Chip\n                key={field}\n                label={field}\n                onDelete={(event) => this.props.deleteExportTableColumn(event, table, field)}\n              />\n            </Box>\n          ))}\n\n          <Box mt={2}>\n            <FormControl fullWidth>\n              <TextField\n                error={this.props.tableOutputOptions[table].errors.addColumn}\n                name=\"addColumn\"\n                label=\"Add Column\"\n                value={this.props.tableOutputOptions[table].addColumn}\n                onChange={(event) => this.props.handleTableOutputChanges(event, table)}\n              />\n            </FormControl>\n            <Box mt={2}>\n              <Button color=\"secondary\" variant=\"outlined\" onClick={(event) => this.props.addExportTableColumn(event, table)}>\n                <AddIcon />&nbsp;Add\n              </Button>\n            </Box>\n          </Box>\n        </Box>\n      </Box>\n    )\n  }\n\n  disabledAlert(workflowType:string) {\n    return (workflowType === \"multiTenantWebERL\") ? (\n      <Box mt={4}>\n        <InfoIcon style={{ color: blue[500], fontSize: 25 }} /> <b>Web-based workflows only support exporting all rows, and not rows from a specific time period.</b>\n      </Box>\n    ) : null;\n  }\n\n  displayRowsData() {\n    const table = this.props.currentDatabaseTable;\n    if (!this.props.tableOutputOptions[table]) { return; }\n\n    return (\n      <Box mt={4}>\n          {this.disabledAlert(this.props.workflow.workflowType)}\n         <RadioGroup aria-label=\"exportRows\" name=\"exportRows\" value={this.props.tableOutputOptions[table].exportRows} onChange={(event) => this.props.handleTableOutputChanges(event, table)}>\n          <FormControlLabel value=\"all\" control={<Radio />} label=\"All Rows\" />\n          <FormControlLabel disabled={!(this.props.workflow.workflowType === \"ERL\")} value=\"specific\" control={<Radio />} label=\"Rows From a Specific Time Period\" />\n        </RadioGroup>\n\n        <Box mt={4} display={(this.props.tableOutputOptions[table].exportRows === \"specific\") ? 'block' : 'none'}>\n          <FormControl>\n            <Select\n              name=\"sampleFields\"\n              value={this.props.tableOutputOptions[table].sampleFields}\n              onChange={(event) => this.props.handleTableOutputChanges(event, table)}\n            >\n              <MenuItem key=\"created\" value=\"created\">Created</MenuItem>\n              <MenuItem key=\"updated\" value=\"updated\">Updated</MenuItem>\n              <MenuItem key=\"createdAndUpdated\" value=\"createdAndUpdated\">Created or updated</MenuItem>\n            </Select>&nbsp;&nbsp;in the last&nbsp;&nbsp;\n            <Select\n              name=\"numDays\"\n              value={this.props.tableOutputOptions[table].numDays}\n              onChange={(event) => this.props.handleTableOutputChanges(event, table)}\n            >\n              <MenuItem key=\"1\" value=\"1\">day</MenuItem>\n              <MenuItem key=\"2\" value=\"2\">2 days</MenuItem>\n              <MenuItem key=\"3\" value=\"3\">3 days</MenuItem>\n              <MenuItem key=\"7\" value=\"7\">1 week</MenuItem>\n              <MenuItem key=\"14\" value=\"14\">2 weeks</MenuItem>\n              <MenuItem key=\"30\" value=\"30\">month</MenuItem>\n              <MenuItem key=\"60\" value=\"60\">2 months</MenuItem>\n              <MenuItem key=\"90\" value=\"90\">3 months</MenuItem>\n              <MenuItem key=\"180\" value=\"180\">6 months</MenuItem>\n              <MenuItem key=\"365\" value=\"365\">year</MenuItem>\n            </Select>\n          </FormControl>\n\n          <Box mt={4}>\n            <FormControl fullWidth variant=\"outlined\">\n              <TextField\n                error={this.props.tableOutputOptions[table].errors.createdAtField}\n                name=\"createdAtField\"\n                label=\"Created At Field Name\"\n                value={this.props.tableOutputOptions[table].createdAtField}\n                onChange={(event) => this.props.handleTableOutputChanges(event, table)}\n                InputProps={{\n                  endAdornment: <Tooltip title=\"(Required) field name in this table used for tracking created at timestamp\" placement=\"right-start\"><HelpIcon /></Tooltip>,\n                }}\n              />\n            </FormControl>\n          </Box>\n\n          <Box mt={4}>\n            <FormControl fullWidth variant=\"outlined\">\n              <TextField\n                error={this.props.tableOutputOptions[table].errors.updatedAtField}\n                name=\"updatedAtField\"\n                label=\"Updated At Field Name\"\n                value={this.props.tableOutputOptions[table].updatedAtField}\n                onChange={(event) => this.props.handleTableOutputChanges(event, table)}\n                InputProps={{\n                  endAdornment: <Tooltip title=\"(Required) field name in this table used for tracking updated at timestamp\" placement=\"right-start\"><HelpIcon /></Tooltip>,\n                }}\n              />\n            </FormControl>\n          </Box>\n        </Box>\n      </Box>\n    )\n  }\n\n  genName(dt:string) {\n    const display:string[] = [];\n    const tableArr:string[] = dt.split(': ');\n    const table:string = tableArr[(tableArr.length - 1)];\n    // let column:string = \"columns\";\n    // if (this.props.tableOutputOptions[table] && \n    //   this.props.tableOutputOptions[table].fields && \n    //   this.props.tableOutputOptions[table].fields.length === 1 &&\n    //   this.props.tableOutputOptions[table].exportColumns !== \"all\") {\n    //     column = \"column\";\n    // }\n    // display.push((this.props.tableOutputOptions[table] && \n    //   this.props.tableOutputOptions[table].fields && \n    //   this.props.tableOutputOptions[table].exportColumns !== \"all\") ? \n    //     this.props.tableOutputOptions[table].fields.length + \" \" + column + \",\" : \"all columns,\");\n    display.push((this.props.tableOutputOptions[table] && \n      this.props.tableOutputOptions[table].numDays && \n      this.props.tableOutputOptions[table].exportRows !== \"all\") ? \n        \"rows for the last \" + this.props.tableOutputOptions[table].numDays + \" days\" : \"all table rows\");\n    return display.join(' ');\n  }\n\n  render() {\n    if (!this.props.allDatabaseTables) {\n      return null;\n    }\n    return (\n      <React.Fragment>\n        <Box>\n          <Typography variant=\"h4\" gutterBottom>\n            Table Data Options\n          </Typography>\n\n          <Dialog\n            fullWidth\n            open={this.props.showOutputOptions}\n            onClose={this.props.hideOutputOptions}\n            maxWidth=\"md\"\n            aria-labelledby=\"dialog-title\"\n            aria-describedby=\"dialog-description\"\n          >\n            <DialogTitle id=\"dialog-title\">Table Options: {this.props.currentDatabaseTable}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"dialog-description\">\n                {/* <Box>\n                  <b>Columns</b>\n                </Box>\n\n                {this.displayColumnData()}\n\n                <Box mt={4}>\n                  <b>Rows</b>\n                </Box> */}\n\n                <Box>\n                  To limit the initial copy of your data to a specific time range, specify this time range below. This may be useful if older data is not particularly relevant to you and/or your output table is large.\n                </Box>\n\n                {this.displayRowsData()}\n              </DialogContentText>\n\n              <DialogActions>\n                <Button color=\"secondary\" variant=\"contained\" onClick={this.props.hideOutputOptions}>\n                  Update\n                </Button>\n              </DialogActions>\n            </DialogContent>\n          </Dialog>\n\n          <Box mt={8}>\n            <Table>\n              <TableHead>\n                <TableRow>\n                  <TableCell>Table</TableCell>\n                  <TableCell>Summary</TableCell>\n                  <TableCell></TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n              {this.props.allDatabaseTables.map((dt:string) => {\n                const tableArr:string[] = dt.split(': ');\n                const table:string = tableArr[(tableArr.length - 1)];\n                return (\n                  <TableRow key={table}>\n                    <TableCell>{table}</TableCell>\n                    <TableCell>{this.genName(dt)}</TableCell>\n                    <TableCell>\n                      <Button color=\"secondary\" size=\"small\" variant=\"contained\" onClick={(event) => this.props.triggerOutputOptions(event, table)}>\n                        <EditIcon />&nbsp;Edit\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                )\n              })}\n              </TableBody>\n            </Table>\n          </Box>\n        </Box>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default WorkflowExport;\n","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowInputs.tsx",["278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294"],"import React from 'react';\nimport styled from 'styled-components';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport { spacing } from '@material-ui/system';\nimport { blue } from '@material-ui/core/colors';\n\nimport {\n  Button as MuiButton,\n  TextField as MuiTextField,\n  Select as MuiSelect,\n  FormControl as MuiFormControl,\n  InputLabel,\n  MenuItem,\n  Box,\n  Link,\n  FormControlLabel,\n  Checkbox,\n  Tooltip,\n  InputAdornment,\n  Typography,\n  Table,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableBody,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Chip,\n  ExpansionPanel,\n  ExpansionPanelSummary,\n  ExpansionPanelDetails as MuiExpansionPanelDetails,\n  Grid as MuiGrid,\n  Paper,\n  RadioGroup,\n  Radio,\n} from '@material-ui/core';\n\nimport {\n  Add as AddIcon,\n  Edit as EditIcon,\n  HelpOutline as HelpIcon,\n  DeleteOutline as DeleteIcon,\n  ExpandMore as ExpandMoreIcon,\n  Info as InfoIcon,\n} from '@material-ui/icons';\n\nimport { AgentRecord, WorkflowRecord, AgentInputRecord, WorkflowInputRecord } from '../../types/redactics';\n\nconst Button = styled(MuiButton)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 200px;\n  max-width: 200px;\n`;\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 200px;\n`;\n\nconst NWTableCell = withStyles({\n  root: {\n    whiteSpace: 'nowrap',\n  },\n})(TableCell);\n\nconst Select = styled(MuiSelect)(spacing);\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst ExpansionPanelDetails = withStyles({\n  root: {\n    display: 'block',\n  },\n})(MuiExpansionPanelDetails);\n\nconst styles = {\n  selectAdornment: {\n    marginRight: '-30px',\n  },\n};\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\ninterface IProps {\n  agents: AgentRecord[];\n  errors?: any;\n  workflow: WorkflowRecord;\n  agentInputs: AgentInputRecord[];\n  classes: any;\n  editInputDialog: boolean;\n  triggerEditInputDialog: any;\n  saveInputChanges: any;\n  input: WorkflowInputRecord;\n  inputs: WorkflowInputRecord[];\n  handleInputChanges: any;\n  selectInputSource: any;\n  handleAddTable: any;\n  addTable: string;\n  triggerAddTable: any;\n  hideInputDialog: any;\n  deleteDatabaseTable: any;\n  handleSnackbarClose: any;\n}\n\ninterface IState {\n \n}\n\nclass WorkflowInputs extends React.Component<IProps, IState> {\n  getAgent() {\n    const agent = this.props.agents.filter((a:AgentRecord) => (\n      (a.uuid === this.props.workflow.agentId)));\n    // set stub result if method is called before data has been populated,\n    // there should always be an agent found\n    return (agent.length) ? agent[0] : {\n      configPath: '',\n      namespace: '',\n    };\n  }\n\n  editInputDialogContent() { \n    return (\n      <Box>\n        {this.props.errors.JSX}\n\n        <Box mt={8}>\n          <Typography variant=\"h4\" gutterBottom>\n            Tables to Extract\n          </Typography>\n\n          <Box>\n            {this.props.input.tables.map((table: string) => (\n              <Box key={table} display=\"inline\" pr={1}>\n                <Chip\n                  key={table}\n                  label={table}\n                  onDelete={() => this.props.deleteDatabaseTable(table)}\n                />\n              </Box>\n            ))}\n          </Box>\n\n          <Box mt={4}>\n            <FormControl fullWidth>\n              <TextField\n                error={this.props.errors.addTable}\n                name=\"addTable\"\n                label=\"Add Table\"\n                value={this.props.addTable}\n                onChange={(event) => this.props.handleAddTable(event)}\n              />\n            </FormControl>\n            <Box mt={2}>\n              <Button color=\"secondary\" variant=\"outlined\" onClick={this.props.triggerAddTable}>\n                <AddIcon />&nbsp;Add\n              </Button>\n            </Box>\n          </Box>\n\n        </Box>\n      </Box>\n    ) \n  }\n\n  outputInputs() {\n    if (this.props.inputs.length) {\n      if (this.props.workflow.workflowType === \"mockDatabaseMigration\") {\n        const selectedInput = (this.props.inputs && this.props.inputs.length && this.props.inputs[0]) ? this.props.inputs[0].uuid : \"\";\n        return (\n          <Box>\n            <FormControl margin=\"dense\" fullWidth>\n              <InputLabel>\n                Input Source\n              </InputLabel>\n              <Select\n                value={selectedInput}\n                name=\"inputSource\"\n                onChange={(event) => this.props.selectInputSource(event)}\n              >\n                {this.props.agentInputs.map((input:AgentInputRecord) => (\n                  <MenuItem key={input.uuid} value={input.uuid}>{input.inputName}</MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n          </Box>\n        )\n      }\n      else {\n        return (\n          <Box>\n            <Box mb={4} display={(this.props.workflow.workflowType === \"multiTenantWebERL\") ? \"block\" : \"none\"}>\n              <InfoIcon style={{ color: blue[500], fontSize: 25 }} /> <b>This workflow is constrained to a preset sample database containing two tables. CSV table data: <Link href=\"https://raw.githubusercontent.com/Redactics/redactics-sampledatasets/master/2020-olympic-athletes/athletes.csv\" target=\"_blank\">athletes.csv</Link>, <Link href=\"https://raw.githubusercontent.com/Redactics/redactics-sampledatasets/master/marketing-campaign/marketing_campaign.csv\" target=\"_blank\">marketing_campaign.csv</Link>.</b>\n            </Box>\n\n            <Table>\n              <TableHead>\n                <TableRow>\n                  <TableCell>Enabled</TableCell>\n                  <TableCell>Name</TableCell>\n                  <TableCell>Tables to Extract</TableCell>\n                  <TableCell></TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {this.props.agentInputs.map((input:AgentInputRecord) => {\n                  let workflowInput:any = this.props.inputs.find((i:WorkflowInputRecord) => {\n                    return (i.uuid === input.uuid)\n                  });\n                  let inputEnabled:boolean = (workflowInput) ? workflowInput.enabled : false;\n                  let tables:string = (workflowInput && workflowInput.tables && workflowInput.tables.length) ? workflowInput.tables.join(', ') : \"\";\n                  return (\n                    <TableRow key={input.uuid}>\n                      <TableCell>\n                        <Checkbox\n                          checked={inputEnabled}\n                          name=\"enabled\"\n                          color=\"primary\"\n                          onChange={(event) => this.props.handleInputChanges(event, workflowInput)}\n                        />\n                      </TableCell>\n                      <TableCell>{input.inputName}</TableCell>\n                      <TableCell>{tables}</TableCell>\n                      <NWTableCell>\n                        <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={() => this.props.triggerEditInputDialog(workflowInput)}>\n                          <EditIcon/>&nbsp;Edit Table Selection\n                        </Button>\n                      </NWTableCell>\n                    </TableRow>\n                  )\n                })}\n              </TableBody>\n            </Table>\n          </Box>\n        )\n      }\n    }\n    else {\n      return (\n        <Box>\n          Workflows require at least one input source. Click on <b>Add Input Source</b> to select an input source.\n        </Box>\n      )\n    }\n  }\n\n  /* eslint-disable max-len */\n\n  render() {\n    const title = (this.props.workflow.workflowType === \"mockDatabaseMigration\") ? \"Input Source\" : \"Input Sources\";\n    return (\n      <React.Fragment>\n        <Box mt={4}>\n          <Typography variant=\"h4\" gutterBottom>\n            {title}\n          </Typography>\n        </Box>\n\n        <Dialog\n          open={this.props.editInputDialog}\n          onClose={this.props.hideInputDialog}\n          maxWidth=\"md\"\n          aria-labelledby=\"dialog-title\"\n          aria-describedby=\"dialog-description\"\n          fullWidth\n        >\n          <DialogTitle id=\"dialog-title\">Edit Table Selection</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"dialog-description\">\n              {this.editInputDialogContent()}\n            </DialogContentText>\n\n            <DialogActions>\n              <Button color=\"secondary\" variant=\"contained\" onClick={this.props.saveInputChanges}>\n                Update\n              </Button>\n            </DialogActions>\n          </DialogContent>\n        </Dialog>\n\n        <Box mt={8}>\n          {this.outputInputs()}\n        </Box>\n       \n      </React.Fragment>\n    );\n  }\n}\n\nexport default withStyles(styles)(WorkflowInputs);\n","/Users/joe/www/redactics-osedition/react/src/pages/workflows/WorkflowRedactionRules.tsx",["295","296"],"import React from 'react';\nimport styled from 'styled-components';\n\nimport { spacing } from '@material-ui/system';\n\nimport {\n  Grid as MuiGrid,\n  Typography,\n  TextField as MuiTextField,\n  Select as MuiSelect,\n  FormControl as MuiFormControl,\n  Button as MuiButton,\n  InputLabel,\n  OutlinedInput,\n  MenuItem,\n  Box,\n  Table,\n  TableBody,\n  TableCell,\n  TableRow,\n} from '@material-ui/core';\n\nimport {\n  DeleteOutline as DeleteIcon,\n  Add as AddIcon,\n} from '@material-ui/icons';\n\nimport { RedactRule, WorkflowRecord } from '../../types/redactics';\n\nconst Grid = styled(MuiGrid)(spacing);\n\nconst TextFieldSpacing = styled(MuiTextField)(spacing);\n\nconst FormControlSpacing = styled(MuiFormControl)(spacing);\n\nconst FormControl = styled(FormControlSpacing)`\n  min-width: 200px;\n  max-width: 200px;\n`;\n\nconst TextField = styled(TextFieldSpacing)`\n  width: 200px;\n`;\n\nconst Select = styled(MuiSelect)(spacing);\n\nconst Button = styled(MuiButton)(spacing);\n\ninterface IProps {\n  workflow: WorkflowRecord;\n  maskingRuleValues: RedactRule[];\n  handleRuleChange: any;\n  deleteMaskingRule: any;\n  numMaskingRules: number;\n  maskingRules: RedactRule[];\n  addMaskingRule: any;\n  allDatabaseTables: string[];\n}\n\ninterface IState {\n  ruleLabelWidth: number;\n}\n\nclass WorkflowPostExport extends React.Component<IProps, IState> {\n  constructor(props: IProps) {\n    super(props);\n\n    this.state = {\n      ruleLabelWidth: 30,\n    };\n  }\n\n  displayMaskingRules() {\n    if (!this.props.numMaskingRules) {\n      return (\n        <Box>\n          <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.props.addMaskingRule}>\n            <AddIcon />&nbsp;&nbsp;Add Database Field Containing PII\n          </Button>\n        </Box>\n      )\n    }\n    else {\n      return (\n        <Table size=\"small\" style={{ width: 'auto' }}>\n          <TableBody>\n            {this.props.maskingRuleValues.map((row:RedactRule) => (\n              <TableRow key={row.key}>\n                <TableCell style={{ paddingLeft: 0 }}>\n                  <FormControl variant=\"outlined\" margin=\"dense\">\n                    <InputLabel>\n                      Database and Table Name\n                    </InputLabel>\n                    <Select\n                      value={row.databaseTable}\n                      onChange={(event) => this.props.handleRuleChange(row.key, event)}\n                      name=\"databaseTable\"\n                      input={\n                        <OutlinedInput\n                          labelWidth={this.state.ruleLabelWidth}\n                          name=\"rule\"\n                        />\n                      }\n                    >\n                      {this.props.allDatabaseTables.map((dt:string) => (\n                        <MenuItem key={dt} value={dt}>{dt}</MenuItem>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </TableCell>\n                <TableCell>\n                  <TextField name=\"column\" defaultValue={row.column} label=\"Column Name\" variant=\"outlined\" onChange={(event) => this.props.handleRuleChange(row.key, event)} margin=\"dense\" />\n                </TableCell>\n                <TableCell>\n                  <FormControl variant=\"outlined\" margin=\"dense\">\n                    <InputLabel>\n                      Rule\n                    </InputLabel>\n                    <Select\n                      value={row.rule}\n                      onChange={(event) => this.props.handleRuleChange(row.key, event)}\n                      name=\"rule\"\n                      input={\n                        <OutlinedInput\n                          labelWidth={this.state.ruleLabelWidth}\n                          name=\"rule\"\n                        />\n                      }\n                    >\n                      {this.props.maskingRules.map((rule:RedactRule) => (\n                        <MenuItem key={rule.key} value={rule.key}>{rule.val}</MenuItem>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </TableCell>\n                <TableCell>\n                  <Box>\n                    <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={() => this.props.deleteMaskingRule(row.key)}>\n                      <DeleteIcon />&nbsp;&nbsp;Delete\n                    </Button>\n                  </Box>\n                </TableCell>\n              </TableRow>\n            ))}\n            <TableRow>\n              <TableCell></TableCell>\n              <TableCell></TableCell>\n              <TableCell></TableCell>\n              <TableCell>\n                <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.props.addMaskingRule}>\n                  <AddIcon />&nbsp;&nbsp;Add\n                </Button>\n              </TableCell>\n            </TableRow>\n          </TableBody>\n        </Table>\n      )\n    }\n  }\n\n  /* eslint-disable max-len */\n\n  render() {\n    return (\n      <React.Fragment>\n        <Box mt={8}>\n          <Typography variant=\"h6\" gutterBottom>\n            Database Fields Containing PII/Confidential Info\n          </Typography>\n\n          <Box mb={4}>\n            <Grid container>\n              <Grid item xs={8}>\n                <Typography variant=\"body1\" gutterBottom>\n                  You can use the Redactics PII Scanner to auto-detect your database fields containing PII, or else define your fields containing PII (and their redaction rules) here.\n                </Typography>\n              </Grid>\n            </Grid>\n          </Box>\n\n          {this.displayMaskingRules()}\n        </Box>\n\n      </React.Fragment>\n    );\n  }\n}\n\nexport default WorkflowPostExport;\n","/Users/joe/www/redactics-osedition/react/src/theme/shadows.js",[],"/Users/joe/www/redactics-osedition/react/src/theme/props.js",[],"/Users/joe/www/redactics-osedition/react/src/theme/overrides.js",[],"/Users/joe/www/redactics-osedition/react/src/theme/typography.js",[],"/Users/joe/www/redactics-osedition/react/src/theme/variants.js",[],"/Users/joe/www/redactics-osedition/react/src/theme/breakpoints.js",[],{"ruleId":"297","replacedBy":"298"},{"ruleId":"299","replacedBy":"300"},{"ruleId":"301","replacedBy":"302"},{"ruleId":"303","severity":1,"message":"304","line":3,"column":43,"nodeType":"305","messageId":"306","endLine":3,"endColumn":51},{"ruleId":"303","severity":1,"message":"307","line":4,"column":17,"nodeType":"305","messageId":"306","endLine":4,"endColumn":31},{"ruleId":"303","severity":1,"message":"308","line":8,"column":13,"nodeType":"305","messageId":"306","endLine":8,"endColumn":23},{"ruleId":"303","severity":1,"message":"309","line":9,"column":14,"nodeType":"305","messageId":"306","endLine":9,"endColumn":25},{"ruleId":"310","severity":1,"message":"311","line":3,"column":10,"nodeType":"305","messageId":"306","endLine":3,"endColumn":20},{"ruleId":"297","replacedBy":"312"},{"ruleId":"299","replacedBy":"313"},{"ruleId":"301","replacedBy":"314"},{"ruleId":"310","severity":1,"message":"315","line":53,"column":3,"nodeType":"305","messageId":"306","endLine":53,"endColumn":15},{"ruleId":"310","severity":1,"message":"316","line":53,"column":17,"nodeType":"305","messageId":"306","endLine":53,"endColumn":30},{"ruleId":"310","severity":1,"message":"317","line":53,"column":32,"nodeType":"305","messageId":"306","endLine":53,"endColumn":48},{"ruleId":"310","severity":1,"message":"318","line":53,"column":50,"nodeType":"305","messageId":"306","endLine":53,"endColumn":66},{"ruleId":"310","severity":1,"message":"319","line":54,"column":3,"nodeType":"305","messageId":"306","endLine":54,"endColumn":20},{"ruleId":"297","replacedBy":"298"},{"ruleId":"299","replacedBy":"300"},{"ruleId":"301","replacedBy":"320"},{"ruleId":"310","severity":1,"message":"321","line":45,"column":3,"nodeType":"305","messageId":"306","endLine":45,"endColumn":17},{"ruleId":"310","severity":1,"message":"322","line":45,"column":19,"nodeType":"305","messageId":"306","endLine":45,"endColumn":35},{"ruleId":"310","severity":1,"message":"323","line":45,"column":37,"nodeType":"305","messageId":"306","endLine":45,"endColumn":48},{"ruleId":"310","severity":1,"message":"316","line":45,"column":50,"nodeType":"305","messageId":"306","endLine":45,"endColumn":63},{"ruleId":"310","severity":1,"message":"317","line":45,"column":65,"nodeType":"305","messageId":"306","endLine":45,"endColumn":81},{"ruleId":"310","severity":1,"message":"324","line":35,"column":3,"nodeType":"305","messageId":"306","endLine":35,"endColumn":14},{"ruleId":"310","severity":1,"message":"325","line":2,"column":18,"nodeType":"305","messageId":"306","endLine":2,"endColumn":27},{"ruleId":"310","severity":1,"message":"326","line":16,"column":3,"nodeType":"305","messageId":"306","endLine":16,"endColumn":7},{"ruleId":"310","severity":1,"message":"327","line":30,"column":3,"nodeType":"305","messageId":"306","endLine":30,"endColumn":8},{"ruleId":"310","severity":1,"message":"328","line":38,"column":3,"nodeType":"305","messageId":"306","endLine":38,"endColumn":17},{"ruleId":"310","severity":1,"message":"329","line":39,"column":3,"nodeType":"305","messageId":"306","endLine":39,"endColumn":24},{"ruleId":"310","severity":1,"message":"330","line":50,"column":17,"nodeType":"305","messageId":"306","endLine":50,"endColumn":31},{"ruleId":"310","severity":1,"message":"331","line":59,"column":3,"nodeType":"305","messageId":"306","endLine":59,"endColumn":14},{"ruleId":"310","severity":1,"message":"332","line":86,"column":7,"nodeType":"305","messageId":"306","endLine":86,"endColumn":28},{"ruleId":"310","severity":1,"message":"323","line":46,"column":10,"nodeType":"305","messageId":"306","endLine":46,"endColumn":21},{"ruleId":"310","severity":1,"message":"331","line":46,"column":23,"nodeType":"305","messageId":"306","endLine":46,"endColumn":34},{"ruleId":"310","severity":1,"message":"311","line":3,"column":10,"nodeType":"305","messageId":"306","endLine":3,"endColumn":20},{"ruleId":"310","severity":1,"message":"333","line":28,"column":10,"nodeType":"305","messageId":"306","endLine":28,"endColumn":32},{"ruleId":"310","severity":1,"message":"317","line":28,"column":34,"nodeType":"305","messageId":"306","endLine":28,"endColumn":50},{"ruleId":"310","severity":1,"message":"334","line":53,"column":10,"nodeType":"305","messageId":"306","endLine":53,"endColumn":24},{"ruleId":"310","severity":1,"message":"331","line":53,"column":26,"nodeType":"305","messageId":"306","endLine":53,"endColumn":37},{"ruleId":"310","severity":1,"message":"323","line":53,"column":39,"nodeType":"305","messageId":"306","endLine":53,"endColumn":50},{"ruleId":"310","severity":1,"message":"317","line":14,"column":10,"nodeType":"305","messageId":"306","endLine":14,"endColumn":26},{"ruleId":"310","severity":1,"message":"317","line":14,"column":10,"nodeType":"305","messageId":"306","endLine":14,"endColumn":26},{"ruleId":"310","severity":1,"message":"317","line":14,"column":10,"nodeType":"305","messageId":"306","endLine":14,"endColumn":26},{"ruleId":"310","severity":1,"message":"335","line":57,"column":3,"nodeType":"305","messageId":"306","endLine":57,"endColumn":13},{"ruleId":"310","severity":1,"message":"336","line":57,"column":15,"nodeType":"305","messageId":"306","endLine":57,"endColumn":27},{"ruleId":"310","severity":1,"message":"321","line":57,"column":29,"nodeType":"305","messageId":"306","endLine":57,"endColumn":43},{"ruleId":"310","severity":1,"message":"337","line":57,"column":45,"nodeType":"305","messageId":"306","endLine":57,"endColumn":59},{"ruleId":"310","severity":1,"message":"338","line":57,"column":61,"nodeType":"305","messageId":"306","endLine":57,"endColumn":76},{"ruleId":"310","severity":1,"message":"323","line":58,"column":3,"nodeType":"305","messageId":"306","endLine":58,"endColumn":14},{"ruleId":"310","severity":1,"message":"317","line":58,"column":16,"nodeType":"305","messageId":"306","endLine":58,"endColumn":32},{"ruleId":"310","severity":1,"message":"316","line":58,"column":34,"nodeType":"305","messageId":"306","endLine":58,"endColumn":47},{"ruleId":"310","severity":1,"message":"339","line":58,"column":49,"nodeType":"305","messageId":"306","endLine":58,"endColumn":57},{"ruleId":"310","severity":1,"message":"322","line":58,"column":59,"nodeType":"305","messageId":"306","endLine":58,"endColumn":75},{"ruleId":"310","severity":1,"message":"340","line":58,"column":77,"nodeType":"305","messageId":"306","endLine":58,"endColumn":96},{"ruleId":"310","severity":1,"message":"341","line":88,"column":7,"nodeType":"305","messageId":"306","endLine":88,"endColumn":12},{"ruleId":"310","severity":1,"message":"342","line":1275,"column":9,"nodeType":"305","messageId":"306","endLine":1275,"endColumn":28},{"ruleId":"310","severity":1,"message":"319","line":15,"column":10,"nodeType":"305","messageId":"306","endLine":15,"endColumn":27},{"ruleId":"310","severity":1,"message":"319","line":15,"column":10,"nodeType":"305","messageId":"306","endLine":15,"endColumn":27},{"ruleId":"310","severity":1,"message":"319","line":15,"column":10,"nodeType":"305","messageId":"306","endLine":15,"endColumn":27},{"ruleId":"310","severity":1,"message":"321","line":35,"column":10,"nodeType":"305","messageId":"306","endLine":35,"endColumn":24},{"ruleId":"310","severity":1,"message":"336","line":56,"column":10,"nodeType":"305","messageId":"306","endLine":56,"endColumn":22},{"ruleId":"310","severity":1,"message":"339","line":56,"column":24,"nodeType":"305","messageId":"306","endLine":56,"endColumn":32},{"ruleId":"310","severity":1,"message":"323","line":56,"column":34,"nodeType":"305","messageId":"306","endLine":56,"endColumn":45},{"ruleId":"310","severity":1,"message":"321","line":56,"column":47,"nodeType":"305","messageId":"306","endLine":56,"endColumn":61},{"ruleId":"310","severity":1,"message":"338","line":56,"column":63,"nodeType":"305","messageId":"306","endLine":56,"endColumn":78},{"ruleId":"310","severity":1,"message":"321","line":39,"column":10,"nodeType":"305","messageId":"306","endLine":39,"endColumn":24},{"ruleId":"310","severity":1,"message":"343","line":17,"column":3,"nodeType":"305","messageId":"306","endLine":17,"endColumn":19},{"ruleId":"310","severity":1,"message":"344","line":19,"column":3,"nodeType":"305","messageId":"306","endLine":19,"endColumn":10},{"ruleId":"310","severity":1,"message":"345","line":20,"column":3,"nodeType":"305","messageId":"306","endLine":20,"endColumn":17},{"ruleId":"310","severity":1,"message":"328","line":33,"column":3,"nodeType":"305","messageId":"306","endLine":33,"endColumn":17},{"ruleId":"310","severity":1,"message":"329","line":34,"column":3,"nodeType":"305","messageId":"306","endLine":34,"endColumn":24},{"ruleId":"310","severity":1,"message":"327","line":37,"column":3,"nodeType":"305","messageId":"306","endLine":37,"endColumn":8},{"ruleId":"310","severity":1,"message":"346","line":38,"column":3,"nodeType":"305","messageId":"306","endLine":38,"endColumn":13},{"ruleId":"310","severity":1,"message":"347","line":39,"column":3,"nodeType":"305","messageId":"306","endLine":39,"endColumn":8},{"ruleId":"310","severity":1,"message":"348","line":45,"column":18,"nodeType":"305","messageId":"306","endLine":45,"endColumn":26},{"ruleId":"310","severity":1,"message":"349","line":46,"column":20,"nodeType":"305","messageId":"306","endLine":46,"endColumn":30},{"ruleId":"310","severity":1,"message":"330","line":47,"column":17,"nodeType":"305","messageId":"306","endLine":47,"endColumn":31},{"ruleId":"310","severity":1,"message":"323","line":51,"column":10,"nodeType":"305","messageId":"306","endLine":51,"endColumn":21},{"ruleId":"310","severity":1,"message":"321","line":51,"column":23,"nodeType":"305","messageId":"306","endLine":51,"endColumn":37},{"ruleId":"310","severity":1,"message":"322","line":51,"column":39,"nodeType":"305","messageId":"306","endLine":51,"endColumn":55},{"ruleId":"310","severity":1,"message":"340","line":51,"column":57,"nodeType":"305","messageId":"306","endLine":51,"endColumn":76},{"ruleId":"310","severity":1,"message":"350","line":76,"column":7,"nodeType":"305","messageId":"306","endLine":76,"endColumn":11},{"ruleId":"310","severity":1,"message":"332","line":78,"column":7,"nodeType":"305","messageId":"306","endLine":78,"endColumn":28},{"ruleId":"310","severity":1,"message":"335","line":28,"column":10,"nodeType":"305","messageId":"306","endLine":28,"endColumn":20},{"ruleId":"310","severity":1,"message":"321","line":28,"column":22,"nodeType":"305","messageId":"306","endLine":28,"endColumn":36},"no-native-reassign",["351"],"no-negated-in-lhs",["352"],"jsx-a11y/accessible-emoji",[],"no-unused-vars","'Redirect' is defined but never used.","Identifier","unusedVar","'TrendingUpIcon' is defined but never used.","'SearchIcon' is defined but never used.","'ArchiveIcon' is defined but never used.","@typescript-eslint/no-unused-vars","'ContextObj' is defined but never used.",["351"],["352"],[],"'CompanyUsers' is defined but never used.","'RedactRuleSet' is defined but never used.","'RedactRulePreset' is defined but never used.","'RedactRuleConfig' is defined but never used.","'RedactRuleDefault' is defined but never used.",[],"'WorkflowRecord' is defined but never used.","'AgentInputRecord' is defined but never used.","'AgentRecord' is defined but never used.","'WorkflowJob' is defined but never used.","'withTheme' is defined but never used.","'Link' is defined but never used.","'Paper' is defined but never used.","'ExpansionPanel' is defined but never used.","'ExpansionPanelSummary' is defined but never used.","'ExpandMoreIcon' is defined but never used.","'InputRecord' is defined but never used.","'ExpansionPanelDetails' is assigned a value but never used.","'SettingsRedactRulesets' is defined but never used.","'HelmCmdHistory' is defined but never used.","'RedactRule' is defined but never used.","'CustomSecret' is defined but never used.","'WorkflowUpdate' is defined but never used.","'PostUpdateParam' is defined but never used.","'DataFeed' is defined but never used.","'WorkflowInputRecord' is defined but never used.","'Alert' is assigned a value but never used.","'errorsFound' is assigned a value but never used.","'FormControlLabel' is defined but never used.","'Tooltip' is defined but never used.","'InputAdornment' is defined but never used.","'RadioGroup' is defined but never used.","'Radio' is defined but never used.","'HelpIcon' is defined but never used.","'DeleteIcon' is defined but never used.","'Grid' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]