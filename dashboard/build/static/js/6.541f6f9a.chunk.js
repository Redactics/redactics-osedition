(this.webpackJsonpredactics=this.webpackJsonpredactics||[]).push([[6],{567:function(e,t,a){"use strict";var n=a(0),r=n.createContext({});t.a=r},574:function(e,t,a){"use strict";var n=a(577).CopyToClipboard;n.CopyToClipboard=n,e.exports=n},577:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToClipboard=void 0;var n=o(a(0)),r=o(a(578));function o(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?m(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var b=function(e){function t(){var e,a;i(this,t);for(var o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];return g(m(a=d(this,(e=p(t)).call.apply(e,[this].concat(l)))),"onClick",(function(e){var t=a.props,o=t.text,l=t.onCopy,s=t.children,c=t.options,i=n.default.Children.only(s),u=(0,r.default)(o,c);l&&l(o,u),i&&i.props&&"function"===typeof i.props.onClick&&i.props.onClick(e)})),a}var a,o,l;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),a=t,(o=[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),a=c(e,["text","onCopy","options","children"]),r=n.default.Children.only(t);return n.default.cloneElement(r,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(a,!0).forEach((function(t){g(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a,{onClick:this.onClick}))}}])&&u(a.prototype,o),l&&u(a,l),t}(n.default.PureComponent);t.CopyToClipboard=b,g(b,"defaultProps",{onCopy:void 0,options:void 0})},578:function(e,t,a){"use strict";var n=a(579),r={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var a,o,l,s,c,i,u=!1;t||(t={}),a=t.debug||!1;try{if(l=n(),s=document.createRange(),c=document.getSelection(),(i=document.createElement("span")).textContent=e,i.style.all="unset",i.style.position="fixed",i.style.top=0,i.style.clip="rect(0, 0, 0, 0)",i.style.whiteSpace="pre",i.style.webkitUserSelect="text",i.style.MozUserSelect="text",i.style.msUserSelect="text",i.style.userSelect="text",i.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),"undefined"===typeof n.clipboardData){a&&console.warn("unable to use e.clipboardData"),a&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var o=r[t.format]||r.default;window.clipboardData.setData(o,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(i),s.selectNodeContents(i),c.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(d){a&&console.error("unable to copy using execCommand: ",d),a&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(d){a&&console.error("unable to copy using clipboardData: ",d),a&&console.error("falling back to prompt"),o=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,e)}}finally{c&&("function"==typeof c.removeRange?c.removeRange(s):c.removeAllRanges()),i&&document.body.removeChild(i),l()}return u}},579:function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,a=[],n=0;n<e.rangeCount;n++)a.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||a.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},580:function(e,t,a){"use strict";var n=a(1),r=a(4),o=a(0),l=(a(3),a(5)),s=a(6),c=o.forwardRef((function(e,t){var a=e.classes,s=e.className,c=Object(r.a)(e,["classes","className"]);return o.createElement("div",Object(n.a)({className:Object(l.a)(a.root,s),ref:t},c))}));t.a=Object(s.a)({root:{display:"flex",padding:"8px 24px 24px"}},{name:"MuiExpansionPanelDetails"})(c)},581:function(e,t,a){"use strict";var n=a(1),r=a(4),o=a(0),l=(a(3),a(5)),s=a(193),c=a(528),i=a(6),u=a(567),d=o.forwardRef((function(e,t){var a=e.children,i=e.classes,d=e.className,p=e.expandIcon,m=e.IconButtonProps,h=e.onBlur,g=e.onClick,b=e.onFocusVisible,f=Object(r.a)(e,["children","classes","className","expandIcon","IconButtonProps","onBlur","onClick","onFocusVisible"]),y=o.useState(!1),E=y[0],v=y[1],C=o.useContext(u.a),S=C.disabled,k=void 0!==S&&S,w=C.expanded,x=C.toggle;return o.createElement(s.a,Object(n.a)({focusRipple:!1,disableRipple:!0,disabled:k,component:"div","aria-expanded":w,className:Object(l.a)(i.root,d,k&&i.disabled,w&&i.expanded,E&&i.focused),onFocusVisible:function(e){v(!0),b&&b(e)},onBlur:function(e){v(!1),h&&h(e)},onClick:function(e){x&&x(e),g&&g(e)},ref:t},f),o.createElement("div",{className:Object(l.a)(i.content,w&&i.expanded)},a),p&&o.createElement(c.a,Object(n.a)({className:Object(l.a)(i.expandIcon,w&&i.expanded),edge:"end",component:"div",tabIndex:null,role:null,"aria-hidden":!0},m),p))}));t.a=Object(i.a)((function(e){var t={duration:e.transitions.duration.shortest};return{root:{display:"flex",minHeight:48,transition:e.transitions.create(["min-height","background-color"],t),padding:e.spacing(0,3),"&:hover:not($disabled)":{cursor:"pointer"},"&$expanded":{minHeight:64},"&$focused":{backgroundColor:e.palette.grey[300]},"&$disabled":{opacity:.38}},expanded:{},focused:{},disabled:{},content:{display:"flex",flexGrow:1,transition:e.transitions.create(["margin"],t),margin:"12px 0","&$expanded":{margin:"20px 0"}},expandIcon:{transform:"rotate(0deg)",transition:e.transitions.create("transform",t),"&:hover":{backgroundColor:"transparent"},"&$expanded":{transform:"rotate(180deg)"}}}}),{name:"MuiExpansionPanelSummary"})(d)},582:function(e,t,a){"use strict";var n=a(1),r=a(201),o=a(200),l=a(123),s=a(202);var c=a(197),i=a(4),u=a(0),d=(a(75),a(3),a(5)),p=a(554),m=a(192),h=a(6),g=a(567),b=a(568),f=u.forwardRef((function(e,t){var a,h=e.children,f=e.classes,y=e.className,E=e.defaultExpanded,v=void 0!==E&&E,C=e.disabled,S=void 0!==C&&C,k=e.expanded,w=e.onChange,x=e.square,O=void 0!==x&&x,j=e.TransitionComponent,A=void 0===j?p.a:j,N=e.TransitionProps,I=Object(i.a)(e,["children","classes","className","defaultExpanded","disabled","expanded","onChange","square","TransitionComponent","TransitionProps"]),P=Object(b.a)({controlled:k,default:v,name:"ExpansionPanel",state:"expanded"}),D=Object(c.a)(P,2),L=D[0],R=D[1],T=u.useCallback((function(e){R(!L),w&&w(e,!L)}),[L,w,R]),B=u.Children.toArray(h),K=(a=B,Object(r.a)(a)||Object(o.a)(a)||Object(l.a)(a)||Object(s.a)()),z=K[0],H=K.slice(1),V=u.useMemo((function(){return{expanded:L,disabled:S,toggle:T}}),[L,S,T]);return u.createElement(m.a,Object(n.a)({className:Object(d.a)(f.root,y,L&&f.expanded,S&&f.disabled,!O&&f.rounded),ref:t,square:O},I),u.createElement(g.a.Provider,{value:V},z),u.createElement(A,Object(n.a)({in:L,timeout:"auto"},N),u.createElement("div",{"aria-labelledby":z.props.id,id:z.props["aria-controls"],role:"region"},H)))}));t.a=Object(h.a)((function(e){var t={duration:e.transitions.duration.shortest};return{root:{position:"relative",transition:e.transitions.create(["margin"],t),"&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:e.palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-child":{"&:before":{display:"none"}},"&$expanded":{margin:"16px 0","&:first-child":{marginTop:0},"&:last-child":{marginBottom:0},"&:before":{opacity:0}},"&$expanded + &":{"&:before":{display:"none"}},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},rounded:{borderRadius:0,"&:first-child":{borderTopLeftRadius:e.shape.borderRadius,borderTopRightRadius:e.shape.borderRadius},"&:last-child":{borderBottomLeftRadius:e.shape.borderRadius,borderBottomRightRadius:e.shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},expanded:{},disabled:{}}}),{name:"MuiExpansionPanel"})(f)},599:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(59);t.a=Object(o.a)(r.a.createElement("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check")},600:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(3),l=a.n(o);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=function(e){var t=e.color,a=e.size,n=c(e,["color","size"]);return r.a.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},n),r.a.createElement("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),r.a.createElement("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}))};i.propTypes={color:l.a.string,size:l.a.oneOfType([l.a.string,l.a.number])},i.defaultProps={color:"currentColor",size:"24"},t.a=i},634:function(e,t,a){"use strict";a.r(t);var n,r=a(50),o=a.n(r),l=a(76),s=a(86),c=a(87),i=a(54),u=a(89),d=a(88),p=a(14),m=a(0),h=a.n(m),g=a(11),b=a(198),f=a.n(b),y=a(588),E=a(547),v=a(637),C=a(617),S=a(531),k=a(636),w=a(528),x=a(560),O=a(618),j=a(642),A=a(620),N=a(633),I=a(85),P=a(544),D=a(540),L=a(541),R=a(542),T=a(624),B=a(619),K=a(621),z=a(623),H=a(563),V=a(631),U=a(122),_=a(154),q=a(152),W=a(186),M=a.n(W),J=a(574),$=a(6),F=a(587),X=a(580),Z=a(543),Y=a(192),G=a(582),Q=a(581),ee=a(532),te=a(533),ae=a(530),ne=a(534),re=a(535),oe=a(592),le=a(599),se=a(59),ce=Object(se.a)(h.a.createElement("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning"),ie=a(622),ue=a(553),de=a(600),pe=Object(g.c)(F.a)(H.b),me=Object(g.c)(C.a)(H.b),he=Object(g.c)(me)(n||(n=Object(p.a)(["\n  min-width: 300px;\n  max-width: 300px;\n"]))),ge=Object($.a)({root:{display:"block"}})(X.a),be=Object(g.c)(E.a)(H.b),fe=Object(g.c)(S.a)(H.b),ye=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var r=!1;return n.props.agent.inputs&&n.props.inputs.forEach((function(e){var t;e.enableSSL&&(null===(t=n.props.agent.inputs)||void 0===t?void 0:t.includes(e.uuid))&&(r=!0)})),n.state={saveButtonDisabled:!0,helmCmd:"",helmCmdHistory:[],selectedHelmCmd:"",deleteAgent:!1,verboseSelected:!1,helmConfig:"",sslSecrets:[],errors:{agentName:!1,namespace:!1,configPath:!1},agent:n.props.agent,agentName:n.props.agent.name||"",namespace:n.props.agent.namespace||"",configPath:n.props.agent.configPath||"",useNodeSelector:n.props.useNodeSelector,selectedInputs:n.props.agent.inputs||[],showTLSInstructions:r,nodeSelectorLabelKey:n.props.useNodeSelector?n.props.agent.nodeSelector.split(".")[0]:"",nodeSelectorLabelValue:n.props.useNodeSelector?n.props.agent.nodeSelector.split(".")[1]:""},n.handleChange=n.handleChange.bind(Object(i.a)(n)),n.setSaveButtonDisabled=n.setSaveButtonDisabled.bind(Object(i.a)(n)),n.toggleNodeSelector=n.toggleNodeSelector.bind(Object(i.a)(n)),n.deleteAgent=n.deleteAgent.bind(Object(i.a)(n)),n.updateAgent=n.updateAgent.bind(Object(i.a)(n)),n.deleteAgentConfirm=n.deleteAgentConfirm.bind(Object(i.a)(n)),n.closeDeleteAgent=n.closeDeleteAgent.bind(Object(i.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,l,s,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.context.apiUrl,"/agent/").concat(this.props.agent.uuid,"/helmCmd"));case 3:return t=e.sent,e.next=6,t.json();case 6:return a=e.sent,n=a.helmCmd,r=a.helmCmdHistory,e.next=11,fetch("".concat(this.context.apiUrl,"/agent/").concat(this.props.agent.uuid,"/helmConfig"));case 11:return l=e.sent,e.next=14,l.json();case 14:s=e.sent,c=s.helmConfig,i=s.sslSecrets,this.setSaveButtonDisabled(),this.setState({helmCmd:n,helmConfig:c,sslSecrets:i,helmCmdHistory:r,selectedHelmCmd:r.length?r[0].uuid:""}),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(0);case 22:case"end":return e.stop()}}),e,this,[[0,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"statusIcon",value:function(){return this.props.agent.agentInstallationDate?h.a.createElement(le.a,{style:{color:_.a[500],fontSize:50}}):h.a.createElement(ce,{style:{color:q.a[500],fontSize:50}})}},{key:"setSaveButtonDisabled",value:function(){this.setState({saveButtonDisabled:!(this.state.agentName&&this.state.namespace&&this.state.configPath)})}},{key:"handleChange",value:function(e){var t=this,a={selectedInputs:this.state.selectedInputs};if(e.target.name.match(/^inputsource_/)){var n=e.target.name.replace(/^inputsource_/,"");e.target.checked&&!a.selectedInputs.includes(n)?a.selectedInputs.push(n):a.selectedInputs=a.selectedInputs.filter((function(e){return e!==n}))}else a[e.target.name]=e.target.value;this.setState(a,(function(){t.setSaveButtonDisabled()}))}},{key:"deleteAgent",value:function(){this.setState({deleteAgent:!0})}},{key:"deleteAgentConfirm",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.deleteAgent(this.props.agent.uuid);case 2:this.setState({deleteAgent:!1});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeDeleteAgent",value:function(){this.setState({deleteAgent:!1})}},{key:"renderDeleteAgent",value:function(){var e="helm uninstall -n ".concat(this.state.namespace," redactics");return h.a.createElement(x.a,{mt:4},h.a.createElement(be,{container:!0,justify:"space-between",mt:12},h.a.createElement(be,{item:!0,xs:10}),h.a.createElement(be,{item:!0},h.a.createElement(fe,{variant:"contained",color:"default",size:"small",onClick:this.deleteAgent},h.a.createElement(ie.a,null),"\xa0 Delete Agent"))),h.a.createElement(D.a,{open:this.state.deleteAgent,onClose:this.closeDeleteAgent,"aria-labelledby":"delete-agent-title","aria-describedby":"legend-description"},h.a.createElement(L.a,{id:"delete-agent-title"},"Delete This Agent?"),h.a.createElement(R.a,null,h.a.createElement(Z.a,{id:"delete-agent-description"},"Clicking ",h.a.createElement("b",null,"Delete")," will delete the settings for this agent, but to remove this agent from your cluster locally, please enter the following (assuming this namespace contains only Redactics configurations). Any workflows associated with this agent will need to be reassigned to a new agent for the config to be put to use.",h.a.createElement(x.a,{mt:4},h.a.createElement(J.CopyToClipboard,{text:e,onCopy:this.props.clipboardCopy},h.a.createElement(fe,{variant:"outlined",size:"small",color:"secondary"},h.a.createElement(de.a,null))),h.a.createElement("pre",null,e))),h.a.createElement(x.a,{mt:4},h.a.createElement(P.a,null,h.a.createElement(fe,{onClick:this.closeDeleteAgent},"Cancel"),h.a.createElement(fe,{color:"secondary",onClick:this.deleteAgentConfirm},"Delete"))))))}},{key:"toggleNodeSelector",value:function(e){this.setState({useNodeSelector:e.target.checked})}},{key:"updateAgent",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,l,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},a=this.state.agent.uuid,n=this.state.useNodeSelector?"".concat(this.state.nodeSelectorLabelKey,".").concat(this.state.nodeSelectorLabelValue):"",!this.props.handleErrors({agentName:this.state.agentName,namespace:this.state.namespace,useNodeSelector:this.state.useNodeSelector,nodeSelectorLabelKey:this.state.nodeSelectorLabelKey,nodeSelectorLabelValue:this.state.nodeSelectorLabelValue,configPath:this.state.configPath,errors:this.state.errors})){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,fetch("".concat(this.context.apiUrl,"/agent/").concat(a),{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.state.agentName,namespace:this.state.namespace,nodeSelector:n,configPath:this.state.configPath,inputs:this.state.selectedInputs})});case 9:return e.next=11,fetch("".concat(this.context.apiUrl,"/agent/").concat(a,"/helmCmd"));case 11:return r=e.sent,e.next=14,r.json();case 14:l=e.sent,s=l.helmCmd,c=l.helmCmdHistory,t.helmCmd=s,t.helmCmdHistory=c,this.props.updateAgentSnackbar(),this.setState(t),e.next=24;break;case 22:e.prev=22,e.t0=e.catch(6);case 24:case"end":return e.stop()}}),e,this,[[6,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"displayAgentStatus",value:function(){if(this.props.agent.agentInstallationDate){var e=this.props.agent.lastHeartBeatDate?h.a.createElement("div",null,"Last configuration update date: ",h.a.createElement("b",null,h.a.createElement(M.a,{fromNow:!0},new Date(this.props.agent.lastHeartBeatDate)))):"";return h.a.createElement(x.a,null,h.a.createElement(I.a,{variant:"h6",gutterBottom:!0},"Redactics Agent Info"),h.a.createElement(x.a,{mt:2},h.a.createElement("div",null,"Version: ",h.a.createElement("b",null,this.props.agent.lastAgentVersion)),h.a.createElement("div",null,"Initial installation date: ",h.a.createElement("b",null,h.a.createElement(M.a,{fromNow:!0},new Date(this.props.agent.agentInstallationDate)))),e))}return h.a.createElement(x.a,null,h.a.createElement(I.a,{variant:"h6",gutterBottom:!0},"Awaiting Agent Reporting..."))}},{key:"agentInfo",value:function(){var e=this;return h.a.createElement(h.a.Fragment,null,this.displayAgentStatus(),h.a.createElement(x.a,{mt:4},h.a.createElement(Y.a,{variant:"outlined"},h.a.createElement(G.a,null,h.a.createElement(Q.a,{expandIcon:h.a.createElement(ue.a,null)},h.a.createElement(I.a,null,"Agent Settings")),h.a.createElement(ge,null,this.props.errors.JSX,h.a.createElement(x.a,{mt:2},h.a.createElement(he,{fullWidth:!0,variant:"outlined"},h.a.createElement(v.a,{error:this.state.errors.agentName,name:"agentName",label:"Agent Name",value:this.state.agentName,onChange:this.handleChange,InputProps:{endAdornment:h.a.createElement(O.a,{position:"end"},h.a.createElement(j.a,{title:"Unique name used to identify this agent (e.g. cluster or environment name)",placement:"right-start"},h.a.createElement(B.a,null)))}}))),h.a.createElement(x.a,{mt:4},h.a.createElement(he,{fullWidth:!0,variant:"outlined"},h.a.createElement(v.a,{error:this.state.errors.namespace,name:"namespace",label:"Kubernetes Namespace",value:this.state.namespace,onChange:this.handleChange,InputProps:{endAdornment:h.a.createElement(O.a,{position:"end"},h.a.createElement(j.a,{title:"Kubernetes namespace used for the Redactics Agent",placement:"right-start"},h.a.createElement(B.a,null)))}}))),h.a.createElement(x.a,{mt:4},h.a.createElement(A.a,{control:h.a.createElement(N.a,{checked:this.state.useNodeSelector,onChange:this.toggleNodeSelector,name:"useNodeSelector",color:"primary"}),label:"Assign Agent Pods to Specific Nodes (optional)"})," ",h.a.createElement(j.a,{title:"Optional Kubernetes nodeSelector label for Redactics Agent (allows prevent unwanted resource competition during export jobs), requires label key and value",placement:"right-start"},h.a.createElement(B.a,null))),h.a.createElement(x.a,{mt:4,display:this.state.useNodeSelector?"block":"none"},h.a.createElement(x.a,null,h.a.createElement(he,{fullWidth:!0,variant:"outlined"},h.a.createElement(v.a,{error:this.state.errors.nodeSelectorLabelKey,name:"nodeSelectorLabelKey",label:"Kubernetes Node Selector Label Key",value:this.state.nodeSelectorLabelKey,onChange:this.handleChange}))),h.a.createElement(x.a,{mt:4},h.a.createElement(he,{fullWidth:!0,variant:"outlined"},h.a.createElement(v.a,{error:this.state.errors.nodeSelectorLabelValue,name:"nodeSelectorLabelValue",label:"Kubernetes Node Selector Label Value",value:this.state.nodeSelectorLabelValue,onChange:this.handleChange})))),h.a.createElement(x.a,{mt:4},h.a.createElement(he,{fullWidth:!0,variant:"outlined"},h.a.createElement(v.a,{error:this.state.errors.configPath,name:"configPath",label:"Local Helm Config Path",value:this.state.configPath,onChange:this.handleChange,InputProps:{endAdornment:h.a.createElement(O.a,{position:"end"},h.a.createElement(j.a,{title:"Path to where you would like to save your Helm configuration file",placement:"right-start"},h.a.createElement(B.a,null)))}}))),h.a.createElement(x.a,{mt:8},h.a.createElement(I.a,{variant:"h4"},"Input Sources"),h.a.createElement(x.a,{mt:2},h.a.createElement(I.a,null,"Use the following Input Sources with this Agent:"),this.props.inputs.map((function(t){return h.a.createElement(A.a,{key:t.uuid,control:h.a.createElement(N.a,{name:"inputsource_"+t.uuid,color:"primary",onChange:e.handleChange,checked:e.state.selectedInputs.includes(t.uuid)}),label:t.inputName})})))),h.a.createElement(x.a,{mt:8},h.a.createElement(fe,{color:"secondary",variant:"contained",disabled:this.state.saveButtonDisabled,onClick:this.updateAgent},h.a.createElement(z.a,null),"\xa0Save Changes")))))),h.a.createElement(x.a,{mt:4,display:this.state.showTLSInstructions?"block":"none"},h.a.createElement(Y.a,{variant:"outlined"},h.a.createElement(G.a,null,h.a.createElement(Q.a,{expandIcon:h.a.createElement(ue.a,null)},h.a.createElement(I.a,null,"Agent TLS/SSL Input Setup Instructions")),h.a.createElement(ge,null,"Enabling TLS/SSL encryption with your connectivity to your input sources requires performing the following steps. These steps (even upon completion) will remain available here for reference:",h.a.createElement("ol",null,h.a.createElement("li",null,"Figure out whether your database requires presenting only the root CA certificate, or the root CA as well as client cert and key files. Download these required files."),h.a.createElement("li",null,"Create a Kubernetes secret containing the certificates required by your database using the commands required below. Adjust the file paths to your downloaded certificates, and take out the ",h.a.createElement("code",null,"sslcert")," and ",h.a.createElement("code",null,"sslkey")," params if your server doesn't require access to these.")),h.a.createElement(ee.a,null,h.a.createElement(te.a,null,h.a.createElement(ae.a,null,h.a.createElement(ne.a,null,"Input Source"),h.a.createElement(ne.a,null,"Secret Creation Command"),h.a.createElement(ne.a,null))),h.a.createElement(re.a,null,this.state.sslSecrets.map((function(t,a){return h.a.createElement(ae.a,{key:a},h.a.createElement(ne.a,null,t.inputSource),h.a.createElement(ne.a,null,t.cmd),h.a.createElement(ne.a,null,h.a.createElement(J.CopyToClipboard,{text:t.cmd,onCopy:e.props.clipboardCopy},h.a.createElement(fe,{variant:"outlined",size:"small",color:"secondary"},h.a.createElement(de.a,null)))))})))))))),h.a.createElement(x.a,{mt:4},h.a.createElement(Y.a,{variant:"outlined"},h.a.createElement(G.a,null,h.a.createElement(Q.a,{expandIcon:h.a.createElement(ue.a,null)},h.a.createElement(I.a,null,"Agent Config File")),h.a.createElement(ge,null,h.a.createElement("p",null,"Please copy and paste this helm configuration file to ",h.a.createElement("b",null,this.state.configPath),", and change all of the ",h.a.createElement("b",null,"changemes")," in this file to real values. This configuration file will be automatically regenerated as you add/remove database inputs from your workflows, at which time you'll have to update this file with the provided updated configuration."),h.a.createElement(x.a,{mt:8},h.a.createElement(J.CopyToClipboard,{text:this.state.helmConfig,onCopy:this.props.clipboardCopy},h.a.createElement(fe,{variant:"outlined",size:"small",color:"secondary"},h.a.createElement(de.a,null)))),h.a.createElement(x.a,{mt:2},h.a.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"}},this.state.helmConfig)))))),h.a.createElement(x.a,{mt:4},h.a.createElement(Y.a,{variant:"outlined"},h.a.createElement(G.a,{defaultExpanded:!0},h.a.createElement(Q.a,{expandIcon:h.a.createElement(ue.a,null)},h.a.createElement(I.a,null,"Agent Helm Upgrade/Install Command")),h.a.createElement(ge,null,h.a.createElement(x.a,{mt:2},h.a.createElement(J.CopyToClipboard,{text:this.state.helmCmd.replace(/\\n/g,"\n"),onCopy:this.props.clipboardCopy},h.a.createElement(fe,{variant:"outlined",size:"small",color:"secondary"},h.a.createElement(de.a,null)))),h.a.createElement("pre",{style:{whiteSpace:"normal"}},this.state.helmCmd.split("\\n").map((function(e,t){return t?h.a.createElement("span",{key:t,style:{wordBreak:"break-all",paddingLeft:"15px"}},e,h.a.createElement("br",null)):h.a.createElement("span",{key:t,style:{wordBreak:"break-all"}},e,h.a.createElement("br",null))}))))))))}},{key:"render",value:function(){return h.a.createElement(pe,{mb:6},h.a.createElement(oe.a,null,h.a.createElement(be,{justify:"space-between",container:!0,spacing:10},h.a.createElement(be,{item:!0,xs:1},this.statusIcon()),h.a.createElement(be,{item:!0,xs:11},h.a.createElement(I.a,{variant:"h4"},this.state.agentName," ",h.a.createElement("code",null,"(",this.props.agent.uuid,")")),h.a.createElement(x.a,{mt:4},this.agentInfo()),this.renderDeleteAgent()))))}}]),a}(h.a.Component);ye.contextType=U.a;var Ee,ve,Ce=ye,Se=Object(g.c)(y.a)(H.b),ke=Object(g.c)(E.a)(H.b),we=Object(g.c)(v.a)(H.b),xe=Object(g.c)(we)(Ee||(Ee=Object(p.a)(["\n  width: 400px;\n"]))),Oe=Object(g.c)(C.a)(H.b),je=Object(g.c)(Oe)(ve||(ve=Object(p.a)(["\n  min-width: 400px;\n  max-width: 800px;\n"]))),Ae=Object(g.c)(S.a)(H.b),Ne=Object(g.c)(V.a)(H.b),Ie=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={namespace:"redactics",configPath:"~/.redactics/values.yaml",saveButtonDisabled:!0,agents:[],inputs:[],helmConfig:"",configMaxWidth:"md",newAgentId:"",illegalChars:!1,sampleDBSelected:!1,sampleAgentConfirmationDialog:!1,useNodeSelector:!1,nodeSelectorLabelKey:"nodePool",nodeSelectorLabelValue:"agent",showClipboardSnackbar:!1,showSaveSnackbar:!1,disableCancel:!1,agentName:"",nodeSelector:"",selectedInputs:[],errors:{agentName:!1,namespace:!1,configPath:!1,illegalChars:""},showInstallAgentDialog:!1},n.handleChange=n.handleChange.bind(Object(i.a)(n)),n.handleInstallAgent=n.handleInstallAgent.bind(Object(i.a)(n)),n.handleClose=n.handleClose.bind(Object(i.a)(n)),n.handleErrors=n.handleErrors.bind(Object(i.a)(n)),n.deleteAgent=n.deleteAgent.bind(Object(i.a)(n)),n.clipboardCopy=n.clipboardCopy.bind(Object(i.a)(n)),n.updateAgentSnackbar=n.updateAgentSnackbar.bind(Object(i.a)(n)),n.handleSnackbarClose=n.handleSnackbarClose.bind(Object(i.a)(n)),n.toggleNodeSelector=n.toggleNodeSelector.bind(Object(i.a)(n)),n.saveNewAgent=n.saveNewAgent.bind(Object(i.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.fetchAgents(),this.fetchInputs(),this.getAgentHeartbeatData()}},{key:"fetchAgents",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.context.apiUrl,"/agent"));case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,this.setState({agents:a,showInstallAgentDialog:!a.length}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchInputs",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.context.apiUrl,"/input"));case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=[],a.inputs.forEach((function(e){n.push(e.uuid)})),this.setState({inputs:a.inputs,selectedInputs:n}),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"clipboardCopy",value:function(){this.setState({showClipboardSnackbar:!0})}},{key:"updateAgentSnackbar",value:function(){this.setState({showSaveSnackbar:!0})}},{key:"handleSnackbarClose",value:function(){this.setState({showClipboardSnackbar:!1,showSaveSnackbar:!1})}},{key:"deleteAgent",value:function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.context.apiUrl,"/agent/").concat(t),{method:"delete"});case 3:this.fetchAgents(),this.fetchInputs(),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){var t={};if(e.target.name.match(/^inputsource_/)){var a=e.target.name.replace(/^inputsource_/,"");e.target.checked&&!t.selectedInputs.includes(a)?t.selectedInputs.push(a):t.selectedInputs=t.selectedInputs.filter((function(e){return e!==a}))}else t[e.target.name]=e.target.value;this.setState(t)}},{key:"handleErrors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!1,n=e||this.state,r=h.a.createElement(Ne,{mb:4,severity:"error"},"Kubernetes names must be no longer than 63 characters, must start and end with a lowercase letter or number, and may contain lowercase letters, numbers, and hyphens."),o=h.a.createElement(Ne,{mb:4,severity:"error"},"Invalid path"),l=h.a.createElement(Ne,{mb:4,severity:"error"},"An Agent Name is required"),s=["namespace"];return n.useNodeSelector&&(s.push("nodeSelectorLabelKey"),s.push("nodeSelectorLabelValue")),n.errors.JSX="",n.errors.agentName=!1,n.errors.configPath=!1,s.forEach((function(e){n.errors[e]=!1,a.isIllegalName(n[e])&&(n.errors[e]=!0,n[e]&&(n.errors.JSX=r),t=!0)})),a.isIllegalPath(n.configPath)?(n.errors.configPath=!0,n.errors.JSX=o,t=!0):n.errors.configPath=!1,n.agentName||(t=!0,n.errors.agentName=!0,n.errors.JSX=l),this.setState(n),t}},{key:"handleInstallAgent",value:function(){this.setState({showInstallAgentDialog:!0,agentName:"",namespace:"redactics",nodeSelector:"",useNodeSelector:!1,configPath:"~/.redactics/values.yaml"})}},{key:"handleClose",value:function(){this.setState({showInstallAgentDialog:!1})}},{key:"toggleNodeSelector",value:function(e){this.setState({useNodeSelector:e.target.checked})}},{key:"clipboardSnackbar",value:function(){return h.a.createElement(k.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:this.state.showClipboardSnackbar,autoHideDuration:8e3,onClose:this.handleSnackbarClose,ContentProps:{"aria-describedby":"message-id"},message:h.a.createElement("span",{id:"message-id"},"This command has been copied to your clipboard"),action:[h.a.createElement(w.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleSnackbarClose},h.a.createElement(T.a,null))]})}},{key:"saveSnackbar",value:function(){return h.a.createElement(k.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:this.state.showSaveSnackbar,autoHideDuration:8e3,onClose:this.handleSnackbarClose,ContentProps:{"aria-describedby":"message-id"},message:h.a.createElement("span",{id:"message-id"},"Your changes have been saved"),action:[h.a.createElement(w.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleSnackbarClose},h.a.createElement(T.a,null))]})}},{key:"saveNewAgent",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},a=this.state.useNodeSelector?"".concat(this.state.nodeSelectorLabelKey,".").concat(this.state.nodeSelectorLabelValue):"",!this.handleErrors()){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,fetch("".concat(this.context.apiUrl,"/agent"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.state.agentName,namespace:this.state.namespace,nodeSelector:a,configPath:this.state.configPath,inputs:this.state.selectedInputs})});case 8:this.fetchAgents(),t.showInstallAgentDialog=!1,this.setState(t),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(5);case 15:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"installAgent",value:function(){var e=this;return h.a.createElement(h.a.Fragment,null,h.a.createElement(x.a,null,h.a.createElement("p",null,"Redactics requires installation of the Redactics Agent helm chart onto a Kubernetes cluster which has network access to your application database(s). The agent is used for carrying out the work in the workflows you've defined here. Each Kubernetes cluster needs a single agent installed (a single agent can control multiple databases)."),this.state.illegalChars),this.state.errors.JSX,h.a.createElement(x.a,{mt:2},h.a.createElement(je,{fullWidth:!0,variant:"outlined"},h.a.createElement(xe,{error:this.state.errors.agentName,name:"agentName",label:"Agent Name",value:this.state.agentName,onChange:this.handleChange,InputProps:{endAdornment:h.a.createElement(O.a,{position:"end"},h.a.createElement(j.a,{title:"Unique name used to identify this agent (e.g. cluster or environment name)",placement:"right-start"},h.a.createElement(B.a,null)))}}))),h.a.createElement(x.a,{mt:4},h.a.createElement(je,{fullWidth:!0,variant:"outlined"},h.a.createElement(xe,{error:this.state.errors.namespace,name:"namespace",label:"Kubernetes Namespace",value:this.state.namespace,onChange:this.handleChange,InputProps:{endAdornment:h.a.createElement(O.a,{position:"end"},h.a.createElement(j.a,{title:"Kubernetes namespace used for the Redactics Agent",placement:"right-start"},h.a.createElement(B.a,null)))}}))),h.a.createElement(x.a,{mt:4},h.a.createElement(A.a,{control:h.a.createElement(N.a,{checked:this.state.useNodeSelector,onChange:this.toggleNodeSelector,name:"useNodeSelector",color:"primary"}),label:"Assign Agent Pods to Specific Nodes (optional)"})," ",h.a.createElement(j.a,{title:"Optional Kubernetes nodeSelector label for Redactics Agent (allows prevent unwanted resource competition during export jobs), requires label key and value",placement:"right-start"},h.a.createElement(B.a,null))),h.a.createElement(x.a,{mt:4,display:this.state.useNodeSelector?"block":"none"},h.a.createElement(x.a,null,h.a.createElement(je,{fullWidth:!0,variant:"outlined"},h.a.createElement(xe,{name:"nodeSelectorLabelKey",label:"Kubernetes Node Selector Label Key",value:this.state.nodeSelectorLabelKey,onChange:this.handleChange}))),h.a.createElement(x.a,{mt:4},h.a.createElement(je,{fullWidth:!0,variant:"outlined"},h.a.createElement(xe,{name:"nodeSelectorLabelValue",label:"Kubernetes Node Selector Label Value",value:this.state.nodeSelectorLabelValue,onChange:this.handleChange})))),h.a.createElement(x.a,{mt:4},h.a.createElement(je,{fullWidth:!0,variant:"outlined"},h.a.createElement(xe,{error:this.state.errors.configPath,name:"configPath",label:"Local Helm Config Path",value:this.state.configPath,onChange:this.handleChange,InputProps:{endAdornment:h.a.createElement(O.a,{position:"end"},h.a.createElement(j.a,{title:"Path to where you would like to save your Helm configuration file",placement:"right-start"},h.a.createElement(B.a,null)))}}))),h.a.createElement(x.a,{mt:8},h.a.createElement(I.a,{variant:"h4"},"Input Sources"),h.a.createElement(x.a,{mt:2},h.a.createElement(I.a,null,"Use the following Input Sources with this Agent:"),this.state.inputs.map((function(t){return h.a.createElement(A.a,{key:t.uuid,control:h.a.createElement(N.a,{name:"inputsource_"+t.uuid,color:"primary",onChange:e.handleChange,checked:e.state.selectedInputs.includes(t.uuid)}),label:t.inputName})})))),h.a.createElement(P.a,null,h.a.createElement(Ae,{color:"secondary",variant:"contained",onClick:this.saveNewAgent},"Save\xa0",h.a.createElement(z.a,null))))}},{key:"getAgentHeartbeatData",value:function(){}},{key:"render",value:function(){var e=this;return h.a.createElement(h.a.Fragment,null,h.a.createElement(D.a,{open:this.state.showInstallAgentDialog,onClose:this.handleClose,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description",maxWidth:this.state.configMaxWidth},h.a.createElement(L.a,{id:"dialog-title"},"Configure Your Redactics Agent"),h.a.createElement(R.a,null,this.installAgent())),this.clipboardSnackbar(),this.saveSnackbar(),h.a.createElement(f.a,{title:"Agents"}),h.a.createElement(I.a,{variant:"h1",gutterBottom:!0,display:"inline"},"Agents"),h.a.createElement(Se,{my:6}),h.a.createElement(x.a,{mt:4},h.a.createElement(I.a,{variant:"body1",gutterBottom:!0},"Install the Redactics Agent adjacent to your input sources using the provided configuration and install command.")),h.a.createElement(x.a,{mt:8},h.a.createElement(ke,{justify:"space-between",container:!0,spacing:10},h.a.createElement(ke,{item:!0,xs:1,mb:6}),h.a.createElement(ke,{item:!0},h.a.createElement(x.a,{mb:4},h.a.createElement(Ae,{variant:"contained",color:"secondary",size:"small",onClick:this.handleInstallAgent},h.a.createElement(K.a,null),"Install New Agent"))))),this.state.agents.map((function(t){return h.a.createElement(Ce,{clipboardCopy:e.clipboardCopy,updateAgentSnackbar:e.updateAgentSnackbar,handleSnackbarClose:e.handleSnackbarClose,deleteAgent:e.deleteAgent,agent:t,inputs:e.state.inputs,key:t.uuid,useNodeSelector:!!t.nodeSelector,handleErrors:e.handleErrors,errors:e.state.errors})})))}}],[{key:"isIllegalName",value:function(e){return!e.match(/^[a-zA-Z0-9]([-a-zA-Z0-9]*[a-zA-Z0-9])?$/)}},{key:"isIllegalPath",value:function(e){return!e.match(/(\/|\\)/)}}]),a}(h.a.Component);Ie.contextType=U.a;t.default=Ie}}]);
//# sourceMappingURL=6.541f6f9a.chunk.js.map