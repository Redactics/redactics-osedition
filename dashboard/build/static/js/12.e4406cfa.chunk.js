(this.webpackJsonpredactics=this.webpackJsonpredactics||[]).push([[12],{628:function(e,a,t){"use strict";t.r(a);var n,l,r,i,o,s,c,d,u,p,m,h,b,g,E,f,k=t(50),y=t.n(k),w=t(76),v=t(86),C=t(87),S=t(54),D=t(89),O=t(88),F=t(14),T=t(0),j=t.n(T),I=t(11),x=t(6),R=t(197),A=t.n(R),W=t(585),U=t(617),P=t(547),N=t(637),L=t(630),_=t(531),V=t(85),B=t(560),M=t(540),H=t(541),K=t(542),z=t(543),Y=t(593),$=t(591),q=t(590),G=t(641),J=t(618),Q=t(642),X=t(587),Z=t(544),ee=t(627),ae=t(621),te=t(553),ne=t(619),le=t(623),re=t(563),ie=t(122),oe=t(574),se=t(584),ce=t(636),de=t(528),ue=t(589),pe=t(192),me=t(631),he=t(624),be=t(622),ge=t(600),Ee=t(532),fe=t(535),ke=t(530),ye=t(534),we=t(640),ve=Object(I.c)(P.a)(re.b),Ce=Object(I.c)(N.a)(re.b),Se=Object(I.c)(U.a)(re.b),De=Object(I.c)(Se)(n||(n=Object(F.a)(["\n  min-width: 100px;\n  max-width: 100px;\n"]))),Oe=Object(I.c)(Ce)(l||(l=Object(F.a)(["\n  width: 100px;\n"]))),Fe=Object(I.c)(L.a)(re.b),Te=Object(I.c)(_.a)(re.b),je=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(e){var n;return Object(v.a)(this,t),(n=a.call(this,e)).state={ruleLabelWidth:30},n}return Object(C.a)(t,[{key:"displayMaskingRules",value:function(){var e=this;return this.props.numMaskingRules?j.a.createElement(B.a,{mt:8},j.a.createElement(ve,{justify:"space-between",container:!0,spacing:10},j.a.createElement(ve,{item:!0}),j.a.createElement(ve,{item:!0,mb:6},j.a.createElement("div",null,j.a.createElement(Te,{variant:"contained",color:"secondary",size:"small",onClick:this.props.addMaskingRule},j.a.createElement(ae.a,null),"\xa0 Add Rule")))),j.a.createElement(Ee.a,{size:"small",style:{width:"auto"}},j.a.createElement(fe.a,null,this.props.maskingRuleValues.map((function(a){return j.a.createElement(ke.a,{key:a.key},j.a.createElement(ye.a,{style:{paddingLeft:0}},j.a.createElement(De,{variant:"outlined",margin:"dense"},j.a.createElement(G.a,null,"Input"),j.a.createElement(Fe,{value:a.databaseTable,onChange:function(t){return e.props.handleRuleChange(a.key,t)},name:"databaseTable",input:j.a.createElement(we.a,{labelWidth:e.state.ruleLabelWidth,name:"rule"})},e.props.allDatabaseTables.map((function(e){return j.a.createElement(X.a,{key:e,value:e},e)}))))),j.a.createElement(ye.a,null,j.a.createElement(Oe,{name:"schema",defaultValue:a.schema,label:"Schema",variant:"outlined",onChange:function(t){return e.props.handleRuleChange(a.key,t)},margin:"dense"})),j.a.createElement(ye.a,null,j.a.createElement(Oe,{name:"table",defaultValue:a.table,label:"Table",variant:"outlined",onChange:function(t){return e.props.handleRuleChange(a.key,t)},margin:"dense"})),j.a.createElement(ye.a,null,j.a.createElement(Oe,{name:"column",defaultValue:a.column,label:"Column",variant:"outlined",onChange:function(t){return e.props.handleRuleChange(a.key,t)},margin:"dense"})),j.a.createElement(ye.a,null,j.a.createElement(De,{variant:"outlined",margin:"dense"},j.a.createElement(G.a,null,"Rule"),j.a.createElement(Fe,{value:a.rule,onChange:function(t){return e.props.handleRuleChange(a.key,t)},name:"rule",input:j.a.createElement(we.a,{labelWidth:e.state.ruleLabelWidth,name:"rule"})},e.props.maskingRules.map((function(e){return j.a.createElement(X.a,{key:e.key,value:e.key},e.val)}))))),j.a.createElement(ye.a,null,j.a.createElement(B.a,null,j.a.createElement(Te,{variant:"contained",color:"secondary",size:"small",onClick:function(){return e.props.deleteMaskingRule(a.key)}},j.a.createElement(be.a,null),"\xa0\xa0Delete"))))}))))):j.a.createElement(B.a,null,j.a.createElement(Te,{variant:"contained",color:"secondary",size:"small",onClick:this.props.addMaskingRule},j.a.createElement(ae.a,null),"\xa0\xa0Add Table Field Containing PII"))}},{key:"render",value:function(){return j.a.createElement(j.a.Fragment,null,j.a.createElement(B.a,{mt:8},j.a.createElement(V.a,{variant:"h6",gutterBottom:!0},"Database Fields Containing PII/Confidential Info"),j.a.createElement(B.a,{mb:4},j.a.createElement(ve,{container:!0},j.a.createElement(ve,{item:!0,xs:8},j.a.createElement(V.a,{variant:"body1",gutterBottom:!0},"You can use the Redactics PII Scanner to auto-detect your database fields containing PII, or else define your fields containing PII (and their redaction rules) here.")))),this.displayMaskingRules()))}}]),t}(j.a.Component),Ie=t(533),xe=t(633),Re=t(536),Ae=t(598),We=Object(I.c)(P.a)(re.b),Ue=Object(I.c)(_.a)(re.b),Pe=Object(I.c)(N.a)(re.b),Ne=Object(I.c)(U.a)(re.b),Le=Object(I.c)(Ne)(r||(r=Object(F.a)(["\n  min-width: 200px;\n  max-width: 200px;\n"]))),_e=Object(I.c)(Ne)(i||(i=Object(F.a)(["\n  min-width: 400px;\n  max-width: 400px;\n"]))),Ve=Object(I.c)(Pe)(o||(o=Object(F.a)(["\n  width: 200px;\n"]))),Be=Object(x.a)({root:{whiteSpace:"nowrap"}})(ye.a),Me=Object(I.c)(L.a)(re.b),He=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(){return Object(v.a)(this,t),a.apply(this,arguments)}return Object(C.a)(t,[{key:"getAgent",value:function(){var e=this,a=this.props.agents.filter((function(a){return a.uuid===e.props.workflow.agentId}));return a.length?a[0]:{configPath:"",namespace:""}}},{key:"displayTableSelection",value:function(e){var a=this,t="Add Table";return"allExclude"===e&&(t+=" Exclusion"),this.props.input.tables&&this.props.input.tables.length?j.a.createElement(Ee.a,{size:"small",style:{width:"auto"}},j.a.createElement(fe.a,null,this.props.input.tables.map((function(e,t){return j.a.createElement(ke.a,{key:t},j.a.createElement(ye.a,{style:{paddingLeft:0}},j.a.createElement(Ve,{name:"addSchema",label:"Schema",value:e.split(".")[0],onChange:function(e){return a.props.handleAddTable(e,t,"schema")},variant:"outlined",margin:"dense"})),j.a.createElement(ye.a,null,j.a.createElement(Ve,{name:"addTable",label:"Table",value:e.split(".")[1],onChange:function(e){return a.props.handleAddTable(e,t,"table")},variant:"outlined",margin:"dense"})),j.a.createElement(ye.a,null,j.a.createElement(B.a,null,j.a.createElement(Ue,{variant:"contained",color:"secondary",size:"small",onClick:function(){return a.props.deleteTableSelection(t)}},j.a.createElement(be.a,null),"\xa0\xa0Delete"))))})),j.a.createElement(ke.a,null,j.a.createElement(ye.a,null),j.a.createElement(ye.a,null),j.a.createElement(ye.a,null,j.a.createElement(Ue,{variant:"contained",color:"secondary",size:"small",onClick:this.props.addTableSelection},j.a.createElement(ae.a,null),"\xa0\xa0Add"))))):j.a.createElement(B.a,null,j.a.createElement(Ue,{variant:"contained",color:"secondary",size:"small",onClick:this.props.addTableSelection},j.a.createElement(ae.a,null),"\xa0\xa0",t))}},{key:"editInputDialogContent",value:function(){var e=this;return j.a.createElement(B.a,null,this.props.errors.JSX,j.a.createElement(B.a,{mt:8},j.a.createElement(B.a,{display:"mockDatabaseMigration"===this.props.workflow.workflowType?"none":"block"},j.a.createElement(_e,{margin:"dense",fullWidth:!0},j.a.createElement(G.a,null,"Table Selection"),j.a.createElement(Me,{value:this.props.input.tableSelection,name:"tableSelection",onChange:function(a){return e.props.handleInputChanges(a,e.props.input)}},j.a.createElement(X.a,{key:"",value:""},"None"),j.a.createElement(X.a,{key:"all",value:"all"},"Select all tables in all schema"),j.a.createElement(X.a,{key:"allExclude",value:"allExclude"},"Select all tables in all schema with specified exclusions"),j.a.createElement(X.a,{key:"specific",value:"specific"},"Select specific tables")))),j.a.createElement(B.a,{mt:4,display:"allExclude"===this.props.input.tableSelection||"specific"===this.props.input.tableSelection?"block":"none"},"You can use wildcards (i.e. ",j.a.createElement("code",null,j.a.createElement("b",null,"*")),") for broad pattern matching. For example, ",j.a.createElement("b",null,j.a.createElement("code",null,"public.account_*")),' will match all tables starting with "account_" in the public schema, and ',j.a.createElement("b",null,j.a.createElement("code",null,"company_*.users")),' will match all users tables in schema starting with "company_". If you aren\'t aware of what schema your tables reside in, they probably reside in ',j.a.createElement("b",null,j.a.createElement("code",null,"public")),", which is the PostgreSQL default.",j.a.createElement(B.a,{mt:8},this.displayTableSelection(this.props.input.tableSelection)))))}},{key:"outputMockConstraints",value:function(){var e=this,a=!1,t="",n=null;return this.props.agentInputs.forEach((function(l){n||(n=e.props.inputs.find((function(e){return e.uuid===l.uuid}))),n&&n.tables&&n.tables.length&&(a=!0,t="all tables except "+n.tables.join(", "))})),a?j.a.createElement(Ee.a,null,j.a.createElement(Ie.a,null,j.a.createElement(ke.a,null,j.a.createElement(ye.a,null,"Tables"),j.a.createElement(ye.a,null))),j.a.createElement(fe.a,null,j.a.createElement(ke.a,{key:n.uuid},j.a.createElement(ye.a,null,t),j.a.createElement(Be,null,j.a.createElement(Ue,{variant:"contained",color:"secondary",size:"small",onClick:function(){return e.props.triggerEditInputDialog(n)}},j.a.createElement(Ae.a,null),"\xa0Edit Table Selection"))))):j.a.createElement(B.a,null,j.a.createElement(Ue,{variant:"contained",color:"secondary",size:"small",onClick:function(){return e.props.triggerEditInputDialog({uuid:n.uuid,enabled:n.enabled,tableSelection:"allExclude",tables:["public"]})}},j.a.createElement(ae.a,null),"\xa0\xa0Add Database Cloning Constraint"))}},{key:"outputDataSources",value:function(){var e=this;if(this.props.agentInputs.length){if("mockDatabaseMigration"===this.props.workflow.workflowType){var a=this.props.inputs&&this.props.inputs.length&&this.props.inputs[0]?this.props.inputs[0].uuid:"";return j.a.createElement(B.a,null,j.a.createElement(Le,{margin:"dense",fullWidth:!0},j.a.createElement(G.a,null,"Input Source"),j.a.createElement(Me,{value:a,name:"inputSource",onChange:function(a){return e.props.selectInputSource(a)}},this.props.agentInputs.map((function(e){return j.a.createElement(X.a,{key:e.uuid,value:e.uuid},e.inputName)})))),j.a.createElement(B.a,{mt:8},j.a.createElement(V.a,{variant:"h6",gutterBottom:!0},"Database Cloning Constraints"),j.a.createElement(We,{container:!0},j.a.createElement(We,{item:!0,xs:8},j.a.createElement(V.a,{variant:"body1",gutterBottom:!0},"If you want to clone your database faster you can do so by excluding certain tables which are irrelevant to testing your migration. This can be changed at any time to support your specific database migration."))),j.a.createElement(B.a,{mt:8},this.outputMockConstraints())))}return j.a.createElement(B.a,null,j.a.createElement(Ee.a,null,j.a.createElement(Ie.a,null,j.a.createElement(ke.a,null,j.a.createElement(ye.a,null,"Enabled"),j.a.createElement(ye.a,null,"Name"),j.a.createElement(ye.a,null,"Tables to Extract"),j.a.createElement(ye.a,null))),j.a.createElement(fe.a,null,this.props.agentInputs.map((function(a){var t=e.props.inputs.find((function(e){return e.uuid===a.uuid})),n=!!t&&t.enabled,l="none selected";if(t)switch(t.tableSelection){case"all":l="all tables";break;case"allExclude":l=t.tables&&t.tables.length?"all tables except "+t.tables.join(", "):"all tables";break;case"specific":l=t.tables&&t.tables.length?t.tables.join(", "):"none"}else t={enabled:!1,uuid:a.uuid,tables:[],tableSelection:""};return j.a.createElement(ke.a,{key:a.uuid},j.a.createElement(ye.a,null,j.a.createElement(xe.a,{checked:n,name:"enabled",color:"primary",onChange:function(a){return e.props.handleInputChanges(a,t)}})),j.a.createElement(ye.a,null,a.inputName),j.a.createElement(ye.a,null,l),j.a.createElement(Be,null,j.a.createElement(Ue,{variant:"contained",color:"secondary",size:"small",onClick:function(){return e.props.triggerEditInputDialog(t)}},j.a.createElement(Ae.a,null),"\xa0Edit Table Selection")))})))))}return j.a.createElement(B.a,null,'Workflows require at least one input source. Ensure at least one is selected within the "Agent Settings" section in the ',j.a.createElement(Re.a,{href:"/agents"},"Agents")," page.")}},{key:"render",value:function(){var e="mockDatabaseMigration"===this.props.workflow.workflowType?"Input Source":"Input Sources";return j.a.createElement(j.a.Fragment,null,j.a.createElement(B.a,{mt:4},j.a.createElement(V.a,{variant:"h4",gutterBottom:!0},e)),j.a.createElement(M.a,{open:this.props.editInputDialog,onClose:this.props.hideInputDialog,maxWidth:"md","aria-labelledby":"dialog-title","aria-describedby":"dialog-description",fullWidth:!0},j.a.createElement(H.a,{id:"dialog-title"},"Edit Table Selection"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},this.editInputDialogContent()),j.a.createElement(Z.a,null,j.a.createElement(Ue,{color:"secondary",variant:"contained",onClick:this.props.saveInputChanges},"Update")))),j.a.createElement(B.a,{mt:8},this.outputDataSources()))}}]),t}(j.a.Component),Ke=Object(x.a)({selectAdornment:{marginRight:"-30px"}})(He),ze=t(643),Ye=t(620),$e=t(632),qe=Object(I.c)(N.a)(re.b),Ge=Object(I.c)(U.a)(re.b),Je=Object(I.c)(Ge)(s||(s=Object(F.a)(["\n  min-width: 200px;\n  max-width: 200px;\n"]))),Qe=Object(I.c)(qe)(c||(c=Object(F.a)(["\n  width: 200px;\n"]))),Xe=Object(I.c)(L.a)(re.b),Ze=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(){return Object(v.a)(this,t),a.apply(this,arguments)}return Object(C.a)(t,[{key:"render",value:function(){return j.a.createElement(j.a.Fragment,null,j.a.createElement(B.a,{mt:8},j.a.createElement(V.a,{variant:"h4",gutterBottom:!0},"Workflow Schedule Options"),j.a.createElement(B.a,{mt:4},j.a.createElement(ze.a,{"aria-label":"exportSchedule",name:"exportSchedule",onChange:this.props.handleExportSchedule,value:String(this.props.exportSchedule)},j.a.createElement(Ye.a,{value:"false",control:j.a.createElement($e.a,null),label:"Do Not Automate Workflow"}),j.a.createElement(Ye.a,{value:"true",control:j.a.createElement($e.a,null),label:"Schedule/Automate Workflow"}))),j.a.createElement(B.a,{mt:2,display:!0===this.props.exportSchedule?"block":"none"},j.a.createElement(B.a,null,j.a.createElement(Je,{fullWidth:!0},j.a.createElement(G.a,{htmlFor:"scheduleSelection"},"Schedule"),j.a.createElement(Xe,{name:"scheduleSelection",onChange:this.props.handleSchedule,value:this.props.scheduleSelection},j.a.createElement(X.a,{key:"none",value:"None"},"None"),j.a.createElement(X.a,{key:"hourly",value:"@hourly"},"Hourly"),j.a.createElement(X.a,{key:"daily",value:"@daily"},"Daily"),j.a.createElement(X.a,{key:"weekly",value:"@weekly"},"Weekly"),j.a.createElement(X.a,{key:"monthly",value:"@monthly"},"Monthly"),j.a.createElement(X.a,{key:"custom",value:"custom"},"Custom")))),j.a.createElement(B.a,{mt:4,display:!0===this.props.customSchedule?"block":"none"},j.a.createElement(Je,{fullWidth:!0},j.a.createElement(Qe,{error:this.props.errors.schedule,name:"schedule",label:"Cronjob Schedule",value:this.props.schedule,onChange:this.props.handleSchedule,InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Schedule time as a cron expression",placement:"right-start"},j.a.createElement(ne.a,null)))}}),j.a.createElement(B.a,{mt:1},"See ",j.a.createElement(Re.a,{target:"_blank",rel:"noreferrer",href:"https://crontab.guru"},j.a.createElement("b",null,"Crontab Guru"))," for help with generating cron schedule expressions."))))))}}]),t}(j.a.Component),ea=Object(I.c)(P.a)(re.b),aa=Object(I.c)(N.a)(re.b),ta=Object(I.c)(U.a)(re.b),na=Object(I.c)(ta)(d||(d=Object(F.a)(["\n  min-width: 200px;\n  max-width: 200px;\n  display: inline;\n"]))),la=Object(I.c)(aa)(u||(u=Object(F.a)(["\n  width: 200px;\n"]))),ra=Object(I.c)(_.a)(re.b),ia=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(e){var n;return Object(v.a)(this,t),(n=a.call(this,e)).displayConstraintOptions=n.displayConstraintOptions.bind(Object(S.a)(n)),n}return Object(C.a)(t,[{key:"displayConstraintOptions",value:function(){var e=this,a=this.props.currentDatabaseTable;this.props.tableOutputOptions.errors||(this.props.tableOutputOptions.errors={});var t=!!this.props.tableOutputOptions.disableDeltaUpdates;return j.a.createElement(B.a,{mt:4},j.a.createElement(na,{fullWidth:!0,variant:"outlined"},j.a.createElement(la,{error:this.props.tableOutputOptions.errors.schema,name:"schema",label:"Schema",value:this.props.constraintSchema,onChange:function(a){return e.props.handleTableOutputChanges(a)}})),j.a.createElement(B.a,{mt:4},j.a.createElement(na,{fullWidth:!0,variant:"outlined"},j.a.createElement(la,{error:this.props.tableOutputOptions.errors.table,name:"table",label:"Table",value:this.props.constraintTable,onChange:function(a){return e.props.handleTableOutputChanges(a)}}))),j.a.createElement(B.a,{mt:4},j.a.createElement(Ye.a,{control:j.a.createElement(xe.a,{checked:t,onChange:function(a){return e.props.handleTableOutputChanges(a)},name:"disableDeltaUpdates",color:"primary"}),label:"Disable Delta Updates"})),j.a.createElement(B.a,{mt:4,display:!t&&this.props.constraintSchema&&this.props.constraintTable?"block":"none"},j.a.createElement(V.a,{variant:"h5",gutterBottom:!0},"Table Constraints"),j.a.createElement(na,null,j.a.createElement(L.a,{name:"sampleFields",value:this.props.tableOutputOptions.sampleFields,onChange:function(t){return e.props.handleTableOutputChanges(t,a)}},j.a.createElement(X.a,{key:"created",value:"created"},"Created"),j.a.createElement(X.a,{key:"updated",value:"updated"},"Updated"),j.a.createElement(X.a,{key:"createdAndUpdated",value:"createdAndUpdated"},"Created or updated")),"\xa0\xa0in the last\xa0\xa0",j.a.createElement(L.a,{name:"numDays",value:this.props.tableOutputOptions.numDays,onChange:function(t){return e.props.handleTableOutputChanges(t,a)}},j.a.createElement(X.a,{key:"1",value:"1"},"day"),j.a.createElement(X.a,{key:"2",value:"2"},"2 days"),j.a.createElement(X.a,{key:"3",value:"3"},"3 days"),j.a.createElement(X.a,{key:"7",value:"7"},"1 week"),j.a.createElement(X.a,{key:"14",value:"14"},"2 weeks"),j.a.createElement(X.a,{key:"30",value:"30"},"month"),j.a.createElement(X.a,{key:"60",value:"60"},"2 months"),j.a.createElement(X.a,{key:"90",value:"90"},"3 months"),j.a.createElement(X.a,{key:"180",value:"180"},"6 months"),j.a.createElement(X.a,{key:"365",value:"365"},"year"))),j.a.createElement(B.a,{mt:4,display:this.props.tableOutputOptions.sampleFields.toLowerCase().includes("created")?"block":"none"},j.a.createElement(na,{fullWidth:!0,variant:"outlined"},j.a.createElement(la,{error:this.props.tableOutputOptions.errors.createdAtField,name:"createdAtField",label:"Created At Field Name",value:this.props.tableOutputOptions.createdAtField,onChange:function(t){return e.props.handleTableOutputChanges(t,a)},InputProps:{endAdornment:j.a.createElement(Q.a,{title:"(Required) field name in this table used for tracking created at timestamp",placement:"right-start"},j.a.createElement(ne.a,null))}}))),j.a.createElement(B.a,{mt:4,display:this.props.tableOutputOptions.sampleFields.toLowerCase().includes("updated")?"block":"none"},j.a.createElement(na,{fullWidth:!0,variant:"outlined"},j.a.createElement(la,{error:this.props.tableOutputOptions.errors.updatedAtField,name:"updatedAtField",label:"Updated At Field Name",value:this.props.tableOutputOptions.updatedAtField,onChange:function(t){return e.props.handleTableOutputChanges(t,a)},InputProps:{endAdornment:j.a.createElement(Q.a,{title:"(Required) field name in this table used for tracking updated at timestamp",placement:"right-start"},j.a.createElement(ne.a,null))}})))))}},{key:"displayConstraintsTable",value:function(){var e=this,a=this.props.exportTableDataConfig.filter((function(e){return e.numDays}));return a.length?j.a.createElement(B.a,null,j.a.createElement(ea,{justify:"space-between",container:!0,spacing:10},j.a.createElement(ea,{item:!0}),j.a.createElement(ea,{item:!0,mb:6},j.a.createElement(ra,{variant:"contained",color:"secondary",size:"small",onClick:function(a){return e.props.triggerOutputOptions(a,null)}},j.a.createElement(ae.a,null),"\xa0\xa0Set Table Output Options"))),j.a.createElement(Ee.a,null,j.a.createElement(Ie.a,null,j.a.createElement(ke.a,null,j.a.createElement(ye.a,null,"Table"),j.a.createElement(ye.a,null,"Constraint"),j.a.createElement(ye.a,null,"Delta Updates Disabled"),j.a.createElement(ye.a,null))),j.a.createElement(fe.a,null,a.map((function(a){var t=a.table,n=a.disableDeltaUpdates?"yes":"no";return j.a.createElement(ke.a,{key:t},j.a.createElement(ye.a,null,t),j.a.createElement(ye.a,null,e.props.genConstraintSummary(t)),j.a.createElement(ye.a,null,n),j.a.createElement(ye.a,null,j.a.createElement(ra,{color:"secondary",size:"small",variant:"contained",onClick:function(a){return e.props.triggerOutputOptions(a,t)}},j.a.createElement(Ae.a,null),"\xa0Edit"),"\xa0",j.a.createElement(ra,{variant:"contained",color:"default",size:"small",onClick:function(a){return e.props.deleteConstraint(a,t)}},j.a.createElement(be.a,null),"\xa0Delete")))}))))):j.a.createElement(B.a,null,j.a.createElement(ra,{variant:"contained",color:"secondary",size:"small",onClick:function(a){return e.props.triggerOutputOptions(a,null)}},j.a.createElement(ae.a,null),"\xa0\xa0Set Table Output Options"))}},{key:"render",value:function(){return this.props.allDatabaseTables?j.a.createElement(j.a.Fragment,null,j.a.createElement(B.a,null,j.a.createElement(V.a,{variant:"h4",gutterBottom:!0},"Table Data Options"),j.a.createElement(ea,{container:!0},j.a.createElement(ea,{item:!0,xs:8},j.a.createElement(V.a,{variant:"body1",gutterBottom:!0},"If you want to constrain your table outputs to a selected time range or skip attempting delta updates for specific tables you can do so by adding your configurations below. Note that if other tables depend on omitted data these relationships will be broken."))),j.a.createElement(M.a,{fullWidth:!0,open:this.props.showOutputOptions,onClose:this.props.hideOutputOptions,maxWidth:"md","aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Table Output Options"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},this.displayConstraintOptions()),j.a.createElement(Z.a,null,j.a.createElement(ra,{color:"secondary",variant:"contained",onClick:this.props.hideOutputOptions},"Update")))),j.a.createElement(B.a,{mt:8},this.displayConstraintsTable()))):null}}]),t}(j.a.Component),oa=t(549),sa=t(550),ca=t(551),da=t(625),ua=t(626),pa=Object(I.c)(P.a)(re.b),ma=Object(I.c)(N.a)(re.b),ha=Object(I.c)(U.a)(re.b),ba=Object(I.c)(ha)(p||(p=Object(F.a)(["\n  min-width: 200px;\n  max-width: 200px;\n"]))),ga=Object(I.c)(ma)(m||(m=Object(F.a)(["\n  width: 200px;\n"]))),Ea=Object(I.c)(ma)(h||(h=Object(F.a)(["\n  width: 400px;\n"]))),fa=Object(I.c)(ma)(b||(b=Object(F.a)(["\n  width: 600px;\n"]))),ka={fontWeight:"bold"},ya=Object(I.c)(me.a)(re.b),wa=Object(x.a)({root:{display:"block"}})(q.a),va=Object(x.a)({root:{whiteSpace:"nowrap"}})(ye.a),Ca=Object(I.c)(pe.a)(re.b),Sa=Object(I.c)(_.a)(re.b),Da=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(){return Object(v.a)(this,t),a.apply(this,arguments)}return Object(C.a)(t,[{key:"databaseEngine",value:function(e){var a="";switch(e){case"postgresql":a="PostgreSQL"}return a}},{key:"dataFeedName",value:function(e){var a="";switch(e){case"digitalTwin":a="Create a PII-free Digital Twin/Clone";break;case"s3upload":a="Upload/Sync Data to an Amazon S3 bucket";break;case"custom":a="Custom Container/Plugin"}return a}},{key:"dataFeedSummary",value:function(e){var a="",t=e.dataFeedConfig.S3UploadBucket;switch(e.dataFeedConfig.S3UploadBucket&&!e.dataFeedConfig.S3UploadBucket.match(/^s3:\/\//)&&(t="s3://"+e.dataFeedConfig.S3UploadBucket),e.dataFeed){case"digitalTwin":if(a="Data will be cloned to your "+this.databaseEngine(e.dataFeedConfig.databaseEngine)+" database and will be ",a+=e.dataFeedConfig.enableDeltaUpdates?"updated with new data":"reset to match the original data",e.dataFeedConfig.enablePostUpdatePreparedStatements){var n=[];e.dataFeedConfig.postUpdateKeyValues.forEach((function(e){e.key&&e.value&&n.push(e.value)})),n.length&&(a+=". After each time the workflow runs your data will be modified with the following values: "+n.join(", ")+".")}break;case"s3upload":a="Upload tables to "+t;break;case"custom":a="Invoke custom container "+e.dataFeedConfig.image+":"+e.dataFeedConfig.tag}return a}},{key:"outputTable",value:function(){var e=this;return this.props.dataFeeds&&this.props.dataFeeds.length?j.a.createElement(B.a,null,j.a.createElement(pa,{justify:"space-between",container:!0,spacing:10},j.a.createElement(pa,{item:!0}),j.a.createElement(pa,{item:!0,mb:6},j.a.createElement(Sa,{variant:"contained",color:"secondary",size:"small",onClick:this.props.addDataFeed},j.a.createElement(ae.a,null),"\xa0 Add Data Feed"))),j.a.createElement(Ee.a,null,j.a.createElement(Ie.a,null,j.a.createElement(ke.a,null,j.a.createElement(ye.a,null,"Data Feed"),j.a.createElement(ye.a,null,"Summary"),j.a.createElement(ye.a,null))),j.a.createElement(fe.a,null,this.props.dataFeeds.map((function(a){return j.a.createElement(ke.a,{key:a.uuid},j.a.createElement(ye.a,null,e.dataFeedName(a.dataFeed)),j.a.createElement(ye.a,null,e.dataFeedSummary(a)),j.a.createElement(va,null,j.a.createElement(Sa,{variant:"contained",color:"secondary",size:"small",onClick:function(){return e.props.triggerEditDataFeed(a)}},j.a.createElement(Ae.a,null),"\xa0Edit"),"\xa0",j.a.createElement(Sa,{variant:"contained",color:"default",size:"small",onClick:function(){return e.props.deleteDataFeed(a)}},j.a.createElement(be.a,null),"\xa0Delete")))}))))):j.a.createElement(B.a,null,j.a.createElement(Sa,{variant:"contained",color:"secondary",size:"small",onClick:this.props.addDataFeed},j.a.createElement(ae.a,null),"\xa0 Add Data Feed"))}},{key:"showErrors",value:function(){return this.props.errors.duplicateDataFeed?j.a.createElement(ya,{mb:4,severity:"error"},"You can only create one of each type of Data Feed"):this.props.errors.invalidBucketName?j.a.createElement(ya,{mb:4,severity:"error"},"Invalid Amazon S3 bucket name. ",j.a.createElement(Re.a,{target:"_blank",href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucketnamingrules.html"},"Naming guidelines")):this.props.errors.invalidPostUpdateKeyValues?j.a.createElement(ya,{mb:4,severity:"error"},"Invalid parameter key or value. Parameters must not be empty and must not contain %, (, or ) characters"):this.props.errors.invalidSecret?j.a.createElement(ya,{mb:4,severity:"error"},"One or more of your secrets is missing a value - all fields are required"):null}},{key:"getAgent",value:function(){var e=this,a=this.props.agents.filter((function(a){return a.uuid===e.props.workflow.agentId}));return a.length?a[0]:{configPath:"",namespace:""}}},{key:"render",value:function(){var e=this,a=this.props.dataFeed.feedSecrets.length?j.a.createElement("p",null,"Be sure that any secrets that need to be attached to your post-processing Docker container exist in this same Kubernetes namespace."):"";return j.a.createElement(j.a.Fragment,null,j.a.createElement(B.a,{mt:8},j.a.createElement(V.a,{variant:"h4",gutterBottom:!0},"Data Feeds"),j.a.createElement(M.a,{open:this.props.editDataFeed,onClose:this.props.hideDataFeed,fullWidth:!0,maxWidth:"md","aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},this.props.dataFeed.uuid.match(/^new/)?"Add":"Edit"," Data Feed"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},this.showErrors(),j.a.createElement(B.a,{display:""===this.props.dataFeed.dataFeed?"block":"none"},j.a.createElement(oa.a,{component:"nav","aria-label":"data feed selection"},j.a.createElement(sa.a,{disabled:!("ERL"===this.props.workflow.workflowType),button:!0,onClick:function(){return e.props.handleDataFeed("digitalTwin")}},j.a.createElement(ca.a,{primary:"Create a PII-free Digital Twin/Clone",primaryTypographyProps:{style:ka},secondary:"Creates a PII-free clone of your data to a target/output database. Any data written in the target tables is replaced by the data from your source/input."})),j.a.createElement(sa.a,{disabled:!("ERL"===this.props.workflow.workflowType),button:!0,onClick:function(){return e.props.handleDataFeed("s3upload")}},j.a.createElement(ca.a,{primary:"Upload/Sync Data to an Amazon S3 Bucket",primaryTypographyProps:{style:ka},secondary:"Upload your table data CSV files to an Amazon S3 bucket."})),j.a.createElement(sa.a,{disabled:!("ERL"===this.props.workflow.workflowType),button:!0,onClick:function(){return e.props.handleDataFeed("custom")}},j.a.createElement(ca.a,{primary:"Configure a Custom Container/Plugin",primaryTypographyProps:{style:ka},secondary:"Trigger your own custom container to carry out work of your choosing."})))),j.a.createElement(B.a,{mt:8,display:"digitalTwin"===this.props.dataFeed.dataFeed?"block":"none"},j.a.createElement(V.a,{variant:"h4",gutterBottom:!0},"Digital Twin Options"),j.a.createElement("p",null,"Adding this data feed will require updating your Agent configuration file (provided within the ",j.a.createElement(Re.a,{href:"/agents",target:"_blank"},"Agents"),' page), replacing the "changeme"s for connection ID ',j.a.createElement("code",null,this.props.dataFeed.uuid)," with the specified connection info for this data source."),j.a.createElement("p",null,j.a.createElement("b",null,"This feature does not prevent you from accidentally destroying data by selecting the wrong output destination!")," Your output destination will be populated with the entire public schema, the schema of your selected tables from your data source, and the table data from your selected tables. We strongly advise that your output destination be an empty/unused database (you can create a new database with the ",j.a.createElement("code",null,"create database")," SQL command) in order to avoid collisions and unintended overwriting."),j.a.createElement(B.a,{mt:4},j.a.createElement(ba,{margin:"dense",fullWidth:!0},j.a.createElement(G.a,null,"Output Destination"),j.a.createElement(L.a,{value:this.props.dataFeed.dataFeedConfig.inputSource,name:"inputSource",onChange:function(a){return e.props.handleDataFeedOptions(a)}},this.props.workflow.allOutputs.map((function(e){return j.a.createElement(X.a,{key:e.uuid,value:e.uuid},e.inputName)}))))),j.a.createElement(B.a,{mt:4},j.a.createElement(Ye.a,{control:j.a.createElement(xe.a,{checked:this.props.dataFeed.dataFeedConfig.enableDeltaUpdates,onChange:function(a){return e.props.handleDataFeedOptions(a)},name:"enableDeltaUpdates",color:"primary"}),label:"Enable Delta Updates"}),j.a.createElement(B.a,null,"After your initial job has run your workflow performance can be increased substantially by only transferring changed data, rather than recreating tables from scratch. Leave this disabled to hard-reset your data each time your workflow runs.")),j.a.createElement(B.a,{mt:4,display:this.props.dataFeed.dataFeedConfig.enableDeltaUpdates?"block":"none"},j.a.createElement(ba,{fullWidth:!0},j.a.createElement(ga,{error:this.props.errors.invalidDeltaUpdateField,name:"deltaUpdateField",value:this.props.dataFeed.dataFeedConfig.deltaUpdateField,onChange:function(a){return e.props.handleDataFeedOptions(a)},label:"Updated Date Field Name",InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:'Field name in your table that contains the timestamp tracking the last updated date, e.g. "updated_at"',placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(B.a,{mt:4},j.a.createElement(Ye.a,{control:j.a.createElement(xe.a,{checked:this.props.dataFeed.dataFeedConfig.enablePostUpdatePreparedStatements,onChange:function(a){return e.props.handleDataFeedOptions(a)},name:"enablePostUpdatePreparedStatements",color:"primary"}),label:"Enable Custom Data Updates"}),j.a.createElement(B.a,null,"Run custom SQL commands after your workflows run to make custom updates to your data. One use case for this is personalizing demos (e.g. to specify the name and logo of the company you are demoing to). To do so, you'll need to define a prepared SQL statement (i.e. an SQL command supporting parameters), as well as the values for these parameters."),j.a.createElement(B.a,{mt:4,display:this.props.dataFeed.dataFeedConfig.enablePostUpdatePreparedStatements?"block":"none"},j.a.createElement(B.a,null,"As an example, in ",j.a.createElement("code",null,"UPDATE company SET name=%(company_name)s, logo=%(logo)s WHERE source_primary_key=%(company_id)s"),", the three parameters in this prepared SQL statement are ",j.a.createElement("code",null,"company_name"),", ",j.a.createElement("code",null,"logo"),", and ",j.a.createElement("code",null,"company_id"),". See below for the instructions for defining your prepared statements, and click on the ",j.a.createElement("b",null,"Add Parameter Value")," button below these instructions to define the key/value pairs for each parameter in your prepared statement(s). For example, for the company_name parameter your parameter key would be ",j.a.createElement("code",null,"company_name"),", and your parameter value: ",j.a.createElement("code",null,"Company we are demoing to"),"."),j.a.createElement(B.a,{mt:4},j.a.createElement(Ca,{variant:"outlined"},j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Prepared Statement Setup Instructions")),j.a.createElement(wa,null,j.a.createElement(B.a,null,"Prepared statements are SQL commands saved as Kubernetes secrets. Here is an example prepared statement: ",j.a.createElement("code",null,"UPDATE company SET name=%(name)s, logo=%(logo)s WHERE source_primary_key=%(company_id)s"),". In this example ",j.a.createElement("code",null,"name"),", ",j.a.createElement("code",null,"logo")," and ",j.a.createElement("code",null,"company_id")," are placeholder parameters requiring values, which you'll set below. Parameter key/value pairs are required rather than entire SQL commands for security reasons, and to make it easy for anybody in your company to change these values without running the risk of corrupting your data. To create this secret as per this example:",j.a.createElement("br",null),j.a.createElement("br",null),j.a.createElement("code",null,"kubectl create secret -n ",this.getAgent().namespace,' generic digital-twin --from-literal=prepared-statements="UPDATE company SET name=%(name)s, logo=%(logo)s WHERE source_primary_key=%(company_id)s;"'),j.a.createElement("br",null),j.a.createElement("br",null),"Create your own prepared statements by replacing what is quoted here.",j.a.createElement("br",null),j.a.createElement("br",null),"Multiple SQL commands are supported, separated by semicolons, and please note that the format of ",j.a.createElement("code",null,"%(your_variable)s")," is required for all variable types (including non-strings) - the correct type will be automatically cast. All paraemters require that a value is provided."))))),j.a.createElement(B.a,{mt:4},j.a.createElement(Ee.a,{size:"small",style:{width:"auto"}},j.a.createElement(fe.a,null,this.props.dataFeed.dataFeedConfig.postUpdateKeyValues.map((function(a,t){return j.a.createElement(ke.a,{key:t},j.a.createElement(ye.a,{style:{paddingLeft:0}},j.a.createElement(ba,null,j.a.createElement(ga,{variant:"outlined",margin:"dense",name:"parameterKey",value:a.key,onChange:function(a){return e.props.updateParameterValue(t,a)},label:"Parameter Key"}))),j.a.createElement(ye.a,null,j.a.createElement(ba,null,j.a.createElement(ga,{variant:"outlined",margin:"dense",name:"parameterValue",value:a.value,onChange:function(a){return e.props.updateParameterValue(t,a)},label:"Parameter Value"}))),j.a.createElement(ye.a,null,j.a.createElement(Sa,{variant:"contained",color:"secondary",size:"small",onClick:function(){return e.props.deleteParameterValue(t)}},j.a.createElement(be.a,null))))})))),j.a.createElement(B.a,{mt:4},j.a.createElement(Sa,{variant:"contained",color:"secondary",size:"small",onClick:this.props.addParameterValue},j.a.createElement(ae.a,null),"\xa0\xa0Add Parameter Value")))))),j.a.createElement(B.a,{mt:8,display:"s3upload"===this.props.dataFeed.dataFeed?"block":"none"},j.a.createElement(V.a,{variant:"h4",gutterBottom:!0},"Amazon S3 File Upload Options"),j.a.createElement(B.a,{mt:8},j.a.createElement(ba,{fullWidth:!0,variant:"outlined"},j.a.createElement(Ea,{name:"S3UploadBucket",error:this.props.errors.invalidBucketName,onChange:function(a){return e.props.handleDataFeedOptions(a)},value:this.props.dataFeed.dataFeedConfig.S3UploadBucket,label:"S3 Bucket",InputProps:{startAdornment:j.a.createElement(J.a,{position:"start"},j.a.createElement("b",null,"S3://"))}}))),j.a.createElement(B.a,{mt:8},j.a.createElement(Ca,{variant:"outlined"},j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Plugin Requirements")),j.a.createElement(wa,null,j.a.createElement("p",null,"This plugin requires an AWS access key ID and secret access key pair to authenticate to the provided bucket. Create an AWS credentials file in the style of the ",j.a.createElement("code",null,"~/.aws/credentials")," example provided ",j.a.createElement(Re.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html",target:"_blank"},"here")," and run the following command to create a secret in your Kubernetes cluster namespace as the contents of this file:"),j.a.createElement("p",null,j.a.createElement("code",null,"kubectl create secret generic aws -n ",this.props.agentNamespace||"unknown_namespace"," --from-file=/path/to/aws/credentials"))))))),j.a.createElement(B.a,{mt:8,display:"custom"===this.props.dataFeed.dataFeed?"block":"none"},j.a.createElement(B.a,null,j.a.createElement(V.a,{variant:"h4",gutterBottom:!0},"Custom Container/Plugin Configuration"),j.a.createElement("p",null,"Some documentation for developing your own custom container/plugin can be found on the ",j.a.createElement(Re.a,{href:"/developers",target:"_blank"},"developers page"),".")),j.a.createElement(B.a,{mt:4},j.a.createElement(Ea,{name:"image",error:this.props.errors.image,value:this.props.dataFeed.dataFeedConfig.image,onChange:function(a){return e.props.handleDataFeedOptions(a)},label:"Docker Image",placeholder:"amazon/aws-cli",InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Docker image URL (Dockerhub example: 'amazon/aws-cli')",placement:"right-start"},j.a.createElement(ne.a,null)))}})),j.a.createElement(B.a,{mt:4},j.a.createElement(Ea,{name:"tag",error:this.props.errors.tag,value:this.props.dataFeed.dataFeedConfig.tag,onChange:function(a){return e.props.handleDataFeedOptions(a)},label:"Docker Image Tag",placeholder:"latest",InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Image tag/version (e.g. 'latest', '5.0.0')",placement:"right-start"},j.a.createElement(ne.a,null)))}})),j.a.createElement(B.a,{mt:4},j.a.createElement(Ea,{name:"shell",error:this.props.errors.shell,value:this.props.dataFeed.dataFeedConfig.shell,onChange:function(a){return e.props.handleDataFeedOptions(a)},label:"Shell Path",placeholder:"/bin/bash",InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Custom container commands will be prefaced with this shell path, i.e. <shell path> -c '<command>' '<args>'",placement:"right-start"},j.a.createElement(ne.a,null)))}})),j.a.createElement(B.a,{mt:4},j.a.createElement(fa,{name:"command",multiline:!0,rowsMax:"4",value:this.props.dataFeed.dataFeedConfig.command,onChange:function(a){return e.props.handleDataFeedOptions(a)},label:"Command (optional)",InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Optional command to override container default, in Docker this field name is 'entrypoint'.",placement:"right-start"},j.a.createElement(ne.a,null)))}})),j.a.createElement(B.a,{mt:4},j.a.createElement(fa,{name:"args",multiline:!0,rowsMax:"4",value:this.props.dataFeed.dataFeedConfig.args,onChange:function(a){return e.props.handleDataFeedOptions(a)},label:"Args (optional)",InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Optional command to override container default, in Docker this field name is 'cmd'.",placement:"right-start"},j.a.createElement(ne.a,null)))}})),j.a.createElement(Sa,{variant:"contained",color:"secondary",mt:4,size:"small",onClick:function(){e.props.addSecret("volume")}},j.a.createElement(da.a,null),"\xa0 Attach Secret Disk/Volume to Container"),"\xa0",j.a.createElement(Sa,{variant:"contained",color:"secondary",mt:4,size:"small",onClick:function(){e.props.addSecret("env")}},j.a.createElement(ua.a,null),"\xa0 Attach Environment Variable to Container"),j.a.createElement(B.a,{mt:8},a,j.a.createElement(Ee.a,{size:"small",style:{width:"auto"}},j.a.createElement(fe.a,null,this.props.dataFeed.feedSecrets.map((function(a,t){return"volume"===a.secretType?j.a.createElement(ke.a,{key:t},j.a.createElement(ye.a,{style:{paddingLeft:0}},j.a.createElement(da.a,null)),j.a.createElement(ye.a,null,j.a.createElement(ba,{fullWidth:!0},j.a.createElement(ga,{name:"secretName",value:a.secretName,label:"Secret Name",variant:"outlined",margin:"dense",onChange:function(a){return e.props.handleCustomSecret(a,t)},InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Kubernetes secret name as it appears in 'kubectl get secrets'",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(ye.a,null,j.a.createElement(ba,{fullWidth:!0},j.a.createElement(ga,{name:"secretKey",value:a.secretKey,label:"Secret Key",variant:"outlined",margin:"dense",onChange:function(a){return e.props.handleCustomSecret(a,t)},InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Kubernetes secret key contained within this secret",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(ye.a,null,j.a.createElement(ba,{fullWidth:!0},j.a.createElement(ga,{name:"secretPath",value:a.secretPath,label:"Secret Container Path",variant:"outlined",margin:"dense",onChange:function(a){return e.props.handleCustomSecret(a,t)},InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Path to mount this secret within your container",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(ye.a,null,j.a.createElement(Sa,{variant:"contained",size:"small",color:"secondary",onClick:function(){return e.props.handleDeleteSecret(t)}},j.a.createElement(be.a,null),"\xa0\xa0Delete"))):"env"===a.secretType?j.a.createElement(ke.a,null,j.a.createElement(ye.a,{style:{paddingLeft:0}},j.a.createElement(ua.a,null)),j.a.createElement(ye.a,null,j.a.createElement(ba,{fullWidth:!0},j.a.createElement(ga,{name:"secretName",value:a.secretName,label:"Secret Name",variant:"outlined",margin:"dense",onChange:function(a){return e.props.handleCustomSecret(a,t)},InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Kubernetes secret name as it appears in 'kubectl get secrets'",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(ye.a,null,j.a.createElement(ba,{fullWidth:!0},j.a.createElement(ga,{name:"secretKey",value:a.secretKey,label:"Secret Key",variant:"outlined",margin:"dense",onChange:function(a){return e.props.handleCustomSecret(a,t)},InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Kubernetes secret key contained within this secret",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(ye.a,null,j.a.createElement(ba,{fullWidth:!0},j.a.createElement(ga,{name:"envName",value:a.envName,label:"Variable Name",variant:"outlined",margin:"dense",onChange:function(a){return e.props.handleCustomSecret(a,t)},InputProps:{endAdornment:j.a.createElement(J.a,{position:"end"},j.a.createElement(Q.a,{title:"Environment variable name to be presented to this container, often in all caps",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(ye.a,null,j.a.createElement(Sa,{variant:"contained",size:"small",color:"secondary",onClick:function(){return e.props.handleDeleteSecret(t)}},j.a.createElement(be.a,null),"\xa0\xa0Delete"))):null}))))))),j.a.createElement(Z.a,null,j.a.createElement(B.a,{display:""!==this.props.dataFeed.dataFeed?"block":"none"},j.a.createElement(Sa,{color:"default",variant:"contained",onClick:this.props.handleDataFeedBack},"Back"),"\xa0",j.a.createElement(Sa,{color:"secondary",variant:"contained",onClick:this.props.saveDataFeedChanges},"Update")),j.a.createElement(B.a,{display:""===this.props.dataFeed.dataFeed?"block":"none"},j.a.createElement(Sa,{color:"secondary",onClick:this.props.handleDataFeedCancel},"Cancel"))))),j.a.createElement(pa,{container:!0},j.a.createElement(pa,{item:!0,xs:8},j.a.createElement(V.a,{variant:"body1",gutterBottom:!0},"Data feeds provide several options for populating and/or syncing data with your No PII Zone on a recurring basis and sharing data with your internal and external stakeholders. With or without a data feed you can retrieve output files via the ",j.a.createElement("code",null,"Download Export")," command provided by the ",j.a.createElement(Re.a,{href:"/developers",target:"_blank"},"Redactics Agent CLI"),"."))),j.a.createElement(B.a,{mt:8},this.outputTable())))}}]),t}(j.a.Component),Oa=Object(I.c)(N.a)(re.b),Fa=Object(I.c)(U.a)(re.b),Ta=Object(I.c)(Fa)(g||(g=Object(F.a)(["\n  min-width: 200px;\n  max-width: 200px;\n"]))),ja=Object(I.c)(Oa)(E||(E=Object(F.a)(["\n  width: 200px;\n"]))),Ia=Object(x.a)({root:{display:"block"}})(q.a),xa=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(){return Object(v.a)(this,t),a.apply(this,arguments)}return Object(C.a)(t,[{key:"render",value:function(){var e=this,a="\n{{- if .Values.global.databaseMigrations.mock }}\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: trigger-db-migration-mock-{{ .Release.Revision }}\n  namespace: ".concat(this.props.workflow.migrationNamespace||"default",'\n  annotations:\n    "helm.sh/hook": pre-upgrade\n    "helm.sh/hook-weight": "').concat(this.props.workflow.migrationHelmHookWeight||"0",'"\n    "helm.sh/hook-delete-policy": hook-succeeded\nspec:\n  template:\n    spec:\n      restartPolicy: Never\n      containers:\n        - name: trigger-db-migration-mock\n          image: redactics/airflow-dagrun-poller:1.1.0\n          imagePullPolicy: Always\n          args:\n          - bash\n          - -c\n          - |\n              DAG_RUN_ID=$(curl -s -X POST -d "{\\"workflowType\\": \\"mockDatabaseMigration\\", \\"workflowId\\": \\"${WORKFLOW_ID}\\"}" -H "Content-Type: application/json" -H "Accept: application/json" ${REDACTICS_API_URL}/workflow/jobs | jq -r \'.uuid\')\n              curl -s -X POST -H "Authorization: Basic ${BASIC_AUTH}" -H "Content-Type: application/json" -H "Accept: application/json" -d "{\\"dag_run_id\\": \\"${DAG_RUN_ID}\\", \\"conf\\": {\\"workflowJobId\\": \\"${DAG_RUN_ID}\\"}}" ${API_URL}/api/v1/dags/${DAG_ID}/dagRuns\n              TAIL_TASK_ID=clone-db DAG_RUN_ID=${DAG_RUN_ID} /poller.sh\n              if [ $? -ne 0 ]; then\n                exit 1\n              fi\n          env:\n          - name: REDACTICS_API_URL\n            value: http://agent-api.svc.cluster.local\n          - name: API_URL\n            value: http://agent-webserver.').concat(this.props.agentNamespace,".svc.cluster.local:8080\n          - name: DAG_ID\n            value: ").concat(this.props.workflow.uuid,"-migrationmocking\n          - name: WORKFLOW_ID\n            value: ").concat(this.props.workflow.uuid,"\n          - name: BASIC_AUTH\n            valueFrom:\n              secretKeyRef:\n                name: agent\n                key: basic-auth\n{{- end }}"),t='\n#!/bin/bash\n\n# change values as necessary, this script will work when running inside a Kubernetes container, and when the\n# BASIC_AUTH variable is set outside of this script from values stored as Kubernetes secrets.\n# The open source libraries "curl" and "jq" must be available within this environment, in addition to the poller.sh script.\n\nexport REDACTICS_API_URL=http://agent-api.svc.cluster.local\nexport API_URL=http://agent-webserver.'.concat(this.props.agentNamespace,".svc.cluster.local:8080\nexport DAG_ID=").concat(this.props.workflow.uuid,"-migrationmocking\nexport WORKFLOW_ID=").concat(this.props.workflow.uuid,'\nexport POLLER_PATH=/poller.sh\n\nDAG_RUN_ID=$(curl -s -X POST -d "{\\"workflowType\\": \\"mockDatabaseMigration\\", \\"workflowId\\": \\"${WORKFLOW_ID}\\"}" -H "Content-Type: application/json" -H "Accept: application/json" ${REDACTICS_API_URL}/workflow/jobs | jq -r \'.uuid\')\ncurl -s -X POST -H "Authorization: Basic ${BASIC_AUTH}" -H "Content-Type: application/json" -H "Accept: application/json" -d "{\\"dag_run_id\\": \\"${DAG_RUN_ID}\\", \\"conf\\": { \\"workflowJobId\\": \\"${DAG_RUN_ID}\\"}}" ${API_URL}/api/v1/dags/${DAG_ID}/dagRuns\nTAIL_TASK_ID=clone-db DAG_RUN_ID=${DAG_RUN_ID} ${POLLER_PATH}\n    ');return j.a.createElement(j.a.Fragment,null,j.a.createElement(B.a,null,"Performing a dry run of your migrations requires your adding a step to your CI/CD pipeline (or manual deployment process) to trigger a workflow included in the Redactics Agent. This workflow clones your database to prepare for your database migration dry-run against this clone. Once this step is complete you can then run your migration using an environment variable to override your database that would normally be used with your cloned database."),j.a.createElement(B.a,{mt:4},"One way to put together a complete working flow is to add some sort of flag in your CI/CD workflow that triggers this alteration to your normal workflow when this database migration dry-run option is selected, followed by the database migration against the clone. This can be done by triggering a script that runs on your server hosting your app, or if your database migration is triggered via a Kubernetes Helmchart hook, adding an additional hook that runs before your normal migration hook."),j.a.createElement(B.a,{mt:4},"Using the values you provide here, we will generate the code needed to perform this additional step (prior to your normal database migration) which you can customize as needed. We will also generate an authentication token for the REST API embedded into the Redactics Agent. This secret will be installed into your Kubernetes namespace (as you've provided below) the next time you upgrade your Redactics Agent software."),j.a.createElement(B.a,{mt:8},j.a.createElement(Ta,{fullWidth:!0},j.a.createElement(ja,{name:"migrationNamespace",label:"Kubernetes Namespace",value:this.props.workflow.migrationNamespace,onChange:function(a){return e.props.handleWFChanges(a,e.props.workflow.uuid)},InputProps:{endAdornment:j.a.createElement(J.a,{className:this.props.classes.selectAdornment,position:"end"},j.a.createElement(Q.a,{title:"Kubernetes namespace where your database migrations run",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(B.a,{mt:4},j.a.createElement(Ta,{fullWidth:!0},j.a.createElement(ja,{name:"migrationDatabase",label:"Database Name",value:this.props.workflow.migrationDatabase,onChange:function(a){return e.props.handleWFChanges(a,e.props.workflow.uuid)},InputProps:{endAdornment:j.a.createElement(J.a,{className:this.props.classes.selectAdornment,position:"end"},j.a.createElement(Q.a,{title:"Database name of database that should be cloned",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(B.a,{mt:4},j.a.createElement(Ta,{fullWidth:!0},j.a.createElement(ja,{name:"migrationDatabaseClone",label:"Cloned Database Name",value:this.props.workflow.migrationDatabaseClone,onChange:function(a){return e.props.handleWFChanges(a,e.props.workflow.uuid)},InputProps:{endAdornment:j.a.createElement(J.a,{className:this.props.classes.selectAdornment,position:"end"},j.a.createElement(Q.a,{title:"Database name for your clone",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(B.a,{mt:4},j.a.createElement(Ta,{fullWidth:!0},j.a.createElement(G.a,{htmlFor:"agent"},"Generate Configuration For"),j.a.createElement(L.a,{name:"migrationConfiguration",value:this.props.workflow.migrationConfiguration,onChange:function(a){return e.props.handleWFChanges(a,e.props.workflow.uuid)}},j.a.createElement(X.a,{key:"helmhook",value:"helmhook"},"Sample Helmchart Hook"),j.a.createElement(X.a,{key:"script",value:"script"},"Sample Script")))),j.a.createElement(B.a,{mt:4,display:"helmhook"===this.props.workflow.migrationConfiguration?"block":"none"},j.a.createElement(Ta,{fullWidth:!0},j.a.createElement(ja,{name:"migrationHelmHookWeight",type:"number",label:"Helmchart Hook Weight",value:this.props.workflow.migrationHelmHookWeight||"0",onChange:function(a){return e.props.handleWFChanges(a,e.props.workflow.uuid)},InputProps:{endAdornment:j.a.createElement(J.a,{className:this.props.classes.selectAdornment,position:"end"},j.a.createElement(Q.a,{title:"Helmchart hook weight (hooks are executed in ascending order)",placement:"right-start"},j.a.createElement(ne.a,null)))}}))),j.a.createElement(B.a,{mt:8,display:"helmhook"===this.props.workflow.migrationConfiguration?"block":"none"},j.a.createElement(pe.a,{variant:"outlined"},j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Sample Helmchart Hook")),j.a.createElement(Ia,null,j.a.createElement(B.a,null,j.a.createElement(oe.CopyToClipboard,{text:a,onCopy:function(){return e.props.clipboardCopy("sampleMigrationHook")}},j.a.createElement(_.a,{variant:"outlined",size:"small",color:"secondary"},j.a.createElement(ge.a,null)))),j.a.createElement(B.a,{mt:2},j.a.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"}},a)))))),j.a.createElement(B.a,{mt:8,display:"script"===this.props.workflow.migrationConfiguration?"block":"none"},j.a.createElement(pe.a,{variant:"outlined"},j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Sample Script")),j.a.createElement(Ia,null,j.a.createElement(B.a,null,j.a.createElement(oe.CopyToClipboard,{text:t,onCopy:function(){return e.props.clipboardCopy("sampleMigrationScript")}},j.a.createElement(_.a,{variant:"outlined",size:"small",color:"secondary"},j.a.createElement(ge.a,null)))),j.a.createElement(B.a,{mt:2},j.a.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"}},t)))))))}}]),t}(j.a.Component),Ra=Object(x.a)({selectAdornment:{marginRight:"-30px"}})(xa),Aa=Object(I.c)(se.a)(re.b),Wa=Object(I.c)(P.a)(re.b),Ua=Object(I.c)(_.a)(re.b),Pa=Object(I.c)(me.a)(re.b),Na=Object(I.c)(U.a)(re.b),La=Object(I.c)(Na)(f||(f=Object(F.a)(["\n  min-width: 200px;\n  max-width: 200px;\n"]))),_a=Object(I.c)(L.a)(re.b),Va=Object(x.a)({root:{display:"block"}})(q.a),Ba=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(e){var n;Object(v.a)(this,t),(n=a.call(this,e)).handleSnackbarClose=function(){n.setState({showSnackbar:!1,showSnackbarEdit:!1,showClipboardSnackbar:!1})},n.handleEditWorkflowSnackbarClose=function(){n.setState({showSnackbarEdit:!1})},n.saveChanges=n.saveChanges.bind(Object(S.a)(n)),n.hideHelmReminder=n.hideHelmReminder.bind(Object(S.a)(n)),n.toggleHelmReminder=n.toggleHelmReminder.bind(Object(S.a)(n)),n.addMaskingRule=n.addMaskingRule.bind(Object(S.a)(n)),n.deleteMaskingRule=n.deleteMaskingRule.bind(Object(S.a)(n)),n.handleRuleChange=n.handleRuleChange.bind(Object(S.a)(n)),n.showLastReportedError=n.showLastReportedError.bind(Object(S.a)(n)),n.hideLastReportedError=n.hideLastReportedError.bind(Object(S.a)(n)),n.addSecret=n.addSecret.bind(Object(S.a)(n)),n.handleDeleteSecret=n.handleDeleteSecret.bind(Object(S.a)(n)),n.hideErrorDialog=n.hideErrorDialog.bind(Object(S.a)(n)),n.handleExportSchedule=n.handleExportSchedule.bind(Object(S.a)(n)),n.handleSchedule=n.handleSchedule.bind(Object(S.a)(n)),n.handleDeltaUpdate=n.handleDeltaUpdate.bind(Object(S.a)(n)),n.handleCustomSecret=n.handleCustomSecret.bind(Object(S.a)(n)),n.validateRedactionRules=n.validateRedactionRules.bind(Object(S.a)(n)),n.handleTableOutputChanges=n.handleTableOutputChanges.bind(Object(S.a)(n)),n.deleteWorkflowConfirmation=n.deleteWorkflowConfirmation.bind(Object(S.a)(n)),n.cancelWorkflowConfirmation=n.cancelWorkflowConfirmation.bind(Object(S.a)(n)),n.clipboardCopy=n.clipboardCopy.bind(Object(S.a)(n)),n.handleSnackbarClose=n.handleSnackbarClose.bind(Object(S.a)(n)),n.getExportFileNames=n.getExportFileNames.bind(Object(S.a)(n)),n.saveInputChanges=n.saveInputChanges.bind(Object(S.a)(n)),n.triggerEditInputDialog=n.triggerEditInputDialog.bind(Object(S.a)(n)),n.handleInputChanges=n.handleInputChanges.bind(Object(S.a)(n)),n.selectInputSource=n.selectInputSource.bind(Object(S.a)(n)),n.handleAddTable=n.handleAddTable.bind(Object(S.a)(n)),n.triggerAddTable=n.triggerAddTable.bind(Object(S.a)(n)),n.hideInputDialog=n.hideInputDialog.bind(Object(S.a)(n)),n.deleteDatabaseTable=n.deleteDatabaseTable.bind(Object(S.a)(n)),n.deleteWorkflow=n.deleteWorkflow.bind(Object(S.a)(n)),n.transformExpansion=n.transformExpansion.bind(Object(S.a)(n)),n.triggerOutputOptions=n.triggerOutputOptions.bind(Object(S.a)(n)),n.deleteConstraint=n.deleteConstraint.bind(Object(S.a)(n)),n.hideOutputOptions=n.hideOutputOptions.bind(Object(S.a)(n)),n.genConstraintSummary=n.genConstraintSummary.bind(Object(S.a)(n)),n.addDataFeed=n.addDataFeed.bind(Object(S.a)(n)),n.hideDataFeed=n.hideDataFeed.bind(Object(S.a)(n)),n.handleDataFeed=n.handleDataFeed.bind(Object(S.a)(n)),n.addParameterValue=n.addParameterValue.bind(Object(S.a)(n)),n.updateParameterValue=n.updateParameterValue.bind(Object(S.a)(n)),n.deleteParameterValue=n.deleteParameterValue.bind(Object(S.a)(n)),n.handleDataFeedBack=n.handleDataFeedBack.bind(Object(S.a)(n)),n.handleDataFeedCancel=n.handleDataFeedCancel.bind(Object(S.a)(n)),n.handleDataFeedOptions=n.handleDataFeedOptions.bind(Object(S.a)(n)),n.saveDataFeedChanges=n.saveDataFeedChanges.bind(Object(S.a)(n)),n.triggerEditDataFeed=n.triggerEditDataFeed.bind(Object(S.a)(n)),n.deleteDataFeed=n.deleteDataFeed.bind(Object(S.a)(n)),n.resetDataFeedErrors=n.resetDataFeedErrors.bind(Object(S.a)(n)),n.addTableSelection=n.addTableSelection.bind(Object(S.a)(n)),n.deleteTableSelection=n.deleteTableSelection.bind(Object(S.a)(n));var l=[];n.props.workflow.redactrules&&n.props.workflow.redactrules.length&&n.props.workflow.redactrules.forEach((function(e){var a=e.table.split("."),t=a.length?a[0]:"public",n=a.length?a[1]:"";l.push({key:e.uuid,schema:t,table:n,databaseTable:e.databaseTable,column:e.column,rule:e.rule,presetUuid:e.presetUuid})}));var r=n.props.agents.find((function(e){return e.uuid===n.props.workflow.agentId})),i=r?r.namespace:"",o={agentId:n.props.workflow.agentId,newRuleKey:0,transformExpanded:!(!n.props.workflow.allDatabaseTables||!n.props.workflow.allDatabaseTables.length),outputExpanded:!1,allDatabaseTables:n.props.workflow.allDatabaseTables,saveButtonDisabled:!1,showHelmReminder:!1,helmReminderCheckbox:!1,showLastReportedError:!1,maskingRules:[],maskingRuleValues:l,completeRedactRules:!0,dupeRedactRuleFound:!1,dupeTableExportFound:!1,missingSchemaSelection:!1,missingSecretField:!1,invalidOutputSettingField:!1,missingPostExportHookField:!1,validSchedule:!0,validName:!0,validDiskSize:!0,numMaskingRules:l.length,exportSchedule:!(!n.props.workflow.schedule||"None"===n.props.workflow.schedule),scheduleSelection:n.props.workflow.schedule&&!n.props.workflow.schedule.match(/^@/)&&"None"!==n.props.workflow.schedule?"custom":n.props.workflow.schedule||"",customSchedule:!(!n.props.workflow.schedule||n.props.workflow.schedule.match(/^@/)||"None"===n.props.workflow.schedule),schedule:n.props.workflow.schedule||"None",tableOutputOptions:{errors:{},numDays:30,sampleFields:"createdAndUpdated",createdAtField:"created_at",updatedAtField:"updated_at",disableDeltaUpdates:!1},constraintSchema:"public",constraintTable:"",exportTableDataConfig:[],addTable:"",displayExportTableSchema:"none",displayExportTableData:"none",showClipboardSnackbar:!1,agentNamespace:i,S3UploadFileChecked:[],S3UploadBucket:"",errors:{schedule:!1,name:!1,diskSize:!1,duplicateDataFeed:!1},input:{uuid:"",enabled:!0,tables:[],tableSelection:""},inputs:n.props.workflow.inputs,numInputs:n.props.workflow.inputs.length,dataFeed:{uuid:"",dataFeed:"",dataFeedConfig:{postUpdateKeyValues:[]},feedSecrets:[]},dataFeeds:n.props.workflow.datafeeds,editInputDialog:!1,showDialog:!1,showSnackbarEdit:!1,newInputKey:0,newDataFeedKey:0,addAllS3Uploads:!1,exportTableSchemaAll:!1,exportTableDataAll:!1,showSnackbar:!1,deleteWorkflowConfirmation:!1,ackHelmReminder:!1,orphanedWorkflow:!1,currentDatabaseTable:"",showOutputOptions:!1,editDataFeed:!1,invalidDeltaUpdate:!1,invalidPreparedStatement:!1,mockMigrationDatabase:!1,invalidDigitalTwinOutput:!1,invalidForgetUserFields:!1,invalidMigrationFields:!1,digitalTwinAdded:!1,workflowType:"",deltaUpdateField:n.props.workflow.deltaUpdateField||"",snackbarText:""};return Object.keys(n.props.workflow.exportTableDataConfig).length&&Object.keys(n.props.workflow.exportTableDataConfig).forEach((function(e){var a=Object.keys(n.props.workflow.exportTableDataConfig[e])[0],t=n.props.workflow.exportTableDataConfig[e][a];o.exportTableDataConfig.push({table:a,numDays:t.numDays,sampleFields:t.sampleFields,createdAtField:t.createdAtField,updatedAtField:t.updatedAtField,disableDeltaUpdates:t.disableDeltaUpdates})})),n.props.redactrulesets.forEach((function(e){o.maskingRules.push({schema:"",table:"",databaseTable:"",column:"",rule:"",key:e.redactKey,val:e.redactName})})),n.props.presets&&n.props.presets.length&&n.props.presets.forEach((function(e){e.isDefault||o.maskingRules.push({schema:"",table:"",databaseTable:"",column:"",rule:"",key:"preset-".concat(e.uuid),val:"Preset: ".concat(e.presetName),presetUuid:e.uuid})})),"ERL"!==n.props.workflow.workflowType||n.props.workflow.agentId||(o.orphanedWorkflow=!0),n.state=o,n}return Object(C.a)(t,[{key:"componentDidMount",value:function(){this.setState({ackHelmReminder:this.context.ackHelmReminder})}},{key:"clipboardCopy",value:function(e){var a="";switch(e){case"dbuuid":a="This workflow UUID has been copied to your clipboard";break;case"sampleMigrationHook":a="This sample Helmchart hook has been copied to your clipboard";break;case"sampleMigrationScript":a="This sample script has been copied to your clipboard"}this.setState({showClipboardSnackbar:!0,snackbarText:a})}},{key:"handleRuleChange",value:function(e,a){var t=this,n=this.state.maskingRuleValues,l=this.state.maskingRuleValues.filter((function(a){return a.key===e}));n.map((function(n){if(n.key===e&&"databaseTable"===a.target.name)l[0].databaseTable=a.target.value;else if(n.key===e&&"schema"===a.target.name)l[0].schema=a.target.value;else if(n.key===e&&"table"===a.target.name)l[0].table=a.target.value;else if(n.key===e&&"column"===a.target.name)l[0].column=a.target.value;else if(n.key===e&&"rule"===a.target.name)if(l[0].rule=a.target.value,a.target.value.match(/^preset-/)){var r=t.state.maskingRules.filter((function(e){return e.key===a.target.value&&e}));l[0].presetUuid=r[0].presetUuid}else l[0].presetUuid="";return l})),this.setState({maskingRuleValues:n})}},{key:"saveChanges",value:function(){var e=Object(w.a)(y.a.mark((function e(a){var t,n,l,r,i,o,s,c,d,u,p;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({saveButtonDisabled:!0,errors:{}}),t=[],this.state.exportTableDataConfig.forEach((function(e){var a=e;delete a.errors;var n={};n[a.table]=a,t.push(n)})),n={name:this.props.workflow.name,agentId:this.props.workflow.agentId,workflowType:this.props.workflow.workflowType,inputs:this.state.inputs,dataFeeds:this.state.dataFeeds,maskingRules:this.state.maskingRuleValues,schedule:this.state.schedule,exportTableDataConfig:t,deltaUpdateField:this.state.deltaUpdateField,migrationNamespace:this.props.workflow.migrationNamespace,migrationDatabase:this.props.workflow.migrationDatabase,migrationDatabaseClone:this.props.workflow.migrationDatabaseClone,migrationConfiguration:this.props.workflow.migrationConfiguration,migrationHelmHookWeight:this.props.workflow.migrationHelmHookWeight},!this.validateRedactionRules()||!this.validateMigrationMockFields()){e.next=38;break}return e.prev=5,e.next=8,fetch("".concat(this.context.apiUrl,"/workflow/").concat(a),{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 8:return l=e.sent,this.setState({saveButtonDisabled:!1}),e.next=12,l.json();case 12:if(!(r=e.sent).errors){e.next=29;break}return i=!1,o=!1,s=!1,c=!1,d=!1,u=!1,"Invalid schedule","Invalid agent ID","You must provide your delta update field to enable delta updates","You must provide some key/value pairs for your prepared statements","Your input and target database cannot be identical","Your digital twin output cannot be the same as your input",Array.isArray(r.errors)?(i=r.errors.find((function(e){return"Invalid schedule"===e.msg})),o=r.errors.find((function(e){return"Invalid agent ID"===e.msg&&"agentId"===e.param})),s=r.errors.find((function(e){return"You must provide your delta update field to enable delta updates"===e.msg})),c=r.errors.find((function(e){return"You must provide some key/value pairs for your prepared statements"===e.msg})),d=r.errors.find((function(e){return"Your input and target database cannot be identical"===e.msg})),u=r.errors.find((function(e){return"Your digital twin output cannot be the same as your input"===e.msg}))):(i="Invalid schedule"===r.errors,o="Invalid agent ID"===r.errors,c="You must provide some key/value pairs for your prepared statements"===r.errors,d="Your input and target database cannot be identical"===r.errors,u="Your digital twin output cannot be the same as your input"===r.errors),i?this.setState({validSchedule:!1,errors:{schedule:!0}}):o?this.setState({orphanedWorkflow:!0,errors:{agentId:!0}}):s?this.setState({invalidDeltaUpdate:!0}):c?this.setState({invalidPreparedStatement:!0}):d?this.setState({mockMigrationDatabase:!0}):u&&this.setState({invalidDigitalTwinOutput:!0}),e.abrupt("return");case 29:p=this.state.maskingRuleValues.map((function(e,a){var t=e;return t.key=r.redactRuleUuids[a],t})),this.setState({showDialog:!!r.updateHelmConfig,showSnackbar:!r.updateHelmConfig,maskingRuleValues:p,saveButtonDisabled:!1,numInputs:this.state.inputs.length}),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(5),this.setState({saveButtonDisabled:!1});case 36:e.next=39;break;case 38:this.setState({saveButtonDisabled:!1});case 39:case"end":return e.stop()}}),e,this,[[5,33]])})));return function(a){return e.apply(this,arguments)}}()},{key:"hideHelmReminder",value:function(){var e=Object(w.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.helmReminderCheckbox){e.next=6;break}return e.next=3,fetch("".concat(this.context.apiUrl,"/workflow/ackReminder"),{method:"post",headers:{"Content-Type":"application/json"}});case 3:this.setState({ackHelmReminder:!0,showDialog:!1}),e.next=7;break;case 6:this.setState({showDialog:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleHelmReminder",value:function(e){this.setState({helmReminderCheckbox:e.target.checked})}},{key:"missingInput",value:function(){return!this.state.inputs.find((function(e){return!0===e.enabled&&e.tableSelection}))}},{key:"validateRedactionRules",value:function(){var e=this;if(this.missingInput())return!0;var a=[],t=!1,n=this.state.maskingRuleValues.filter((function(n){var l=0;return a.includes("".concat(n.databaseTable,".").concat(n.table,".").concat(n.column))?t=!0:a.push("".concat(n.databaseTable,".").concat(n.table,".").concat(n.column)),n.databaseTable||l++,n.column||l++,n.rule||l++,(1===l||2===l||!e.legalName(n.column))&&n})),l=!(n.length||t),r=!n.length;return this.setState({completeRedactRules:r,dupeRedactRuleFound:t}),l}},{key:"validateMigrationMockFields",value:function(){return!!("mockDatabaseMigration"!==this.props.workflow.workflowType||this.props.workflow.migrationNamespace&&this.props.workflow.migrationDatabase&&this.props.workflow.migrationDatabaseClone&&this.props.workflow.migrationConfiguration)||(this.setState({invalidMigrationFields:!0}),!1)}},{key:"hideErrorDialog",value:function(){this.setState({completeRedactRules:!0,dupeRedactRuleFound:!1,dupeTableExportFound:!1,validSchedule:!0,validName:!0,validDiskSize:!0,missingSchemaSelection:!1,missingPostExportHookField:!1,missingSecretField:!1,invalidOutputSettingField:!1,orphanedWorkflow:!1,invalidDeltaUpdate:!1,invalidPreparedStatement:!1,mockMigrationDatabase:!1,invalidDigitalTwinOutput:!1,invalidForgetUserFields:!1,invalidMigrationFields:!1})}},{key:"deleteMaskingRule",value:function(e){var a=this.state.maskingRuleValues.filter((function(a){return a.key!==e}));this.setState({numMaskingRules:this.state.numMaskingRules-1,maskingRuleValues:a})}},{key:"addMaskingRule",value:function(){var e=this.state.maskingRuleValues,a=this.state.numMaskingRules+1,t=this.state.newRuleKey+1;e.push({key:"new".concat(t),databaseTable:"",schema:"public",table:"",column:"",rule:""}),this.setState({maskingRuleValues:e,numMaskingRules:a,newRuleKey:t})}},{key:"addTableSelection",value:function(){var e=this.state;e.input.tables.push(localStorage.getItem("schema")||"public"),this.setState(e)}},{key:"deleteTableSelection",value:function(e){var a=this.state,t=a.input.tables[e];a.input.tables=a.input.tables.filter((function(e){return e!==t})),a.inputs=a.inputs.map((function(e){return e.uuid===a.input.uuid?a.input:e})),this.setState(a)}},{key:"deleteWorkflowConfirmation",value:function(){this.setState({deleteWorkflowConfirmation:!0})}},{key:"cancelWorkflowConfirmation",value:function(){this.setState({deleteWorkflowConfirmation:!1})}},{key:"displayLastReportedError",value:function(){return this.props.workflow.lastStackTrace?this.props.workflow.lastStackTrace.split("\n").map((function(e,a){return j.a.createElement(j.a.Fragment,{key:"".concat(e,"-").concat(a)},e,j.a.createElement("br",null))})):""}},{key:"showLastReportedError",value:function(e){e.preventDefault(),this.setState({showLastReportedError:!0})}},{key:"hideLastReportedError",value:function(){this.setState({showLastReportedError:!1})}},{key:"handleCustomSecret",value:function(e,a){var t=this.state;t.dataFeed.feedSecrets[a][e.target.name]=e.target.value,this.setState({dataFeed:t.dataFeed})}},{key:"addSecret",value:function(e){var a=this.state;a.dataFeed.feedSecrets.push({secretType:e,secretName:"",secretKey:"",secretPath:""}),this.setState({dataFeed:a.dataFeed})}},{key:"handleDeleteSecret",value:function(e){var a=this.state;a.dataFeed.feedSecrets=a.dataFeed.feedSecrets.filter((function(a,t){return t!==e})),this.setState({dataFeed:a.dataFeed})}},{key:"handleExportSchedule",value:function(e){"false"===e.target.value?this.setState({exportSchedule:!1,schedule:"None"}):this.setState({exportSchedule:!0,schedule:"* 0 * * *"})}},{key:"handleSchedule",value:function(e){var a={};"scheduleSelection"===e.target.name&&(a.scheduleSelection=e.target.value,a.customSchedule="custom"===e.target.value),a.schedule="custom"===e.target.value?"* 0 * * *":e.target.value,this.setState(a)}},{key:"handleDeltaUpdate",value:function(e){this.setState({deltaUpdateField:e.target.value})}},{key:"dbUUIDSnackbar",value:function(){return j.a.createElement(ce.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:this.state.showClipboardSnackbar,autoHideDuration:8e3,onClose:this.handleSnackbarClose,ContentProps:{"aria-describedby":"message-id"},message:j.a.createElement("span",{id:"message-id"},this.state.snackbarText),action:[j.a.createElement(de.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleSnackbarClose},j.a.createElement(he.a,null))]})}},{key:"getExportFileNames",value:function(){var e=[];return this.state.exportTableDataConfig.forEach((function(a){e.push("table-".concat(a,".csv"))})),e}},{key:"handleTableOutputChanges",value:function(e,a){var t=this.state;switch(a||(a=t.constraintSchema+"."+t.constraintTable),t.tableOutputOptions||(t.tableOutputOptions={numDays:30,sampleFields:"createdAndUpdated",createdAtField:"created_at",updatedAtField:"updated_at",disableDeltaUpdates:!1}),"schema"===e.target.name?t.constraintSchema=e.target.value:"table"===e.target.name&&(t.constraintTable=e.target.value),e.target.name){case"createdAtField":case"numDays":case"sampleFields":case"updatedAtField":t.tableOutputOptions[e.target.name]=e.target.value;break;case"disableDeltaUpdates":t.tableOutputOptions[e.target.name]=e.target.checked}this.setState(t)}},{key:"triggerEditInputDialog",value:function(e){var a={uuid:e.uuid,enabled:e.enabled,tables:e.tables,tableSelection:e.tableSelection};this.setState({input:a,editInputDialog:!0})}},{key:"handleInputChanges",value:function(e,a){var t=this.state;t.inputs.find((function(e){return e.uuid===a.uuid}))||t.inputs.push(a),t.inputs=t.inputs.map((function(n){return n.uuid===a.uuid&&(n[e.target.name]="enabled"===e.target.name?e.target.checked:e.target.value,t.input[e.target.name]=n[e.target.name]),n})),this.setState(t)}},{key:"selectInputSource",value:function(e){var a=this.state,t=this.props.agentInputs.find((function(a){return a.uuid===e.target.value}));t&&(a.inputs=[{uuid:e.target.value,enabled:!0,inputName:t.inputName,tables:[]}],this.setState(a))}},{key:"handleAddTable",value:function(e,a,t){var n=this.state;"schema"===t?n.input.tables[a]=e.target.value+"."+n.input.tables[a].split(".")[1]:"table"===t&&(n.input.tables[a]=n.input.tables[a].split(".")[0]+"."+e.target.value),this.setState({input:n.input})}},{key:"triggerAddTable",value:function(){var e=this.state;if(e.errors.addTable=!1,e.addTable){if(!this.legalName(this.state.addTable))return e.errors.addTable=!0,void this.setState({errors:e.errors});var a=this.state.input;a.tables||(a.tables=[]),a.tables.push(this.state.addTable),this.setState({errors:e.errors,input:a,addTable:""})}}},{key:"legalName",value:function(e){return!e||!!e.match(/^[a-zA-Z_][a-zA-Z0-9_]{1,30}$/)}},{key:"deleteWorkflow",value:function(e){var a=this.state;a.inputs=a.inputs.filter((function(a){return a.uuid!==e.uuid}));var t=this.missingInput();this.setState({transformExpanded:!t,outputExpanded:!t,inputs:a.inputs})}},{key:"hideInputDialog",value:function(){this.setState({editInputDialog:!1})}},{key:"deleteDatabaseTable",value:function(e){var a=this.state.input;a.tables||(a.tables=[]),a.tables=a.tables.filter((function(a){return e!==a})),this.setState({input:a})}},{key:"saveInputChanges",value:function(){var e=this,a=this.state,t=this.state.inputs;a.input.tables||(a.input.tables=[]),a.errors.JSX=null,t=t.map((function(t){return t.tables||(t.tables=[]),t.uuid===e.state.input.uuid?(t.tables.forEach((function(e){var t=e.split("."),n=t[0],l=t[1];n?l||(a.errors.JSX=j.a.createElement(Pa,{mb:4,severity:"error"},"A table selection is missing a table")):a.errors.JSX=j.a.createElement(Pa,{mb:4,severity:"error"},"A table selection is missing a schema")})),e.state.input):t})),a.numMaskingRules=a.maskingRuleValues.length,a.errors.JSX?this.setState({errors:a.errors}):a.input.uuid.match(/^new/)?this.setState({tableOutputOptions:a.tableOutputOptions,errors:a.errors,inputs:t,editInputDialog:!1,showSnackbarEdit:!0,newInputKey:a.newInputKey}):this.setState({maskingRuleValues:a.maskingRuleValues,numMaskingRules:a.numMaskingRules,errors:a.errors,inputs:t,editInputDialog:!1,showSnackbarEdit:!0})}},{key:"legalBucketName",value:function(e){return!!e.match(/^[a-zA-Z0-9]{1}[a-zA-Z0-9.-]{1,61}[a-zA-Z0-9]{1}$/)&&(!e.match(/^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$/)&&(!e.match(/^xn--/)&&!e.match(/-s3alias$/)))}},{key:"saveDataFeedChanges",value:function(){var e=this.state,a=!1,t=this.state.dataFeeds;if(e.dataFeed.dataFeed){switch(e.dataFeed.dataFeed){case"s3upload":e.dataFeed.dataFeedConfig.S3UploadBucket&&this.legalBucketName(e.dataFeed.dataFeedConfig.S3UploadBucket)?e.errors.invalidBucketName=!1:(e.errors.invalidBucketName=!0,a=!0);break;case"digitalTwin":if(e.dataFeed.dataFeedConfig.enableDeltaUpdates&&!e.dataFeed.dataFeedConfig.deltaUpdateField&&(e.errors.invalidDeltaUpdateField=!0,a=!0),e.dataFeed.dataFeedConfig.enablePostUpdatePreparedStatements&&e.dataFeed.dataFeedConfig.postUpdateKeyValues.length)e.dataFeed.dataFeedConfig.postUpdateKeyValues.find((function(e){return!(e.key&&String(e.value)&&!String(e.key).match(/[%\(\)]+/)&&!String(e.value).match(/[%\(\)]+/))}))?(e.errors.invalidPostUpdateKeyValues=!0,a=!0):e.errors.invalidPostUpdateKeyValues=!1;break;case"custom":e.dataFeed.dataFeedConfig.image||(e.errors.image=!0,a=!0),e.dataFeed.dataFeedConfig.tag||(e.errors.tag=!0,a=!0),e.dataFeed.dataFeedConfig.shell||(e.errors.shell=!0,a=!0),this.state.dataFeed.feedSecrets&&this.state.dataFeed.feedSecrets.length&&this.state.dataFeed.feedSecrets.forEach((function(t){("volume"!==t.secretType||t.secretName&&t.secretKey&&t.secretPath)&&("env"!==t.secretType||t.secretName&&t.secretKey&&t.envName)||(e.errors.invalidSecret=!0,a=!0)}))}a?this.setState({errors:e.errors}):("new"===e.dataFeed.uuid?(e.newDataFeedKey++,e.dataFeed.uuid="new"+e.newDataFeedKey,t.push(e.dataFeed)):t=t.map((function(a){return a.uuid===e.dataFeed.uuid&&(a.dataFeed=e.dataFeed.dataFeed,a.dataFeedConfig=e.dataFeed.dataFeedConfig,a.feedSecrets=e.dataFeed.feedSecrets),a})),this.setState({dataFeeds:t,editDataFeed:!1,showSnackbarEdit:!0}))}else this.setState({editDataFeed:!1})}},{key:"transformExpansion",value:function(e,a){this.setState({transformExpanded:!!a})}},{key:"outputExpansion",value:function(e,a){this.setState({outputExpanded:!!a})}},{key:"triggerOutputOptions",value:function(e,a){var t=this.state;a?(t.constraintSchema=a.split(".")[0],t.constraintTable=a.split(".")[1],t.tableOutputOptions=t.exportTableDataConfig.find((function(e){return e.table===a})),t.tableOutputOptions.errors={}):(t.constraintSchema="public",t.constraintTable="",t.tableOutputOptions={errors:{},numDays:30,sampleFields:"createdAndUpdated",createdAtField:"created_at",updatedAtField:"updated_at",disableDeltaUpdates:!1}),this.setState({currentDatabaseTable:a,tableOutputOptions:t.tableOutputOptions,constraintSchema:t.constraintSchema,constraintTable:t.constraintTable,showOutputOptions:!0})}},{key:"deleteConstraint",value:function(e,a){var t=this.state;t.exportTableDataConfig=t.exportTableDataConfig.filter((function(e){return e.table!==a})),this.setState({exportTableDataConfig:t.exportTableDataConfig})}},{key:"genConstraintSummary",value:function(e){var a="",t="",n=this.state.exportTableDataConfig.find((function(a){return a.table===e}));if(n){switch(n.sampleFields){case"createdAndUpdated":t="rows created and updated";break;case"created":t="rows created";break;case"updated":t="rows updated"}a=t+" in the last "+n.numDays+" days"}return a}},{key:"hideOutputOptions",value:function(){var e=this,a=this.state;!a.currentDatabaseTable&&this.state.constraintSchema&&this.state.constraintTable?(a.tableOutputOptions.table=this.state.constraintSchema+"."+this.state.constraintTable,a.exportTableDataConfig.push(a.tableOutputOptions)):this.state.constraintSchema&&this.state.constraintTable&&(a.exportTableDataConfig=a.exportTableDataConfig.map((function(t){return t.table===a.currentDatabaseTable?(a.tableOutputOptions.table=e.state.constraintSchema+"."+e.state.constraintTable,a.tableOutputOptions):t}))),this.setState({showOutputOptions:!1,exportTableDataConfig:a.exportTableDataConfig})}},{key:"resetDataFeedErrors",value:function(){var e=this.state;e.errors.duplicateDataFeed=!1,e.errors.invalidBucketName=!1,e.errors.invalidPostUpdateKeyValues=!1,e.errors.invalidSecret=!1,this.setState({errors:e.errors})}},{key:"addDataFeed",value:function(){this.resetDataFeedErrors();var e=this.state;e.dataFeed.uuid="new",e.dataFeed.dataFeed="",e.dataFeed.feedSecrets=[],this.setState({editDataFeed:!0,dataFeed:e.dataFeed})}},{key:"triggerEditDataFeed",value:function(e){this.resetDataFeedErrors();var a=this.state,t=this.state.dataFeeds.filter((function(a){return a.uuid===e.uuid}));"s3upload"===t[0].dataFeed&&(t[0].dataFeedConfig.S3UploadBucket=t[0].dataFeedConfig.S3UploadBucket.replace(/^s3:\/\//,"")),t[0].dataFeedConfig.postUpdateKeyValues||(t[0].dataFeedConfig.postUpdateKeyValues=[]);var n={uuid:t[0].uuid,dataFeed:t[0].dataFeed,dataFeedConfig:t[0].dataFeedConfig,feedSecrets:t[0].feedSecrets};this.setState({editDataFeed:!0,dataFeed:n,errors:a.errors})}},{key:"hideDataFeed",value:function(){this.setState({editDataFeed:!1})}},{key:"handleDataFeed",value:function(e){var a=this.state;if(a.dataFeeds&&a.dataFeeds.find((function(a){return a.dataFeed===e})))return a.errors.duplicateDataFeed=!0,a.dataFeed.dataFeed="",void this.setState({errors:a.errors,dataFeed:a.dataFeed});switch(a.dataFeed.dataFeed=e,a.errors.duplicateDataFeed=!1,e){case"digitalTwin":a.dataFeed.dataFeedConfig={inputSource:"",enableSSL:!1,enableDeltaUpdates:!1,enablePostUpdatePreparedStatements:!1,postUpdateKeyValues:[]};break;case"s3upload":a.dataFeed.dataFeedConfig={postUpdateKeyValues:[]};break;case"custom":a.dataFeed.dataFeedConfig={image:"",tag:"",shell:"",command:"",postUpdateKeyValues:[]}}this.setState({dataFeed:a.dataFeed,errors:a.errors})}},{key:"handleDataFeedBack",value:function(){var e=this.state;e.dataFeed.dataFeed="",this.setState({dataFeed:e.dataFeed})}},{key:"handleDataFeedCancel",value:function(){this.setState({editDataFeed:!1})}},{key:"addParameterValue",value:function(){var e=this.state;e.dataFeed.dataFeedConfig.postUpdateKeyValues.push({key:"",value:""}),this.setState(e)}},{key:"updateParameterValue",value:function(e,a){var t=this.state;t.dataFeed.dataFeedConfig.postUpdateKeyValues=t.dataFeed.dataFeedConfig.postUpdateKeyValues.map((function(t,n){return n===e&&"parameterKey"===a.target.name?t.key=a.target.value:n===e&&"parameterValue"===a.target.name&&(t.value=!a.target.value||isNaN(a.target.value)?a.target.value:parseFloat(a.target.value)),t})),this.setState(t)}},{key:"deleteParameterValue",value:function(e){var a=this.state;a.dataFeed.dataFeedConfig.postUpdateKeyValues=a.dataFeed.dataFeedConfig.postUpdateKeyValues.filter((function(a,t){return t!==e})),this.setState(a)}},{key:"deleteDataFeed",value:function(e){var a=this.state;a.dataFeeds=a.dataFeeds.filter((function(a){return a.uuid!==e.uuid})),this.setState({dataFeeds:a.dataFeeds,showSnackbarEdit:!0})}},{key:"handleDataFeedOptions",value:function(e){var a=this.state;a.dataFeed.dataFeedConfig[e.target.name]=e.target.name.match(/^enable/)?e.target.checked:e.target.value,this.setState(a)}},{key:"displayWorkflowType",value:function(e){switch(e){case"ERL":return"ERL (Extract, Redact, Load)";case"mockDatabaseMigration":return"Database Clone for Migration Dry-run"}}},{key:"render",value:function(){var e=this;return j.a.createElement(Aa,{mb:6},j.a.createElement(ue.a,null,this.dbUUIDSnackbar(),j.a.createElement(V.a,{variant:"h4"},this.props.workflow.name," ",j.a.createElement("code",null,"(",this.props.workflow.uuid,")"),j.a.createElement(B.a,{display:"inline",ml:2},j.a.createElement(oe.CopyToClipboard,{text:this.props.workflow.uuid,onCopy:function(){return e.clipboardCopy("dbuuid")}},j.a.createElement(Ua,{variant:"outlined",size:"small",color:"secondary"},j.a.createElement(ge.a,null))))),j.a.createElement(B.a,null,j.a.createElement(Wa,{container:!0,justify:"space-between",alignItems:"center"},j.a.createElement(Wa,{item:!0,xs:4},j.a.createElement(B.a,{display:this.props.workflow.workflowType.match(/^(ERL|mockDatabaseMigration)/)?"block":"none"},j.a.createElement(La,{margin:"dense",fullWidth:!0},j.a.createElement(G.a,null,"Redactics Agent"),j.a.createElement(_a,{value:this.props.workflow.agentId,name:"agentId",onChange:function(a){return e.props.handleWFChanges(a,e.props.workflow.uuid)}},this.props.agents.map((function(e){return j.a.createElement(X.a,{key:e.uuid,value:e.uuid},e.name)}))))),j.a.createElement(B.a,{mt:4},"Workflow Type: ",j.a.createElement("b",null,this.displayWorkflowType(this.props.workflow.workflowType)))))),j.a.createElement(M.a,{open:this.state.showLastReportedError,onClose:this.hideLastReportedError,maxWidth:"lg","aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Last Reported Error for: ",this.props.workflow.name),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},this.displayLastReportedError()),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideLastReportedError},"Close")))),j.a.createElement(B.a,{mt:12},j.a.createElement(pe.a,{variant:"outlined"},j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Input Settings")),j.a.createElement(Va,null,j.a.createElement(Ke,{errors:this.state.errors,workflow:this.props.workflow,agentInputs:this.props.agentInputs,agents:this.props.agents,input:this.state.input,inputs:this.state.inputs,saveInputChanges:this.saveInputChanges,selectInputSource:this.selectInputSource,editInputDialog:this.state.editInputDialog,triggerEditInputDialog:this.triggerEditInputDialog,handleInputChanges:this.handleInputChanges,handleAddTable:this.handleAddTable,addTable:this.state.addTable,triggerAddTable:this.triggerAddTable,hideInputDialog:this.hideInputDialog,deleteDatabaseTable:this.deleteDatabaseTable,handleSnackbarClose:this.handleEditWorkflowSnackbarClose,addTableSelection:this.addTableSelection,deleteTableSelection:this.deleteTableSelection}))))),j.a.createElement(B.a,{mt:4,display:this.props.workflow.workflowType.match(/^ERL/)?"block":"none"},j.a.createElement(pe.a,{variant:"outlined"},j.a.createElement(Y.a,{disabled:this.missingInput(),expanded:!this.missingInput()&&this.state.transformExpanded,onChange:function(a,t){return e.transformExpansion(a,t)}},j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Processing/Transformation Settings")),j.a.createElement(Va,null,j.a.createElement(je,{workflow:this.props.workflow,allDatabaseTables:this.state.allDatabaseTables,maskingRuleValues:this.state.maskingRuleValues,handleRuleChange:this.handleRuleChange,deleteMaskingRule:this.deleteMaskingRule,numMaskingRules:this.state.numMaskingRules,maskingRules:this.state.maskingRules,addMaskingRule:this.addMaskingRule}),j.a.createElement(Ze,{handleExportSchedule:this.handleExportSchedule,exportSchedule:this.state.exportSchedule,schedule:this.state.schedule||"* 0 * * *",handleSchedule:this.handleSchedule,scheduleSelection:this.state.scheduleSelection,customSchedule:this.state.customSchedule,workflowType:this.props.workflow.workflowType,errors:this.state.errors}))))),j.a.createElement(B.a,{mt:4,display:this.props.workflow.workflowType.match(/^ERL/)?"block":"none"},j.a.createElement(pe.a,{variant:"outlined"},j.a.createElement(Y.a,{disabled:!this.state.allDatabaseTables||!this.state.allDatabaseTables.length,expanded:this.state.outputExpanded,onChange:function(a,t){return e.outputExpansion(a,t)}},j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Output Settings")),j.a.createElement(Va,null,j.a.createElement(ia,{exportTableDataConfig:this.state.exportTableDataConfig,showOutputOptions:this.state.showOutputOptions,hideOutputOptions:this.hideOutputOptions,triggerOutputOptions:this.triggerOutputOptions,deleteConstraint:this.deleteConstraint,currentDatabaseTable:this.state.currentDatabaseTable,allDatabaseTables:this.state.allDatabaseTables,tableOutputOptions:this.state.tableOutputOptions,constraintSchema:this.state.constraintSchema,constraintTable:this.state.constraintTable,handleTableOutputChanges:this.handleTableOutputChanges,genConstraintSummary:this.genConstraintSummary}),j.a.createElement(Da,{inputs:this.state.inputs,dataFeeds:this.state.dataFeeds,dataFeed:this.state.dataFeed,addParameterValue:this.addParameterValue,updateParameterValue:this.updateParameterValue,deleteParameterValue:this.deleteParameterValue,agents:this.props.agents,workflow:this.props.workflow,hideDataFeed:this.hideDataFeed,addDataFeed:this.addDataFeed,editDataFeed:this.state.editDataFeed,handleDataFeed:this.handleDataFeed,handleDataFeedBack:this.handleDataFeedBack,handleDataFeedCancel:this.handleDataFeedCancel,handleDataFeedOptions:this.handleDataFeedOptions,saveDataFeedChanges:this.saveDataFeedChanges,triggerEditDataFeed:this.triggerEditDataFeed,deleteDataFeed:this.deleteDataFeed,errors:this.state.errors,handleCustomSecret:this.handleCustomSecret,addSecret:this.addSecret,handleDeleteSecret:this.handleDeleteSecret,agentNamespace:this.state.agentNamespace}))))),j.a.createElement(B.a,{mt:4,display:"mockDatabaseMigration"===this.props.workflow.workflowType?"block":"none"},j.a.createElement(pe.a,{variant:"outlined"},j.a.createElement(Y.a,{expanded:this.state.outputExpanded,onChange:function(a,t){return e.outputExpansion(a,t)}},j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Settings and Setup Instructions")),j.a.createElement(Va,null,j.a.createElement(Ra,{workflow:this.props.workflow,handleWFChanges:this.props.handleWFChanges,inputs:this.state.inputs,agentNamespace:this.state.agentNamespace||"default",clipboardCopy:this.clipboardCopy}))))),j.a.createElement(Wa,{container:!0,justify:"space-between",alignItems:"center",mt:12},j.a.createElement(Wa,{item:!0,xs:10},j.a.createElement(Ua,{variant:"contained",color:"primary",size:"large",disabled:this.state.saveButtonDisabled,onClick:function(){return e.saveChanges(e.props.workflow.uuid)}},j.a.createElement(le.a,null),"\xa0Save Changes")),j.a.createElement(Wa,{item:!0},j.a.createElement(Ua,{variant:"contained",color:"default",size:"small",onClick:this.deleteWorkflowConfirmation},j.a.createElement(be.a,null),"\xa0 Delete Workflow")),j.a.createElement(M.a,{open:this.state.deleteWorkflowConfirmation,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Delete Workflow"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"Are you sure you want to delete this workflow configuration?"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{onClick:this.cancelWorkflowConfirmation},"Cancel"),j.a.createElement(Ua,{color:"primary",onClick:function(){return e.props.deleteWorkflow(e.props.workflow.uuid)}},"Yes, delete")))),j.a.createElement(M.a,{open:this.state.orphanedWorkflow,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"Workflow ",j.a.createElement("b",null,this.props.workflow.name)," is not associated with a Redactics Agent. Please correct this by selecting an agent in your workflow configuration."),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:!this.state.completeRedactRules,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"One or more of your redaction rules contains a blank value or invalid column name (field names must contain only letters, numbers and underscores and most start with a letter or underscore)"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.dupeRedactRuleFound,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"One or more of your redaction rules contains a duplicate table and column name"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.dupeTableExportFound,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"You've already selected this table/column for export"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.missingSchemaSelection,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"You must provide some table names for schema export"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.missingPostExportHookField,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"You must provide valid custom data feed container info"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.missingSecretField,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"You must provide details about your secrets/environment variables"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.invalidOutputSettingField,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},'One or more "created" or "updated" field settings are missing or contain illegal characters'),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.invalidForgetUserFields,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},'Your Forget User Request "Database and Table Name" or "Email Field" are either missing or contain an invalid field name (field names must contain only letters, numbers and underscores and most start with a letter or underscore).'),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.invalidMigrationFields,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"Your Setup Instructions fields are missing one or more values."),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:!this.state.validSchedule,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},j.a.createElement("p",null,"Your custom schedule is invalid. Please abide by the standard crontab format:"),j.a.createElement("p",null,j.a.createElement("b",null,"[minute](0-59)[hour](0-23) [day of the month](1-31) [month](1-12) [day of the week](0-6)"))),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.mockMigrationDatabase,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},j.a.createElement("p",null,"Your database and cloned database name cannot be identical.")),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.invalidDigitalTwinOutput,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},j.a.createElement("p",null,"You cannot designate a Digital Twin output that is also configured as an input source.")),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:!this.state.validName,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"You must provide a workflow name"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:!this.state.validDiskSize,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Error"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},"You must provide a disk space allocation for your input source"),j.a.createElement(Z.a,null,j.a.createElement(Ua,{color:"primary",onClick:this.hideErrorDialog},"Okay")))),j.a.createElement(M.a,{open:this.state.showDialog,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Your changes have been saved!"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"dialog-description"},j.a.createElement(B.a,null,"However, your workflow will not work until you update your Helm configuration file,\xa0 which can be found in the ",j.a.createElement("b",null,"Agents")," section.")),j.a.createElement(Z.a,null,j.a.createElement(Ua,{onClick:this.hideHelmReminder,color:"primary",autoFocus:!0},"Okay")))),j.a.createElement(ce.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:this.state.showSnackbar,autoHideDuration:8e3,onClose:this.handleSnackbarClose,ContentProps:{"aria-describedby":"message-id"},message:j.a.createElement("span",{id:"message-id"},j.a.createElement("b",null,"Your changes have been saved!")),action:[j.a.createElement(de.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleSnackbarClose},j.a.createElement(he.a,null))]}),j.a.createElement(ce.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:this.state.showSnackbarEdit,autoHideDuration:8e3,onClose:this.handleSnackbarClose,ContentProps:{"aria-describedby":"message-id"},message:j.a.createElement("span",{id:"message-id"},'Click on "Save Changes" at the bottom of this section to save your changes...'),action:[j.a.createElement(de.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleSnackbarClose},j.a.createElement(he.a,null))]}))))}}],[{key:"displayStatus",value:function(e){return e?j.a.createElement(B.a,{mt:8},j.a.createElement(V.a,{variant:"h6",gutterBottom:!0},"Status"),"Last task: ",j.a.createElement("b",null,e)):null}}]),t}(j.a.Component);Ba.contextType=ie.a;var Ma,Ha,Ka=Object(x.a)({selectAdornment:{marginRight:"-30px"}})(Ba),za=Object(I.c)(W.a)(re.b),Ya=Object(I.c)(U.a)(re.b),$a=Object(I.c)(Ya)(Ma||(Ma=Object(F.a)(["\n  min-width: 400px;\n  max-width: 400px;\n"]))),qa=Object(I.c)(P.a)(re.b),Ga=Object(I.c)(N.a)(re.b),Ja=Object(I.c)(Ga)(Ha||(Ha=Object(F.a)(["\n  width: 400px;\n"]))),Qa=Object(I.c)(L.a)(re.b),Xa=Object(I.c)(_.a)(re.b),Za=function(e){Object(D.a)(t,e);var a=Object(O.a)(t);function t(e){var n;return Object(v.a)(this,t),(n=a.call(this,e)).state={saveButtonDisabled:!0,ruleLegendDialog:!1,newWorkflowDialog:!1,workflows:[],agentInputs:[],allOutputs:[],presets:[],redactrulesets:[],agents:[],newWorkflowName:"",newWorkflowAgent:"",newWorkflowType:"",dbLimitError:!1,deleteWorkflowConfirmation:!1},n.handleChangeAdd=n.handleChangeAdd.bind(Object(S.a)(n)),n.handleWFChanges=n.handleWFChanges.bind(Object(S.a)(n)),n.addWorkflow=n.addWorkflow.bind(Object(S.a)(n)),n.ruleLegendOpen=n.ruleLegendOpen.bind(Object(S.a)(n)),n.ruleLegendClose=n.ruleLegendClose.bind(Object(S.a)(n)),n.newWorkflowOpen=n.newWorkflowOpen.bind(Object(S.a)(n)),n.newWorkflowClose=n.newWorkflowClose.bind(Object(S.a)(n)),n.refreshWorkflows=n.refreshWorkflows.bind(Object(S.a)(n)),n.deleteWorkflow=n.deleteWorkflow.bind(Object(S.a)(n)),n.dbLimitErrorClose=n.dbLimitErrorClose.bind(Object(S.a)(n)),n}return Object(C.a)(t,[{key:"refreshWorkflows",value:function(){var e=Object(w.a)(y.a.mark((function e(){var a,t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.context.apiUrl,"/workflow"));case 3:return a=e.sent,e.next=6,a.json();case 6:(t=e.sent).workflows.map((function(e){return e.migrationNamespace=e.migrationNamespace||"default",e.migrationDatabaseClone=e.migrationDatabaseClone||"redactics_clone",e})),this.setState({workflows:t.workflows,agentInputs:t.agentInputs,allOutputs:t.allOutputs,presets:t.presets,redactrulesets:t.redactrulesets,agents:t.agents}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.refreshWorkflows()}},{key:"handleChangeAdd",value:function(e){var a=this.state;switch(e.target.name){case"name":a.newWorkflowName=e.target.value,a.saveButtonDisabled="ERL"===a.newWorkflowType?!(e.target.value&&a.newWorkflowAgent):!(e.target.value&&a.newWorkflowType),this.setState(a);break;case"agentId":a.newWorkflowAgent=e.target.value,a.saveButtonDisabled=!a.newWorkflowName,this.setState(a);break;case"workflowType":a.newWorkflowType=e.target.value,a.saveButtonDisabled="ERL"===e.target.value?!(a.newWorkflowName&&a.newWorkflowAgent):!(a.newWorkflowName&&a.newWorkflowType),this.setState(a)}}},{key:"addWorkflow",value:function(){var e=Object(w.a)(y.a.mark((function e(){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({saveButtonDisabled:!0}),e.prev=1,e.next=4,fetch("".concat(this.context.apiUrl,"/workflow"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.state.newWorkflowName,agentId:this.state.newWorkflowAgent,workflowType:this.state.newWorkflowType})});case 4:return a=e.sent,e.next=7,a.json();case 7:this.refreshWorkflows(),this.setState({newWorkflowDialog:!1,newWorkflowName:"",newWorkflowAgent:""}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"deleteWorkflow",value:function(){var e=Object(w.a)(y.a.mark((function e(a){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.context.apiUrl,"/workflow/").concat(a),{method:"delete",headers:{"Content-Type":"application/json"}});case 3:this.refreshWorkflows(),this.setState({deleteWorkflowConfirmation:!1}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setState({deleteWorkflowConfirmation:!1});case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(a){return e.apply(this,arguments)}}()},{key:"newWorkflowOpen",value:function(){this.setState({newWorkflowDialog:!0})}},{key:"newWorkflowClose",value:function(){this.setState({newWorkflowDialog:!1})}},{key:"dbLimitErrorClose",value:function(){this.setState({dbLimitError:!1})}},{key:"ruleLegendOpen",value:function(){this.setState({ruleLegendDialog:!0})}},{key:"ruleLegendClose",value:function(){this.setState({ruleLegendDialog:!1})}},{key:"handleWFChanges",value:function(e,a){var t=this.state.workflows.map((function(t){var n=t;return n.uuid===a&&(n[e.target.name]=e.target.value),n}));this.setState({workflows:t})}},{key:"render",value:function(){var e=this;return j.a.createElement(j.a.Fragment,null,j.a.createElement(A.a,{title:"Workflow Configurations"}),j.a.createElement(qa,{justify:"space-between",container:!0,spacing:10},j.a.createElement(qa,{item:!0,xs:4,mb:6},j.a.createElement(V.a,{variant:"h1",gutterBottom:!0,display:"inline"},"Workflow Configurations"))),j.a.createElement(za,{my:6}),j.a.createElement(B.a,{mt:4},j.a.createElement(V.a,{variant:"body1",gutterBottom:!0},"Build and maintain your data management workflows here. Configuration changes will be picked up by your installed Agent usually within a few minutes.")),j.a.createElement(qa,{justify:"space-between",container:!0,spacing:10,mt:8},j.a.createElement(qa,{item:!0}),j.a.createElement(qa,{item:!0,mb:6},j.a.createElement("div",null,j.a.createElement(Xa,{variant:"contained",color:"secondary",size:"small",onClick:this.ruleLegendOpen},j.a.createElement(ee.a,null),"\xa0 PII Ruleset Legend"),"\xa0",j.a.createElement(Xa,{variant:"contained",color:"secondary",size:"small",onClick:this.newWorkflowOpen},j.a.createElement(ae.a,null),"\xa0 Define New Workflow")))),j.a.createElement(M.a,{open:this.state.ruleLegendDialog,onClose:this.ruleLegendClose,"aria-labelledby":"legend-title","aria-describedby":"legend-description"},j.a.createElement(H.a,{id:"legend-title"},"PII Ruleset Legend"),j.a.createElement(K.a,null,j.a.createElement(z.a,{id:"legend-description"},j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Redact Email")),j.a.createElement(q.a,null,j.a.createElement(V.a,null,"Transform emails to unique email address derived from the row's primary key, constructed based on provided prefix and domain - i.e.",j.a.createElement("code",null,"[prefix][primarykey]@[domain]")))),j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Destruction")),j.a.createElement(q.a,null,j.a.createElement(V.a,null,"Replace data with a null value"))),j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Replacement")),j.a.createElement(q.a,null,j.a.createElement(V.a,null,"Replace data with a provided value"))),j.a.createElement(Y.a,null,j.a.createElement($.a,{expandIcon:j.a.createElement(te.a,null)},j.a.createElement(V.a,null,"Random String")),j.a.createElement(q.a,null,j.a.createElement(V.a,null,"Replace data with a random alphanumeric string of a provided length")))))),j.a.createElement(M.a,{open:this.state.newWorkflowDialog,onClose:this.newWorkflowClose,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"Add Workflow"),j.a.createElement(K.a,null,j.a.createElement("form",{noValidate:!0,autoComplete:"off"},j.a.createElement(B.a,null,"Create a name for this workflow, and assign a Redactics Agent to carry out the work defined by this workflow."),j.a.createElement(B.a,{mt:4},j.a.createElement($a,{fullWidth:!0},j.a.createElement(Ja,{name:"name",label:"Workflow Name",onChange:this.handleChangeAdd,value:this.state.newWorkflowName}))),j.a.createElement(B.a,{mt:4},j.a.createElement($a,{margin:"dense",fullWidth:!0},j.a.createElement(G.a,null,"Workflow Type"),j.a.createElement(Qa,{value:this.state.newWorkflowType,name:"workflowType",onChange:this.handleChangeAdd,endAdornment:j.a.createElement(J.a,{className:this.props.classes.selectAdornment,position:"end"},j.a.createElement(Q.a,{title:"The web-based ERL testing option allows you to test ERL workflows with some preset sample dataset options without having to install the Redactics Agent into your own infrastructure. This option is multi-tenant, but a single-tenant mode is available you can run with your own datasets - contact us for more info.",placement:"right-start"},j.a.createElement(ne.a,null)))},j.a.createElement(X.a,{key:"ERL",value:"ERL"},"ERL (Extract, Redact, Load)"),j.a.createElement(X.a,{key:"mockDatabaseMigration",value:"mockDatabaseMigration"},"Database Clone for Migration Dry-run")))),j.a.createElement(B.a,{mt:4,display:this.state.newWorkflowType.match(/^(ERL|mockDatabaseMigration)/)?"block":"none"},j.a.createElement($a,{fullWidth:!0},j.a.createElement(G.a,{htmlFor:"agentId"},"Redactics Agent"),j.a.createElement(Qa,{name:"agentId",onChange:this.handleChangeAdd,value:this.state.newWorkflowAgent},this.state.agents.map((function(e){return j.a.createElement(X.a,{key:e.uuid,value:e.uuid},e.name)}))))),j.a.createElement(B.a,{mt:8},j.a.createElement(Z.a,null,j.a.createElement(Xa,{color:"secondary",onClick:this.newWorkflowClose},"Cancel"),j.a.createElement(Xa,{color:"secondary",variant:"contained",disabled:this.state.saveButtonDisabled,onClick:this.addWorkflow},"Save\xa0",j.a.createElement(le.a,null))))))),j.a.createElement(M.a,{open:this.state.dbLimitError,onClose:this.dbLimitErrorClose,"aria-labelledby":"dialog-title","aria-describedby":"dialog-description"},j.a.createElement(H.a,{id:"dialog-title"},"You've Reached Your Account Limit"),j.a.createElement(K.a,null,j.a.createElement(B.a,null,"This Redactics account is currently limited to support defining only a single database. Please contact us if you wish to upgrade this account."),j.a.createElement(Z.a,null,j.a.createElement(Xa,{color:"secondary",onClick:this.dbLimitErrorClose},"Okay")))),this.state.workflows.map((function(a){return j.a.createElement(Ka,{workflow:a,presets:e.state.presets,redactrulesets:e.state.redactrulesets,agents:e.state.agents,agentInputs:e.state.agentInputs,key:a.uuid,handleWFChanges:e.handleWFChanges,deleteWorkflow:e.deleteWorkflow})})))}}]),t}(j.a.Component);Za.contextType=ie.a;a.default=Object(x.a)({selectAdornment:{marginRight:"-30px"}})(Za)}}]);
//# sourceMappingURL=12.e4406cfa.chunk.js.map